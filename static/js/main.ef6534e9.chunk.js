(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{54:function(e,n,t){e.exports=t(76)},67:function(e,n,t){e.exports=t.p+"static/media/click.b48ed3e5.wav"},75:function(e,n,t){},76:function(e,n,t){"use strict";t.r(n);var a,r,i,c=t(0),o=t.n(c),u=t(25),s=t.n(u),l=t(1),f=t(5),m=t(6),d=[{name:"Larghissimo",range:[0,24]},{name:"Grave",range:[25,45]},{name:"Largo",range:[40,60]},{name:"Lento",range:[45,60]},{name:"Larghetto",range:[60,66]},{name:"Adagio",range:[66,76]},{name:"Andante",range:[76,108]},{name:"Marcia moderato",range:[83,85]},{name:"Andante moderato",range:[92,112]},{name:"Moderato",range:[108,120]},{name:"Allegro",range:[120,156]},{name:"Vivace",range:[156,176]},{name:"Vivacissimo",range:[172,176]},{name:"Allegrissimo",range:[172,176]},{name:"Presto",range:[168,200]},{name:"Prestissimo",range:[200,250]}],b=function(e){return d.filter(function(n){return function(e,n){var t=Object(l.a)(e,2),a=t[0],r=t[1];return n>=a&&n<=r}(n.range,e)})},g=function(e){var n=e.bpm,t=b(n);return o.a.createElement("div",{style:{minHeight:"6.5em"}},t.map(function(e,n){var t=e.name,a=e.range;return o.a.createElement("div",{key:n,className:"has-text-centered"},t," - ",a[0]," - ",a[1])}))},v=t(11),p=t(89),h=t(46),j=t(79),O=t(85),E=t(77),k=t(42);!function(e){e.AppSettings="@mjh/k/app-settings-0",e.SignatureDivisions="@mjh/k/signature-divisions-3",e.ShowKnown="@mjh/k/show-known-2",e.ScalesDB="@mjh/k/scales-db-1",e.ActiveBeats="@mjh/k/active-beats-2",e.TimeSignature="@mjh/k/signature-2",e.BPM="@mjh/k/bpm-0",e.KnownScales="@mjh/k/known-scales-0",e.ShowScales="@mjh/k/show-scales-0",e.ShowTuner="@mjh/k/show-tuner-0",e.ShowDial="@mjh/k/show-dial-0",e.Radians="@mjh/k/radians-0",e.WakeLock="@mjh/k/wake-lock-0"}(a||(a={})),function(e){e.Major="Major",e.Minor="Minor"}(r||(r={})),function(e){e.A="A",e.B="B",e.C="C",e.D="D",e.E="E",e.F="F",e.G="G",e.A_Flat="Ab",e.B_Flat="Bb",e.C_Flat="Cb",e.D_Flat="Db",e.E_Flat="Eb",e.F_Flat="Fb",e.G_Flat="Gb",e.A_Sharp="A#",e.B_Sharp="B#",e.C_Sharp="C#",e.D_Sharp="D#",e.E_Sharp="E#",e.F_Sharp="F#",e.G_Sharp="G#"}(i||(i={}));var w=[[i.A,r.Major],[i.B,r.Major],[i.C,r.Major],[i.D,r.Major],[i.E,r.Major],[i.F,r.Major],[i.G,r.Major],[i.A_Flat,r.Major],[i.B_Flat,r.Major],[i.C_Flat,r.Major],[i.D_Flat,r.Major],[i.E_Flat,r.Major],[i.G_Flat,r.Major],[i.C_Sharp,r.Major],[i.F_Sharp,r.Major],[i.A,r.Minor],[i.B,r.Minor],[i.C,r.Minor],[i.D,r.Minor],[i.E,r.Minor],[i.F,r.Minor],[i.G,r.Minor],[i.A_Flat,r.Minor],[i.B_Flat,r.Minor],[i.E_Flat,r.Minor],[i.A_Sharp,r.Minor],[i.C_Sharp,r.Minor],[i.D_Sharp,r.Minor],[i.F_Sharp,r.Minor],[i.G_Sharp,r.Minor]],y=t(43),S=t.n(y),x=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=Object(c.useState)(function(){var a,r=localStorage.getItem(e);return a=null===r||void 0===r||t?n instanceof Function?n():n:JSON.parse(r),window.localStorage.setItem(e,JSON.stringify(a)),a}),r=Object(l.a)(a,2),i=r[0],o=r[1];return[i,Object(c.useCallback)(function(n){o(function(t){var a=n instanceof Function?n(t):n;return window.localStorage.setItem(e,JSON.stringify(a)),a})},[e])]},M=function(e,n){var t=x(e,n),a=Object(l.a)(t,2),r=a[0],i=a[1];return[r,Object(c.useCallback)(function(){i(E.a)},[i])]},C=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){},t=Object(c.useState)(e),a=Object(l.a)(t,2),r=a[0],i=a[1];return[r,Object(c.useCallback)(function(){return i(function(e){var t=!e;return n(t),t})},[n])]},N=function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];var a=Object(c.useRef)(n);Object(c.useEffect)(function(){var e=a.current,t=n;e.forEach(function(e,n){var a=t[n];if(a!==e){var r=k.detailedDiff(e,a);console.log("Change at argument index: ".concat(n),r)}}),a.current=n},[n])},A=t(30),I=t(78);function D(){var e=Object(f.a)(["\n  &:not(:last-child) {\n    margin-bottom: 0 !important;\n  }\n"]);return D=function(){return e},e}var F=function(e){var n=Object(c.useState)(e),t=Object(l.a)(n,2),a=t[0],r=t[1],i=e.on,u=e.children,s=e.className,f=void 0===s?"":s;Object(c.useEffect)(function(){var n=e;e.on?(n=I.a("offIsPrimary",n),n=I.a("offIsLink",n),n=I.a("offIsDanger",n),n=I.a("offIsInfo",n),n=I.a("offIsSuccess",n),n=I.a("offIsOutlined",n)):(n=I.a("isPrimary",n),n=I.a("isLink",n),n=I.a("isDanger",n),n=I.a("isInfo",n),n=I.a("isSuccess",n),n=I.a("isOutlined",n)),r(n)},[f,e]);a.on;var m=Object(A.a)(a,["on"]),d=u instanceof Array&&2===u.length?i?u[0]:u[1]:u;return o.a.createElement(B,m,d)},B=function(e){var n=e.isPrimary,t=e.isDanger,a=e.isLink,r=e.isInfo,i=e.isSuccess,c=e.isOutlined,u=e.offIsPrimary,s=e.offIsDanger,l=e.offIsLink,f=e.offIsInfo,m=e.offIsSuccess,d=e.offIsOutlined,b=e.grow,g=Object(A.a)(e,["isPrimary","isDanger","isLink","isInfo","isSuccess","isOutlined","offIsPrimary","offIsDanger","offIsLink","offIsInfo","offIsSuccess","offIsOutlined","grow"]),p=n?"is-primary":"",h=a?"is-link":"",j=t?"is-danger":"",O=r?"is-info":"",E=i?"is-success":"",k=c?"is-outlined":"",w=u?"is-primary":"",y=l?"is-link":"",S=s?"is-danger":"",x=f?"is-info":"",M=m?"is-success":"",C=d?"is-outlined":"",N=g.className?g.className:"",I="".concat(N," button ").concat(p," ").concat(h," ").concat(k," ").concat(j," ").concat(O," ").concat(E," ").concat(w," ").concat(S," ").concat(S," ").concat(x," ").concat(y," ").concat(M," ").concat(C),D=b?{flexGrow:1}:{};return o.a.createElement("button",Object.assign({style:D},Object(v.a)({},g,{className:I})),g.children)},T=m.a.div(D()),_=function(e){var n=e.children,t=e.hasAddons,a=e.className,r=void 0===a?"":a,i=(e.ref,e.style),c=void 0===i?{}:i,u=e.grow,s=Object(A.a)(e,["children","hasAddons","className","ref","style","grow"]),l=t?"has-addons":"",f="".concat(r," buttons ").concat(l);return o.a.createElement(T,Object.assign({style:Object.assign(c,{flexGrow:u?1:"unset"})},s,{className:f}),n)};function P(){var e=Object(f.a)(["\n  display: flex;\n"]);return P=function(){return e},e}function L(){var e=Object(f.a)(["\n  display: flex;\n  flex-grow: 1;\n"]);return L=function(){return e},e}var R=m.a.div(L()),G=m.a.div(P()),K=function(e){var n=e.playing,t=e.activeBeats,a=e.beatIdx,r=e.division,i=e.divisionIdx,c=e.enabledDivisions,u=parseInt(r,10);return o.a.createElement(G,{key:"d".concat(u)},p.a(0,u).map(function(e){var r=n&&t[a]&&t[a][u]===e?0===a?"has-background-info":"has-background-primary":"has-background-light",s=1===u?0:5,l=0===e?0:10/u,f=e===u-1?0:10/u;return o.a.createElement(R,{key:"d".concat(u,"-").concat(e),className:"".concat(r," has-text-centered"),style:{justifyContent:"center",height:70/Object.keys(c).filter(function(e){return c[e]}).length-s,marginLeft:l,marginRight:f,marginTop:s}},0===i&&a+1)}))},z=function(e){return o.a.createElement("div",{className:"column has-text-centered"},Object.keys(e.enabledDivisions).filter(function(n){return e.enabledDivisions[n]}).map(function(n,t){return o.a.createElement(K,Object.assign({key:"".concat(e.beatIdx,"-").concat(t)},Object(v.a)({},e,{division:n,divisionIdx:t})))}))},W=function(e){var n=e.playing,t=e.signature.numerator,r=e.setSignature,i=e.activeBeats,u=Object(c.useState)(!1),s=Object(l.a)(u,2),f=s[0],m=s[1],d=x(a.SignatureDivisions,{1:!0}),b=Object(l.a)(d,2),g=b[0],k=b[1],w=Object(c.useCallback)(function(e){m(!0),r(function(n){return h.a("numerator",p.a(0,e).map(function(){return g}),n)})},[g,r]);Object(c.useEffect)(function(){f&&r(function(e){return Object(v.a)({},e,{numerator:p.a(0,e.numerator.length).map(function(){return g})})})},[g,f,r]);var y=Object(c.useCallback)(function(e){m(!0),k(function(n){return j.a(O.a([e]),E.a,n)})},[k]),S=Object(c.useCallback)(function(){k({1:!0})},[k]);return o.a.createElement(o.a.Fragment,null,o.a.createElement("h3",{className:"subtitle is-5",style:{paddingLeft:"10px",marginBottom:"0"}},"Divisions"),o.a.createElement("section",{style:{marginTop:"10px"},className:"section buttons is-centered"},o.a.createElement(_,{hasAddons:!0,grow:!0,style:{marginRight:"5px"}},[2,3,4,5,6].map(function(e){var n=g[e];return o.a.createElement(F,{grow:!0,on:n,isPrimary:!0,key:"division-options-".concat(e),onClick:function(){return y(e)}},e)})),o.a.createElement(B,{grow:!0,isDanger:!0,isOutlined:!0,onClick:S},"Clear")),o.a.createElement("section",{className:"section is-mobile columns"},t.map(function(e,t){return o.a.createElement(z,Object.assign({key:"".concat(t,"-enabledDivisionColumn")},{playing:n,beatIdx:t,enabledDivisions:e,activeBeats:i}))})),o.a.createElement("section",{className:"section buttons is-centered"},[1,2,3,4,5].map(function(e){var n=t.length===e;return o.a.createElement(F,{key:"numerator-button-".concat(e),on:n,isPrimary:!0,isOutlined:!0,grow:!0,onClick:n?function(){}:function(){return w(e)}},o.a.createElement(o.a.Fragment,null,e,"/4"))})))},q=t(86),U=t(87),J=t(51),V=t(88),H=t(80),X=t(81),Y=q.a(function(e){return U.a(2,e)},J.a(function(e){var n=Object(l.a)(e,2),t=n[0];return n[1]-t}),V.a,H.a(6e4),Math.trunc),$=function(e){var n=e.setBPM,t=Object(c.useState)([]),a=Object(l.a)(t,2),r=a[0],i=a[1];return o.a.createElement(B,{isLink:!0,isOutlined:!0,onClick:function(){var e=performance.now(),t=X.a(e,r).filter(function(n){return e-n<3e3});if(t.length>1){var a=Y(t);n(a)}i(t)}},"Tap In")};function Q(){var e=Object(f.a)(["\n  margin-top: 10px;\n"]);return Q=function(){return e},e}for(var Z={0:"A",1:"Bb",2:"B",3:"C",4:"Db",5:"D",6:"Eb",7:"E",8:"F",9:"Gb",10:"G",11:"Ab"},ee=[],ne=-4;ne<4;ne++)for(var te=0;te<12;te++){var ae=440*Math.pow(2,ne),re=ae/1200,ie=ae*Math.pow(2,te/12),ce=ne+4,oe=Z[te];ee.push({octave:ce,note:oe,frequency:ie,centsPerOctave:re})}var ue=m.a.section(Q()),se=function(){var e=C(!1),n=Object(l.a)(e,2),t=n[0],a=n[1],r=Object(c.useState)(),i=Object(l.a)(r,2),u=i[0],s=i[1],f=Object(c.useState)(),m=Object(l.a)(f,2),d=m[0],b=m[1],g=Object(c.useState)(440),v=Object(l.a)(g,2),p=v[0],h=v[1],j=Object(c.useState)(),O=Object(l.a)(j,2),E=O[0],k=O[1];Object(c.useEffect)(function(){E||k(new AudioContext)},[t,E]),Object(c.useEffect)(function(){if(t&&E){b(E.sampleRate);var e,n=navigator.mediaDevices;if(n)return n.getUserMedia({audio:!0}).then(function(n){e=n;var t=E.createAnalyser();t.fftSize=8192,E.createMediaStreamSource(n).connect(t),s(t)}),function(){e.getAudioTracks().forEach(function(e){return e.stop()})}}},[t,E]),Object(c.useEffect)(function(){if(t&&u&&d){var e=function(){var e=u.frequencyBinCount,n=new Float32Array(e);u.getFloatFrequencyData(n);var t=n.reduce(function(e,n,t){return e[0]<n?[n,t]:e},[-1/0,-1]),a=Object(l.a)(t,2)[1],r=d/u.fftSize;h(r*a)};e();var n=setInterval(e,50);return function(){clearInterval(n)}}},[t,u,d]);var w=function(e){for(var n=0,t=0;t<ee.length;t++)if(ee[t].frequency>=e){n=t;break}var a=n+1,r=ee[n],i=ee[a],c=(r.frequency+i.frequency)/2,o=ee[a],u=o.frequency-e;e<c&&(o=ee[n]);var s=o.centsPerOctave*u;return Object.assign(o,{originalFrequency:e,difference:u,cents:s})}(p||0),y=w.octave,S=w.note,x=w.cents;return o.a.createElement(ue,{className:"box has-text-centered"},o.a.createElement("div",{className:"is-size-1"},t?S+y:"Stopped"),o.a.createElement("div",null,t?o.a.createElement(o.a.Fragment,null,x.toFixed(2)," Cents ",x<0?"flat":"sharp"):"press start to tune"),o.a.createElement(_,{className:"is-right"},o.a.createElement(F,{on:t,isDanger:!0,offIsPrimary:!0,onClick:a},o.a.createElement(o.a.Fragment,null,"Stop"),o.a.createElement(o.a.Fragment,null,"Start"))))};function le(){var e=Object(f.a)(["\n  align-self: center;\n  margin: auto;\n  z-index: 1;\n  pointer-events: none;\n"]);return le=function(){return e},e}function fe(){var e=Object(f.a)(["\n  width: 100px;\n  height: 100px;\n  border-radius: 100px;\n  position: absolute;\n  touch-action: none;\n"]);return fe=function(){return e},e}function me(){var e=Object(f.a)(["\n  margin: auto;\n  position: relative;\n  height: 300px;\n  width: 300px;\n  border-radius: 300px;\n  display: flex;\n  margin-bottom: 10px;\n"]);return me=function(){return e},e}var de=m.a.div(me()),be=m.a.div(fe()),ge=m.a.div(le()),ve=function(e){var n=e.size,t=void 0===n?300:n,r=e.initialValue,i=e.addDiff,u=e.children,s=x(a.Radians,r*(3*Math.PI)/2),f=Object(l.a)(s,2),m=f[0],d=f[1],b=Object(c.useRef)(Math.PI);Object(c.useEffect)(function(){b.current=m},[m]);var g=Object(c.useState)(!1),v=Object(l.a)(g,2),p=v[0],h=v[1],j=Object(c.useRef)(!1);Object(c.useEffect)(function(){j.current=p},[p]);var O=Object(c.useState)(0),E=Object(l.a)(O,2),k=E[0],w=E[1],y=Object(c.useRef)(0);Object(c.useEffect)(function(){y.current=k},[k]);var S=Object(c.useRef)(null),M=Object(c.useCallback)(function(e){h(!1)},[]),C=Object(c.useCallback)(function(e){Math.abs(y.current)<.2?w(function(n){return n+e}):(i(y.current>0?-1:1),w(0))},[i]),N=Object(c.useCallback)(function(e){var n=e.clientX,t=e.clientY,a=S.current.getBoundingClientRect(),r=a.left+a.width/2,i=-(a.top+a.height/2-t),c=-(r-n),o=Math.atan2(i,c),u=b.current-o;u<-Math.PI?u=-b.current-o:u>Math.PI&&(u=b.current- -o),0!==u&&C(u),o===b.current||d(o)},[C,d]),A=Object(c.useCallback)(function(e){j.current&&N(e)},[N]);Object(c.useEffect)(function(){return window.addEventListener("mouseup",M),window.addEventListener("mousemove",A),function(){window.removeEventListener("mouseup",M),window.removeEventListener("mousemove",A)}},[A,M]);var I=t/2+Math.sin(m)*(t/4)+Math.sin(m)*t/16-t/6,D=t/2+Math.cos(m)*(t/4)+Math.cos(m)*t/16-t/6;return o.a.createElement(de,{ref:S,className:"has-background-primary"},o.a.createElement(be,{className:"has-background-info",onMouseDown:function(e){h(!0),e.preventDefault()},onTouchMove:function(e){var n=e.changedTouches[0];N(n)},style:{top:I,left:D}}),o.a.createElement(ge,null,u))};function pe(){var e=Object(f.a)([""]);return pe=function(){return e},e}var he=function(e){var n=e.appSettings,t=e.metronome,r=n.state.keepAwake,i=M(a.ShowTuner,!1),u=Object(l.a)(i,2),s=u[0],f=u[1],m=function(){var e=Object(c.useState)(new S.a),n=Object(l.a)(e,1)[0];return{lock:Object(c.useCallback)(function(){n.enable()},[n]),release:Object(c.useCallback)(function(){n.disable()},[n])}}(),d=m.lock,b=m.release,v=t.state,p=v.playing,h=v.signature,j=v.bpm,O=v.activeDivisions,E=t.toggleStart,k=t.setSignature,w=t.setBPM,y=t.addBPM;return Object(c.useEffect)(function(){r&&p?d():b()},[p,r,d,b]),o.a.createElement(je,null,s&&o.a.createElement(se,null),o.a.createElement("section",{className:"section"},o.a.createElement(ve,{initialValue:j,addDiff:y},o.a.createElement("div",{className:"has-text-centered is-size-1"},j),o.a.createElement(g,{bpm:j}))),o.a.createElement(W,{playing:p,signature:h,setSignature:k,activeBeats:O}),o.a.createElement("section",{className:"section"},o.a.createElement(_,{hasAddons:!0},o.a.createElement(F,{isLink:!0,offIsOutlined:!0,offIsLink:!0,on:s,onClick:f},"Tuner"),o.a.createElement($,{setBPM:w}),o.a.createElement(F,{on:p,offIsPrimary:!0,grow:!0,isOutlined:!0,isDanger:!0,onClick:E},o.a.createElement(o.a.Fragment,null,"Stop"),o.a.createElement(o.a.Fragment,null,"Start")))))},je=m.a.div(pe());function Oe(){var e=Object(f.a)([""]);return Oe=function(){return e},e}var Ee,ke=m.a.section(Oe()),we=function(e){var n=e.appSettings,t=n.state.keepAwake,a=n.toggleKeepAwake;return o.a.createElement(ke,null,o.a.createElement("h2",{className:"is-size-4"},"Settings"),o.a.createElement("div",{className:"field"},o.a.createElement("div",{className:"control"},o.a.createElement("label",{className:"checkbox"},o.a.createElement("input",{style:{marginRight:"5px"},type:"checkbox",checked:t,onChange:a}),"Keep screen on while metronome is running."))))},ye=t(47);!function(e){e.NOT_STARTED="Not Started",e.LEARNING="Learning",e.KNOWN="Known"}(Ee||(Ee={}));var Se=function(e,n){return xe(e,n)[0]},xe=function(e,n){var t=[];return Object.entries(e).forEach(function(e){var a=Object(l.a)(e,2)[1];Object.entries(a).forEach(function(e){var a=Object(l.a)(e,2)[1];n(a)&&t.push(a)})}),t},Me=function(){var e={},n=function(n){var t,a=Object(l.a)(n,2),r=a[0],i=a[1],c=e[r];void 0===c&&(c={},e[r]=c),c[i]={scaleKey:t=n,pitch:t[0],mode:t[1],known:!1,learning:!1,bpm:60}},t=!0,a=!1,r=void 0;try{for(var i,c=w[Symbol.iterator]();!(t=(i=c.next()).done);t=!0){n(i.value)}}catch(o){a=!0,r=o}finally{try{t||null==c.return||c.return()}finally{if(a)throw r}}return e},Ce=function(e){var n=Object(l.a)(e.scaleKey,2),t=n[0],a=n[1],r=e.learning,i=e.known,c=e.toggleLearning,u=e.toggleKnown;return o.a.createElement("div",{className:"is-grouped field has-addons"},o.a.createElement("div",{className:"is-size-5 control is-expanded"},t," ",a),o.a.createElement(_,null,o.a.createElement(F,{on:i,isInfo:!0,onClick:u},"Known"),o.a.createElement(F,{on:r,isLink:!0,onClick:c},"Learning")))};var Ne=function(e){var n=e.scalesDB,t=e.addBPM,a=e.reset,r=e.scaleMode,i=e.startMetronome,u=Object(c.useState)(function(){return function(e){var n,t,a;for(a=e.length-1;a>0;a--)n=Math.floor(Math.random()*(a+1)),t=e[a],e[a]=e[n],e[n]=t;return e}(xe(n,function(e){return r===Ee.LEARNING?e.learning:r===Ee.KNOWN&&e.known}).map(function(e){return e.scaleKey}))}),s=Object(l.a)(u,2),f=s[0],m=s[1],d=f[0]||[],b=Se(n,function(e){return e.mode===d[1]&&e.pitch===d[0]});Object(c.useEffect)(function(){void 0!==b&&i(b.bpm)},[b,i]);var g=f.length>1?"Next Scale":"Finish";if(0===f.length)return o.a.createElement("div",null,"No more scales");var v=b,p=v,h=p.mode,j=p.pitch,O=p.bpm;return o.a.createElement("div",null,o.a.createElement("div",{style:{alignSelf:"center",fontWeight:"bold"},className:"control is-expanded is-size-5"},r),o.a.createElement("div",{style:{display:"flex",marginBottom:"5px"}},o.a.createElement("div",{style:{alignSelf:"center",marginRight:"10px"}},j," ",h," @ ",O,"bpm"),o.a.createElement(_,{style:{flexGrow:1}},o.a.createElement(B,{isDanger:!0,isOutlined:!0,grow:!0,onClick:t(v,-10)},"-10"),o.a.createElement(B,{isDanger:!0,isOutlined:!0,grow:!0,onClick:t(v,-1)},"-"),o.a.createElement(B,{isPrimary:!0,isOutlined:!0,grow:!0,onClick:t(v,1)},"+"),o.a.createElement(B,{isPrimary:!0,isOutlined:!0,grow:!0,onClick:t(v,10)},"+10"))),o.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},o.a.createElement(B,{isDanger:!0,isOutlined:!0,onClick:a},"Stop"),o.a.createElement(B,{isPrimary:!0,onClick:function(){m(function(e){var n=e.slice(1);return 0===n.length&&a(),n})}},g)))},Ae=function(e){var n=e.metronome,t=n.stop,i=n.start,u=x(a.ScalesDB,Me),s=Object(l.a)(u,2),f=s[0],m=s[1],d=Object(c.useState)(Ee.NOT_STARTED),b=Object(l.a)(d,2),g=b[0],v=b[1];Object(c.useEffect)(function(){g===Ee.NOT_STARTED&&t()},[g,t]);var p=function(e){var n=e.pitch,t=e.mode;return function(){m(j.a(O.a([n,t,"learning"]),E.a))}},h=function(e){var n=e.pitch,t=e.mode;return function(){m(j.a(O.a([n,t,"known"]),E.a))}},k=M(a.ShowKnown,!1),w=Object(l.a)(k,2),y=w[0],S=w[1];return o.a.createElement("div",{className:"box",style:{marginTop:"10px"}},g===Ee.NOT_STARTED?o.a.createElement("div",{style:{marginBottom:"5px"}},o.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},o.a.createElement("div",{style:{alignSelf:"center",fontWeight:"bold"},className:"control is-expanded is-size-5"},"Scales"),o.a.createElement(_,null,o.a.createElement(B,{onClick:function(){return v(Ee.KNOWN)},disabled:void 0===Se(f,function(e){return e.known}),className:"is-info is-outlined"},"Start Known"),o.a.createElement(B,{onClick:function(){return v(Ee.LEARNING)},disabled:void 0===Se(f,function(e){return e.learning}),className:"is-link is-outlined"},"Start Learning"))),o.a.createElement("hr",null),o.a.createElement(_,null,o.a.createElement(B,{onClick:S,className:"".concat(y?"is-primary is-outlined":"is-danger")},y?"Hide Known":"Show Known")),xe(f,function(e){return e.mode===r.Major&&(!!y||!1===e.known)}).map(function(e){return o.a.createElement(Ce,Object.assign({key:"".concat(e.pitch,"-").concat(e.mode)},e,{toggleLearning:p(e),toggleKnown:h(e)}))}),o.a.createElement("hr",null),xe(f,function(e){return e.mode===r.Minor&&(!!y||!1===e.known)}).map(function(e){return o.a.createElement(Ce,Object.assign({key:"".concat(e.pitch,"-").concat(e.mode)},e,{toggleLearning:p(e),toggleKnown:h(e)}))})):o.a.createElement(Ne,{scaleMode:g,startMetronome:i,addBPM:function(e,n){var t=e.pitch,a=e.mode;return function(){m(j.a(O.a([t,a,"bpm"]),ye.a(n)))}},scalesDB:f,reset:function(){return v(Ee.NOT_STARTED)}}))},Ie=t(29),De=t(15),Fe=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Be(e){if("serviceWorker"in navigator){if(new URL("/metronome",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var n="".concat("/metronome","/service-worker.js");Fe?(!function(e,n){fetch(e).then(function(t){var a=t.headers.get("content-type");404===t.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):Te(e,n)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(n,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):Te(n,e)})}}function Te(e,n){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;null!=t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),n&&n.onUpdate&&n.onUpdate(e)):(console.log("Content is cached for offline use."),n&&n.onSuccess&&n.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}function _e(){var e=Object(f.a)(["\n  position: absolute;\n  max-width: ",";\n  width: 95%;\n  margin-top: 10px;\n  left: 0;\n  right: 0;\n  margin-left: auto;\n  margin-right: auto;\n  z-index: 10;\n  display: flex !important;\n  justify-content: space-between;\n  animation: ease-in 1s ",";\n"]);return _e=function(){return e},e}function Pe(){var e=Object(f.a)(["\n    from {\n      opacity: 0;\n    }\n    to {\n      opacity: 1;\n    }\n"]);return Pe=function(){return e},e}var Le=Object(m.b)(Pe()),Re=m.a.section(_e(),"40em",Le),Ge=function(){var e=Object(c.useState)(!1),n=Object(l.a)(e,2),t=n[0],a=n[1],r=o.a.useCallback(function(){window.location.reload()},[]),i=o.a.useCallback(function(){a(!1)},[]);return Object(c.useEffect)(function(){Be({onUpdate:function(){a(!0)}})}),o.a.createElement(o.a.Fragment,null,t&&o.a.createElement(Re,{className:"box"},o.a.createElement("span",null,"An Update is Available!"),o.a.createElement(_,null,o.a.createElement(B,{isPrimary:!0,isOutlined:!0,onClick:r},"Refresh"),o.a.createElement(B,{isDanger:!0,isOutlined:!0,onClick:i},"x"))))},Ke=function(){return{keepAwake:!1}},ze=t(21),We=t(52),qe=t(82),Ue=t(83),Je=t(84),Ve=t(48),He=t.n(Ve);var Xe=t(67),Ye=function(e,n){var t=n.time,a=n.gain,r=n.buffer,i=n.pitch,c=n.currentBeat,o=n.divisionIndex,u=0===c&&0===o,s=e.createBufferSource();s.buffer=r,s.detune.value=u?0:-i;var l=e.createGain();l.gain.value=u?1:a,s.connect(l),l.connect(e.destination),s.start(t)},$e=function(e,n,t,a,r,i,c,o,u){var s=60/e.bpm,l=t;if(n.current<r+i){var f=function(e,n,t,a,r){var i=[];for(var c in t)if(t[c])for(var o=parseInt(c,10),u=n/o,s=0;s<o;s++){var l={time:e+s*u,pitch:220,gain:.5,buffer:a,divisions:o,divisionIndex:s,currentBeat:r};i.push(l)}return i.sort(function(e,n){return e.time-n.time}),i}(n.current,s,l,c,a);o.push.apply(o,Object(We.a)(f)),n.current+=s,u()}},Qe=.1,Ze=function(e,n,t){var a=n.playing,r=function(e,n){var t=Object(c.useState)(),a=Object(l.a)(t,2),r=a[0],i=a[1];return Object(c.useEffect)(function(){void 0!==e&&fetch(n).then(function(e){return e.arrayBuffer()}).then(function(n){return e.decodeAudioData(n)}).then(i)},[n,e]),r}(e,Xe),i=Object(c.useRef)(0),o=a?150:void 0,u=Object(c.useRef)(n);Object(c.useEffect)(function(){u.current=n},[n]);var s=Object(c.useState)(0),f=Object(l.a)(s,2),m=f[0],d=f[1];Object(c.useEffect)(function(){n.playing||d(0)},[n.playing]);var b=Object(c.useRef)(m);Object(c.useEffect)(function(){b.current=m},[m]);var g=function(){d(function(e){return(e+1)%u.current.signature.numerator.length})},p=Object(c.useCallback)(function(e){t(function(n){var t=qe.a(e.currentBeat,function(n){return Object(v.a)({},n,Object(ze.a)({},e.divisions,e.divisionIndex))},n),a=e.currentBeat-1;if(a<0){if(1===n.length)return t;a=u.current.signature.numerator.length-1}return qe.a(a,function(e){return Object.keys(e).reduce(function(e,n){return Object(v.a)({},e,Object(ze.a)({},n,void 0))},{})},t)})},[t]),h=Object(c.useCallback)(function(e,n){!function e(n,t,a){var r=n.currentTime;t<=r?a():setTimeout(function(){return e(n,t,a)},(t-r)/2*1e3)}(e,n.time,function(){u.current.playing&&p(n)})},[p]);Object(c.useEffect)(function(){if(void 0!==o&&void 0!==e&&void 0!==r){var n=new He.a,t=e.currentTime+.3;i.current=t;var a=function(){var t=u.current.signature.numerator,a=t[Math.min(b.current,t.length-1)];$e(u.current,i,a,b.current,e.currentTime,.3,r,n,g),function(e,n,t,a){for(var r=t.currentTime+n+Qe;e.peekFront()&&e.peekFront().time<r;){var i=e.shift();0===i.divisionIndex&&1!==i.divisions||Ye(t,i),a(t,i)}}(n,o/1e3,e,h)};a();var c=setInterval(a,o);return function(){clearInterval(c)}}},[o,r,e,t,p,h])},en=function(e){return e.map(function(e){return Ue.a(function(){},e)})},nn=function(e){return Je.a(10,250,e)},tn=function(e){var n=Object(c.useState)(!1),t=Object(l.a)(n,2),r=t[0],i=t[1],o=function(e,n){var t=Object(l.a)(e,2),a=t[0],r=t[1],i=Object(c.useCallback)(function(e){r(function(t){return n(e instanceof Function?e(t):e)})},[n,r]);return N(n,r),[a,i]}(x(a.BPM,90),nn),u=Object(l.a)(o,2),s=u[0],f=u[1],m=x(a.TimeSignature,{denominator:4,numerator:[{1:!0},{1:!0},{1:!0}]}),d=Object(l.a)(m,2),b=d[0],g=d[1],v=x(a.ActiveBeats,en(b.numerator)),p=Object(l.a)(v,2),h=p[0],j=p[1],O={bpm:s,playing:r,signature:b,activeDivisions:h},k=b.numerator,w=Object(c.useRef)(s);Object(c.useEffect)(function(){w.current=s},[s]),Object(c.useEffect)(function(){j(en(k))},[k,b,j]),Object(c.useEffect)(function(){r||(j(en(k)),setTimeout(function(){j(en(k))},300))},[r,k,j]),Ze(e,O,j);return{toggleStart:function(){return i(E.a)},setSignature:g,start:Object(c.useCallback)(function(e){void 0!==e&&f(e),i(!0)},[i,f]),stop:Object(c.useCallback)(function(){i(!1)},[i]),setBPM:f,addBPM:function(e){f(ye.a(e))},state:O}},an=t(33),rn=t(23);function cn(){var e=Object(f.a)(["\n  display: flex;\n  flex-direction: column;\n  align-items: flex-end;\n  justify-content: flex-end;\n  margin-top: 5px;\n"]);return cn=function(){return e},e}function on(){var e=Object(f.a)(["\n  max-width: ",";\n  margin: 0 auto;\n  display: flex;\n  flex-direction: column;\n  > * {\n    margin-left: 10px;\n    margin-right: 10px;\n  }\n"]);return on=function(){return e},e}function un(){var e=Object(f.a)(["\n  margin-left: 5px;\n"]);return un=function(){return e},e}function sn(){var e=Object(f.a)([""]);return sn=function(){return e},e}function ln(){var e=Object(f.a)(["\n  display: flex;\n  flex-direction: column;\n  align-items: flex-end;\n  padding-right: 10px;\n  align-self: flex-end;\n  > a {\n    animation: ease-in 0.3s ",";\n    font-size: 1.5rem;\n  }\n"]);return ln=function(){return e},e}function fn(){var e=Object(f.a)(["\n  from {\nfont-size: 0px;\n  }\n"]);return fn=function(){return e},e}function mn(){var e=Object(f.a)(["\n  display: flex;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  padding-left: 10px;\n  padding-right: 10px;\n  justify-content: space-between;\n  > h2 {\n    margin: 0 !important;\n  }\n"]);return mn=function(){return e},e}function dn(){var e=Object(f.a)(["\n  align-self: center;\n"]);return dn=function(){return e},e}function bn(){var e=Object(f.a)(["\n  margin-bottom: 10px;\n  margin-left: 0px !important;\n  margin-right: 0px !important;\n  display: flex;\n  flex-direction: column;\n"]);return bn=function(){return e},e}var gn=m.a.section(bn()),vn=m.a.span(dn()),pn=m.a.section(mn()),hn=Object(m.b)(fn()),jn=m.a.nav(ln(),hn),On=Object(m.a)(Ie.b)(sn()),En=Object(m.a)(an.a)(un()),kn=function(){var e=C(!1),n=Object(l.a)(e,2),t=n[0],a=n[1];return o.a.createElement(gn,null,o.a.createElement(pn,{className:"has-background-primary has-text-light"},o.a.createElement(Ie.b,{to:"/",className:"has-text-white"},o.a.createElement("h2",{className:"is-size-4 is-bold"},"(mjh)tronome")),o.a.createElement(vn,{onClick:a},o.a.createElement(an.a,{icon:rn.a,size:"2x"}))),t&&o.a.createElement(jn,{onClick:a},o.a.createElement(On,{to:"/"},"Home",o.a.createElement(En,{icon:rn.c})),o.a.createElement(On,{to:"/scales"},"Scales",o.a.createElement(En,{icon:rn.d})),o.a.createElement(On,{to:"/settings"},"Settings",o.a.createElement(En,{icon:rn.b}))))},wn=m.a.div(on(),"40em"),yn=m.a.div(cn()),Sn=function(e){var n=e.children;return o.a.createElement(wn,null,o.a.createElement(Ge,null),o.a.createElement(kn,null),n,o.a.createElement(yn,null,"v".concat("1.0.10")))},xn=function(){var e=function(){var e=x(a.AppSettings,Ke),n=Object(l.a)(e,2),t=n[0],r=n[1];return{state:t,toggleKeepAwake:o.a.useCallback(function(){r(function(e){return Object(v.a)({},e,{keepAwake:!e.keepAwake})})},[r])}}(),n=function(e){var n=Object(c.useState)(e),t=Object(l.a)(n,2),a=t[0],r=t[1],i=Object(c.useCallback)(function(e){a||r(e)},[a]);return{value:a,init:i}}(),t=n.value,r=n.init,i=tn(t),u=i.state.playing;return o.a.useEffect(function(){u&&r(new AudioContext)},[u]),o.a.createElement(Ie.a,{basename:"/metronome"},o.a.createElement(Sn,null,o.a.createElement(De.a,{exact:!0,path:"/",render:function(){return o.a.createElement(he,{metronome:i,appSettings:e})}}),o.a.createElement(De.a,{exact:!0,path:"/scales",render:function(){return o.a.createElement(Ae,{metronome:i})}}),o.a.createElement(De.a,{exact:!0,path:"/settings",render:function(){return o.a.createElement(we,{appSettings:e})}})))};t(75);s.a.render(o.a.createElement(xn,null),document.getElementById("root"))}},[[54,1,2]]]);
//# sourceMappingURL=main.ef6534e9.chunk.js.map