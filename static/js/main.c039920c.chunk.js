(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{65:function(e,n,t){e.exports=t(89)},80:function(e,n,t){e.exports=t.p+"static/media/click.b48ed3e5.wav"},88:function(e,n,t){},89:function(e,n,t){"use strict";t.r(n);var a,r,i,o=t(51),c=t(52),u=t(62),s=t(53),l=t(63),m=t(0),f=t.n(m),d=t(23),g=t.n(d),v=t(1),p=t(4),h=t(10),b=t(92),E=t(8),S=t(31),w={isActive:!1,isAccented:!1},k=h.List(),j=h.Map();h.List();!function(e){e.EnabledDivisions="@mjh/k/enabled-divisions-0",e.AppSettings="@mjh/k/app-settings-0",e.SignatureDivisions="@mjh/k/signature-divisions-3",e.ShowKnown="@mjh/k/show-known-2",e.ScalesDB="@mjh/k/scales-db-2",e.ActiveBeats="@mjh/k/active-beats-2",e.TimeSignature="@mjh/k/signature-3",e.BPM="@mjh/k/bpm-0",e.KnownScales="@mjh/k/known-scales-0",e.ShowScales="@mjh/k/show-scales-0",e.ShowTuner="@mjh/k/show-tuner-0",e.ShowDial="@mjh/k/show-dial-0",e.Radians="@mjh/k/radians-0",e.WakeLock="@mjh/k/wake-lock-0"}(a||(a={})),function(e){e.Major="Major",e.Minor="Minor"}(r||(r={})),function(e){e.A="A",e.B="B",e.C="C",e.D="D",e.E="E",e.F="F",e.G="G",e.A_Flat="Ab",e.B_Flat="Bb",e.C_Flat="Cb",e.D_Flat="Db",e.E_Flat="Eb",e.F_Flat="Fb",e.G_Flat="Gb",e.A_Sharp="A#",e.B_Sharp="B#",e.C_Sharp="C#",e.D_Sharp="D#",e.E_Sharp="E#",e.F_Sharp="F#",e.G_Sharp="G#"}(i||(i={}));var O=[[i.A,r.Major],[i.B,r.Major],[i.C,r.Major],[i.D,r.Major],[i.E,r.Major],[i.F,r.Major],[i.G,r.Major],[i.A_Flat,r.Major],[i.B_Flat,r.Major],[i.C_Flat,r.Major],[i.D_Flat,r.Major],[i.E_Flat,r.Major],[i.G_Flat,r.Major],[i.C_Sharp,r.Major],[i.F_Sharp,r.Major],[i.A,r.Minor],[i.B,r.Minor],[i.C,r.Minor],[i.D,r.Minor],[i.E,r.Minor],[i.F,r.Minor],[i.G,r.Minor],[i.A_Flat,r.Minor],[i.B_Flat,r.Minor],[i.E_Flat,r.Minor],[i.A_Sharp,r.Minor],[i.C_Sharp,r.Minor],[i.D_Sharp,r.Minor],[i.F_Sharp,r.Minor],[i.G_Sharp,r.Minor]],y=t(34),x=t(91),A=t(61),C=t(100),M=t(90),N=(t(55),window.AudioContext||window.webkitAudioContext||void 0),I=t(21),F=t(56),B=t.n(F),D=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=f.a.useState(function(){var a,r=localStorage.getItem(e);return a=null===r||void 0===r||t?n instanceof Function?n():n:I.fromJSON(r),window.localStorage.setItem(e,I.toJSON(a)),a}),r=Object(v.a)(a,2),i=r[0],o=r[1];return[i,f.a.useCallback(function(n){o(function(t){var a=n instanceof Function?n(t):n;return window.localStorage.setItem(e,I.toJSON(a)),a})},[e])]},L=function(e,n){var t=D(e,n),a=Object(v.a)(t,2),r=a[0],i=a[1];return[r,f.a.useCallback(function(){i(M.a)},[i])]},T=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){},t=f.a.useState(e),a=Object(v.a)(t,2),r=a[0],i=a[1];return[r,f.a.useCallback(function(){return i(function(e){var t=!e;return n(t),t})},[n])]},P=t(57),_=t.n(P);var z,R=function(e,n){var t=localStorage.getItem(e);return null===t?n:I.fromJSON(t)},K=function(e,n){localStorage.setItem(e,I.toJSON(n))},G=t(80),W=function(e,n){var t=n.time,a=n.gain,r=n.buffer,i=e.createBufferSource();i.buffer=r;var o=e.createGain();o.gain.value=a,i.connect(o),o.connect(e.destination),i.start(t)},q=-1,U=function(e,n,t,a,r,i,o,c,u){var s=60/e,l=t;if(n.current<r+i){var m=function(e,n,t,a,r){var i=[],o=ve.getState().activeBeats;return t.filter(function(e){return e}).forEach(function(t,c){for(var u=n/c,s=0;s<c;s++){var l=o.get(r,j).get(c,k).get(s,w).isAccented,m={time:e+s*u,divisionLength:u,pitch:220,gain:l?1:.1,buffer:a,divisions:c,divisionIndex:s,currentBeat:r,isAccented:l};i.push(m)}}),i.sort(function(e,n){return e.time-n.time}),i}(n.current,s,l,o,a);c.push.apply(c,Object(A.a)(m)),n.current+=s,u()}},J=.1,H=function(e){var n=pe(function(e){return e.metronomeState.playing}),t=function(e,n){var t=f.a.useState(),a=Object(v.a)(t,2),r=a[0],i=a[1];return f.a.useEffect(function(){void 0!==e&&"not-supported"!==e&&"pending"!==e&&fetch(n).then(function(e){return e.arrayBuffer()}).then(function(n){return e.decodeAudioData(n)}).then(i)},[n,e]),r}(e,G),a=f.a.useRef(0),r=n?150:void 0,i=f.a.useRef(0);f.a.useEffect(function(){n||(i.current=0)},[n]);var o=f.a.useCallback(function(){var e=i.current;i.current=(e+1)%ve.getState().metronomeState.signature.numerator.size},[]),c=f.a.useCallback(function(e,n){!function(e,n,t){setTimeout(t,1e3*(n-e.currentTime))}(e,n.time,function(){ve.getState().metronomeState.playing&&oe(n)})},[]);f.a.useEffect(function(){if(void 0!==r&&void 0!==e&&"not-supported"!==e&&"pending"!==e&&void 0!==t){var n=new _.a,u=e.currentTime+.3;a.current=u;var s=function(){var u=ve.getState().metronomeState.signature.numerator,s=Math.min(i.current,u.size-1),l=u.get(s);void 0!==l&&U(ve.getState().metronomeState.bpm,a,l,i.current,e.currentTime,.3,t,n,o),function(e,n,t,a){for(var r=t.currentTime+n+J;e.peekFront()&&e.peekFront().time<r;){var i=e.shift();(i.time!==q||i.isAccented)&&W(t,i),q=i.time,a(t,i)}}(n,r/1e3,e,c)};s();var l=setInterval(s,r);return function(){clearInterval(l)}}},[r,t,e,c,o])},V=function(e){return h.List(e.map(function(e){return e.reduce(function(e,n,t){return n?e.set(t,h.List(C.a(0,t).map(function(){return{isActive:!0,isAccented:!1}}))):e},h.Map())}))},Y=function(e){var n=pe(function(e){return e.metronomeState.playing});f.a.useEffect(function(){if(n)return function(){se()}},[n]);var t=pe(function(e){return e.metronomeState.signature.numerator});f.a.useEffect(function(){ie()},[t]),f.a.useEffect(function(){n||ie()},[n]),f.a.useEffect(function(){"pending"!==e&&void 0!==e&&ee(!1)},[e]),H(e)};!function(e){e[e.UpdateActiveBeats=0]="UpdateActiveBeats",e[e.SetActiveBeats=1]="SetActiveBeats",e[e.SetSignature=2]="SetSignature",e[e.SetPending=3]="SetPending",e[e.SetPlaying=4]="SetPlaying",e[e.SetKeepAwake=5]="SetKeepAwake",e[e.SetBpm=6]="SetBpm"}(z||(z={}));var X=function(e,n,t,a){re(function(r){return r.update(e,function(e){return e.update(n,function(e){return e.update(t,function(e){return Object(E.a)({},e,{isAccented:ge(a,e.isAccented)})})})})})},$=function(){Q(function(e){return!e})},Q=function(e){ve.dispatch({type:z.SetKeepAwake,action:e})},Z=function(e){var n=e instanceof Function?e(ve.getState().metronomeState.signature):e;K(a.TimeSignature,n),ve.dispatch({type:z.SetSignature,action:n})},ee=function(e){ve.dispatch({type:z.SetPending,action:e})},ne=function(e){ve.dispatch({type:z.SetPlaying,action:e})},te=function(e){var n=de(e instanceof Function?e(ve.getState().metronomeState.bpm):e);K(a.BPM,n),ve.dispatch({type:z.SetBpm,action:n})},ae=function(e){te(function(n){return n+e})},re=function(e){ve.dispatch({type:z.SetActiveBeats,action:e})},ie=function(){re(V(ve.getState().metronomeState.signature.numerator))},oe=function(e){ve.dispatch({type:z.UpdateActiveBeats,value:e})},ce=function(){ne(function(e){return!e})},ue=function(e){void 0!==e&&te(e),ne(!0)},se=function(){ne(!1)},le=h.Map().set(1,!0),me=R(a.TimeSignature,{denominator:4,numerator:h.List([le,le,le,le])}),fe={activeBeats:V(me.numerator),settings:R(a.AppSettings,{keepAwake:!1}),metronomeState:{ready:!1,pending:!0,bpm:R(a.BPM,60),playing:!1,signature:me}},de=function(e){return x.a(10,250,e)},ge=function(e,n){return e instanceof Function?e(n):e},ve=S.b(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fe,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case z.SetActiveBeats:return Object(E.a)({},e,{activeBeats:ge(n.action,e.activeBeats)});case z.SetKeepAwake:return Object(E.a)({},e,{settings:Object(E.a)({},e.settings,{keepAwake:ge(n.action,e.settings.keepAwake)})});case z.UpdateActiveBeats:var t=n.value;return void 0===e.activeBeats.getIn([t.currentBeat,t.divisions,t.divisionIndex])?e:Object(E.a)({},e,{activeBeats:e.activeBeats.update(t.currentBeat,function(e){return e.update(t.divisions,function(e){return e.update(t.divisionIndex,function(e){return Object(E.a)({},e,{isActive:!e.isActive})})})})});case z.SetSignature:return Object(E.a)({},e,{metronomeState:Object(E.a)({},e.metronomeState,{signature:n.action instanceof Function?n.action(e.metronomeState.signature):n.action})});case z.SetPending:return Object(E.a)({},e,{metronomeState:Object(E.a)({},e.metronomeState,{pending:n.action instanceof Function?n.action(e.metronomeState.pending):n.action})});case z.SetPlaying:return Object(E.a)({},e,{metronomeState:Object(E.a)({},e.metronomeState,{playing:n.action instanceof Function?n.action(e.metronomeState.playing):n.action})});case z.SetBpm:return Object(E.a)({},e,{metronomeState:Object(E.a)({},e.metronomeState,{bpm:n.action instanceof Function?n.action(e.metronomeState.bpm):n.action})});default:return n.type.startsWith("@@redux")||console.log(n,"was not handled"),e}}),pe=function(e,n){return y.b(e,n)},he=h.List([{name:"Larghissimo",low:0,high:24},{name:"Grave",low:25,high:45},{name:"Largo",low:40,high:60},{name:"Lento",low:45,high:60},{name:"Larghetto",low:60,high:66},{name:"Adagio",low:66,high:76},{name:"Andante",low:76,high:108},{name:"Marcia moderato",low:83,high:85},{name:"Andante moderato",low:92,high:112},{name:"Moderato",low:108,high:120},{name:"Allegro",low:120,high:156},{name:"Vivace",low:156,high:176},{name:"Vivacissimo",low:172,high:176},{name:"Allegrissimo",low:172,high:176},{name:"Presto",low:168,high:200},{name:"Prestissimo",low:200,high:250}]),be=b.a(function(e){return""+e},function(e){return he.filter(function(n){var t,a,r=n.high,i=n.low;return t=r,(a=e)>=i&&a<=t})}),Ee=f.a.memo(function(e){var n=e.name,t=e.low,a=e.high;return f.a.createElement("div",{className:"has-text-centered"},n," - ",t," - ",a)}),Se=f.a.memo(function(e){var n=e.bpm,t=be(n);return f.a.createElement("div",{style:{minHeight:"6.5em"}},t.map(function(e){var n=e.name,t=e.high,a=e.low;return f.a.createElement(Ee,{key:"marking-".concat(n),name:n,high:t,low:a})}))},function(e,n){var t=e.bpm,a=n.bpm;return be(t).equals(be(a))}),we=function(){var e=pe(function(e){return e.metronomeState.bpm});return f.a.createElement(Se,{bpm:e})},ke=t(5),je=t(38),Oe=t(93),ye=t(40),xe=t.n(ye);function Ae(){var e=Object(p.a)(["\n  &:not(:last-child) {\n    margin-bottom: 0 !important;\n  }\n"]);return Ae=function(){return e},e}var Ce=["offIsPrimary","offIsLink","offIsDanger","offIsInfo","offIsSuccess","offIsOutlined"],Me=["isPrimary","isLink","isDanger","isInfo","isSuccess","isOutlined"],Ne=function(e){var n=e.on,t=Object(je.a)(e,["on"]),a=f.a.useMemo(function(){var e=n?Ce:Me;return Oe.a(e,t)},[n,t]),r=f.a.useMemo(function(){return t.children instanceof Array&&2===t.children.length?n?t.children[0]:t.children[1]:t.children},[t,n]);return f.a.createElement(Ie,a,r)},Ie=function(e){var n=e.isPrimary,t=e.isDanger,a=e.isLink,r=e.isInfo,i=e.isSuccess,o=e.isOutlined,c=e.offIsPrimary,u=e.offIsDanger,s=e.offIsLink,l=e.offIsInfo,m=e.offIsSuccess,d=e.offIsOutlined,g=e.grow,v=e.className,p=Object(je.a)(e,["isPrimary","isDanger","isLink","isInfo","isSuccess","isOutlined","offIsPrimary","offIsDanger","offIsLink","offIsInfo","offIsSuccess","offIsOutlined","grow","className"]),h=f.a.useMemo(function(){return xe()("button",v,{"is-primary":n||c,"is-link":a||s,"is-danger":t||u,"is-info":r||l,"is-success":i||m,"is-outlined":o||d,"is-grow":g})},[v,g,n,c,a,s,t,u,r,l,o,d,i,m]),b=f.a.useMemo(function(){return Object(E.a)({},p,{className:h})},[p,h]);return f.a.createElement("button",b,p.children)},Fe=ke.a.div(Ae()),Be=function(e){var n=e.children,t=e.hasAddons,a=e.ref,r=e.className,i=e.grow,o=Object(je.a)(e,["children","hasAddons","ref","className","grow"]),c=f.a.useMemo(function(){return xe()(r,"buttons",{"has-addons":t,"is-grow":i})},[t,i,r]);return f.a.createElement(Fe,Object.assign({ref:a},o,{className:c}),n)};function De(){var e=Object(p.a)(["\n  display: flex;\n  flex-grow: 1;\n  margin-bottom: 10px;\n"]);return De=function(){return e},e}function Le(){var e=Object(p.a)(["\n  display: flex;\n  flex-grow: 1;\n  flex-direction: column;\n"]);return Le=function(){return e},e}function Te(){var e=Object(p.a)(["\n  display: flex;\n  flex-grow: 1;\n"]);return Te=function(){return e},e}function Pe(){var e=Object(p.a)(["\n  width: 1px;\n  margin-left: 1px;\n  margin-right: 1px;\n  flex-grow: 1;\n  text-align: center;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n"]);return Pe=function(){return e},e}function _e(){var e=Object(p.a)(["\n  display: flex;\n  align-items: baseline;\n  > button {\n    margin-right: 5px;\n  }\n  > div {\n    margin-right: 5px;\n  }\n"]);return _e=function(){return e},e}var ze=f.a.memo(ke.a.section(_e())),Re=f.a.memo(function(e){var n=e.uiEnabledDivisions,t=e.toggleDivisionOption,a=e.clearDivisions,r=pe(function(e){return e.activeBeats.getIn([0,1,0],w).isAccented}),i=f.a.useState(r),o=Object(v.a)(i,2),c=o[0],u=o[1];return f.a.useEffect(function(){r!==c&&u(r)},[r]),f.a.useEffect(function(){X(0,1,0,c)},[c]),f.a.createElement(ze,null,f.a.createElement("div",{className:"is-size-5"},"Division"),f.a.createElement(Ne,{isLink:!0,on:c,onClick:function(){return u(function(e){return!e})}},">"),f.a.createElement(Be,{hasAddons:!0,grow:!0,style:{marginRight:"5px"}},[2,3,4,5,6].map(function(e){var a=n.get(e);return f.a.createElement(Ne,{grow:!0,on:a,isPrimary:!0,key:"division-options-".concat(e),onClick:function(){return t(e)}},e)})),f.a.createElement(Ie,{grow:!0,isDanger:!0,isOutlined:!0,onClick:a},"Clear"))}),Ke=f.a.memo(function(e){var n=e.setCurrentNumerator,t=e.currentNumerator;return f.a.createElement("section",{className:"section buttons is-centered"},[1,2,3,4,5].map(function(e){var a=t===e;return f.a.createElement(Ne,{key:"numerator-button-".concat(e),on:a,isPrimary:!0,isOutlined:!0,grow:!0,onClick:a?function(){}:function(){return n(e)}},f.a.createElement(f.a.Fragment,null,e,"/4"))}))}),Ge=f.a.memo(ke.a.div(Pe())),We=f.a.memo(ke.a.div(Te())),qe=f.a.memo(ke.a.div(Le())),Ue=f.a.memo(ke.a.div(De())),Je=f.a.memo(function(e){var n=e.height,t=e.beatIndex,a=e.division,r=e.divisionIndex,i=pe(function(e){return e.activeBeats.get(t).get(a).get(r)}),o=f.a.useMemo(function(){return i.isActive?"has-background-primary":"has-background-link"},[i.isActive]);return f.a.createElement(Ge,{className:o,onClick:function(){return function(e,n,t){X(e,n,t,function(e){return!e})}(t,a,r)},style:{height:n,marginTop:1}},f.a.createElement("div",null,i.isAccented&&">"))}),He=f.a.memo(function(e){var n=e.height,t=e.beatIndex,a=e.division;return f.a.createElement(We,null,C.a(0,a).map(function(e){return f.a.createElement(Je,{key:"".concat(t,"-").concat(a,"-").concat(e),height:n,beatIndex:t,division:a,divisionIndex:e})}))}),Ve=f.a.memo(function(e){var n=e.beatIndex,t=pe(function(e){return e.activeBeats.get(n).keySeq()},function(e,n){return e.equals(n)});return f.a.createElement(qe,{key:"".concat(n)},t.map(function(e){return f.a.createElement(He,{height:70/t.size,key:"".concat(n,"-").concat(e),beatIndex:n,division:e})}))}),Ye=f.a.memo(function(){var e=pe(function(e){return e.activeBeats.size});return f.a.createElement(Ue,null,C.a(0,e).map(function(e){return f.a.createElement(Ve,{key:e,beatIndex:e})}))}),Xe=function(){var e=Z,n=pe(function(e){return e.metronomeState.signature.numerator}),t=f.a.useState(!1),r=Object(v.a)(t,2),i=r[0],o=r[1],c=D(a.EnabledDivisions,h.Map().set(1,!0)),u=Object(v.a)(c,2),s=u[0],l=u[1];f.a.useEffect(function(){i&&e(function(e){return Object(E.a)({},e,{numerator:h.List(C.a(0,e.numerator.size).map(function(){return s}))})})},[s,i,e]);var m=f.a.useCallback(function(e){o(!0),l(function(n){var t=n.get(e),a=void 0===t||!t;return n.set(e,a)})},[l]),d=f.a.useCallback(function(){l(h.Map().set(1,!0))},[l]),g=f.a.useState(n.size),p=Object(v.a)(g,2),b=p[0],S=p[1];return f.a.useEffect(function(){e(function(e){return Object(E.a)({},e,{numerator:h.List(C.a(0,b).map(function(){return s}))})})},[b,e,s]),f.a.createElement(f.a.Fragment,null,f.a.createElement(Ye,null),f.a.createElement(Re,{uiEnabledDivisions:s,toggleDivisionOption:m,clearDivisions:d}),f.a.createElement(Ke,{currentNumerator:n.size,setCurrentNumerator:S}))},$e=t(97),Qe=t(99),Ze=t(96),en=t(98),nn=t(94),tn=t(95),an=$e.a(function(e){return Qe.a(2,e)},Ze.a(function(e){var n=Object(v.a)(e,2),t=n[0];return n[1]-t}),en.a,nn.a(6e4),Math.trunc),rn=function(){var e=f.a.useState([]),n=Object(v.a)(e,2),t=n[0],a=n[1];return f.a.createElement(Ie,{isLink:!0,isOutlined:!0,onClick:function(){var e=performance.now(),n=tn.a(e,t).filter(function(n){return e-n<3e3});if(n.length>1){var r=an(n);te(r)}a(n)}},"Tap In")};function on(){var e=Object(p.a)(["\n  margin-top: 10px;\n"]);return on=function(){return e},e}for(var cn={0:"A",1:"Bb",2:"B",3:"C",4:"Db",5:"D",6:"Eb",7:"E",8:"F",9:"Gb",10:"G",11:"Ab"},un=[],sn=-4;sn<4;sn++)for(var ln=0;ln<12;ln++){var mn=440*Math.pow(2,sn),fn=mn/1200,dn=mn*Math.pow(2,ln/12),gn=sn+4,vn=cn[ln];un.push({octave:gn,note:vn,frequency:dn,centsPerOctave:fn})}var pn=f.a.memo(function(){var e=T(!1),n=Object(v.a)(e,2),t=n[0],a=n[1],r=f.a.useState(),i=Object(v.a)(r,2),o=i[0],c=i[1],u=f.a.useState(),s=Object(v.a)(u,2),l=s[0],m=s[1],d=f.a.useState(440),g=Object(v.a)(d,2),p=g[0],h=g[1],b=f.a.useState(),E=Object(v.a)(b,2),S=E[0],w=E[1];f.a.useEffect(function(){t&&!S&&void 0!==N&&w(new N)},[t,S]),f.a.useEffect(function(){if(t&&S){m(S.sampleRate);var e,n=navigator.mediaDevices;if(n)return n.getUserMedia({audio:!0}).then(function(n){e=n;var t=S.createAnalyser();t.fftSize=8192,S.createMediaStreamSource(n).connect(t),c(t)}),function(){e.getAudioTracks().forEach(function(e){return e.stop()})}}},[t,S]),f.a.useEffect(function(){if(t&&o&&l){var e=function(){var e=o.frequencyBinCount,n=new Float32Array(e);o.getFloatFrequencyData(n);var t=n.reduce(function(e,n,t){return e[0]<n?[n,t]:e},[-1/0,-1]),a=Object(v.a)(t,2)[1],r=l/o.fftSize;h(r*a)};e();var n=setInterval(e,50);return function(){clearInterval(n)}}},[t,o,l]);var k=function(e){for(var n=0,t=0;t<un.length;t++)if(un[t].frequency>=e){n=t;break}var a=n+1,r=un[n],i=un[a],o=(r.frequency+i.frequency)/2,c=un[a],u=c.frequency-e;e<o&&(c=un[n]);var s=c.centsPerOctave*u;return Object.assign(c,{originalFrequency:e,difference:u,cents:s})}(p||0),j=k.octave,O=k.note,y=k.cents;return f.a.createElement(hn,{className:"box has-text-centered"},f.a.createElement("div",{className:"is-size-1"},t?O+j:"Stopped"),f.a.createElement("div",null,t?f.a.createElement(f.a.Fragment,null,y.toFixed(2)," Cents ",y<0?"flat":"sharp"):"press start to tune"),f.a.createElement(Be,{className:"is-right"},f.a.createElement(Ne,{on:t,isDanger:!0,offIsPrimary:!0,onClick:a},f.a.createElement(f.a.Fragment,null,"Stop"),f.a.createElement(f.a.Fragment,null,"Start"))))}),hn=ke.a.section(on()),bn=pn;function En(){var e=Object(p.a)(["\n  align-self: center;\n  margin: auto;\n  z-index: 1;\n  pointer-events: none;\n"]);return En=function(){return e},e}function Sn(){var e=Object(p.a)(["\n  width: 100px;\n  height: 100px;\n  border-radius: 100px;\n  position: absolute;\n  touch-action: none;\n"]);return Sn=function(){return e},e}function wn(){var e=Object(p.a)(["\n  margin: auto;\n  position: relative;\n  height: 300px;\n  width: 300px;\n  border-radius: 300px;\n  display: flex;\n  margin-bottom: 10px;\n"]);return wn=function(){return e},e}var kn=ke.a.div(wn()),jn=ke.a.div(Sn()),On=function(e){var n=e.container,t=e.addDiff,r=e.size,i=D(a.Radians,3*Math.PI/2),o=Object(v.a)(i,2),c=o[0],u=o[1],s=f.a.useRef(Math.PI);f.a.useEffect(function(){s.current=c},[c]);var l=f.a.useCallback(function(e){p(!0),e.preventDefault()},[]),m=f.a.useState(!1),d=Object(v.a)(m,2),g=d[0],p=d[1],h=f.a.useRef(!1);f.a.useEffect(function(){h.current=g},[g]);var b=f.a.useState(0),E=Object(v.a)(b,2),S=E[0],w=E[1],k=f.a.useRef(0);f.a.useEffect(function(){k.current=S},[S]);var j=f.a.useCallback(function(e){p(!1)},[]),O=f.a.useCallback(function(e){Math.abs(k.current)<.2?w(function(n){return n+e}):(t(k.current>0?-1:1),w(0))},[t]),y=f.a.useCallback(function(e){if(null!==n){var t=e.clientX,a=e.clientY,r=n.getBoundingClientRect(),i={x:r.left+r.width/2,y:r.top+r.height/2},o=-(i.y-a),c=-(i.x-t),l=Math.atan2(o,c),m=s.current-l;m<-Math.PI?m=-s.current-l:m>Math.PI&&(m=s.current- -l),0!==m&&O(m),l===s.current||u(l)}},[O,u,n]),x=f.a.useCallback(function(e){var n=e.changedTouches[0];y(n)},[y]),A=f.a.useCallback(function(e){h.current&&y(e)},[y]),C=function(e){var n=f.a.useState(e),t=Object(v.a)(n,2),a=t[0],r=t[1],i=f.a.useRef(e);return f.a.useEffect(function(){i.current=e},[e]),f.a.useEffect(function(){var e=-1,n=function(){t(),r(i.current)},t=function(){e=requestAnimationFrame(n)};return t(),function(){cancelAnimationFrame(e)}},[]),a}(c),M=f.a.useMemo(function(){return r/2+Math.sin(C)*(r/4)+Math.sin(C)*r/16-r/6},[C,r]),N=f.a.useMemo(function(){return r/2+Math.cos(C)*(r/4)+Math.cos(C)*r/16-r/6},[C,r]);return f.a.useEffect(function(){return window.addEventListener("mouseup",j),window.addEventListener("mousemove",A),function(){window.removeEventListener("mouseup",j),window.removeEventListener("mousemove",A)}},[A,j]),f.a.createElement(jn,{className:"has-background-info",onMouseDown:l,onTouchMove:x,style:{top:M,left:N}})},yn=f.a.memo(ke.a.div(En())),xn=function(e){var n=e.size,t=void 0===n?300:n,a=e.addDiff,r=e.children,i=f.a.useState(null),o=Object(v.a)(i,2),c=o[0],u=o[1];return f.a.createElement(kn,{ref:u,className:"has-background-primary"},f.a.createElement(On,{addDiff:a,container:c,size:t}),f.a.createElement(yn,null,r))};function An(){var e=Object(p.a)(["\n  margin: 0 !important;\n  height: 100%;\n  width: 100%;\n  position: fixed;\n  z-index: 1;\n  left: 0;\n  top: 0;\n  background-color: rgba(0, 0, 0, 0.8);\n  color: white;\n  text-align: center;\n"]);return An=function(){return e},e}var Cn=ke.a.div(An()),Mn=function(){var e=pe(function(e){return e.metronomeState.bpm});return f.a.createElement("div",{className:"has-text-centered is-size-1"},e)},Nn=f.a.memo(function(){return f.a.createElement("section",{className:"section"},f.a.createElement(xn,{addDiff:ae},f.a.createElement(Mn,null),f.a.createElement(we,null)))}),In=f.a.memo(function(e){var n=e.showTuner,t=e.toggleTuner,a=pe(function(e){return e.metronomeState.playing}),r=pe(function(e){return e.metronomeState.pending});return f.a.createElement("section",{className:"section"},f.a.createElement(Be,{hasAddons:!0},f.a.createElement(Ne,{isLink:!0,offIsOutlined:!0,offIsLink:!0,on:n,onClick:t},"Tuner"),f.a.createElement(rn,null),f.a.createElement(Ne,{on:a,offIsPrimary:!0,grow:!0,isOutlined:!0,isDanger:!0,disabled:r,onClick:ce},f.a.createElement(f.a.Fragment,null,"Stop"),f.a.createElement(f.a.Fragment,null,"Start"))))}),Fn=function(e){var n=e.audioContext,t=pe(function(e){return e.metronomeState.pending});Y(n);var r=L(a.ShowTuner,!1),i=Object(v.a)(r,2),o=i[0],c=i[1];return f.a.createElement(f.a.Fragment,null,t&&f.a.createElement(Cn,null,"Tap to enable audio."),o&&f.a.createElement(bn,null),f.a.createElement(Nn,null),f.a.createElement(Xe,null),f.a.createElement(In,{showTuner:o,toggleTuner:c}))};function Bn(){var e=Object(p.a)([""]);return Bn=function(){return e},e}var Dn,Ln=ke.a.section(Bn()),Tn=function(){var e=pe(function(e){return e.settings.keepAwake});return f.a.createElement(Ln,null,f.a.createElement("h2",{className:"is-size-4"},"Settings"),f.a.createElement("div",{className:"field"},f.a.createElement("div",{className:"control"},f.a.createElement("label",{className:"checkbox"},f.a.createElement("input",{style:{marginRight:"5px"},type:"checkbox",checked:e,onChange:$}),"Keep screen on while metronome is running."))))},Pn=function(){return O.reduce(function(e,n){return function(e,n){return e.add({scaleKey:t=n,pitch:t[0],mode:t[1],known:!1,learning:!1,bpm:60});var t}(e,n)},h.Set())},_n=function(e,n){return e.filter(n)},zn=function(){var e=D(a.ScalesDB,Pn),n=Object(v.a)(e,2),t=n[0],r=n[1],i=f.a.useCallback(function(){throw new Error("not implemented")},[]),o=f.a.useCallback(function(e){return function(e,n){return _n(e,n).first()}(t,e)},[t]),c=f.a.useCallback(function(e){return _n(t,e).sort(function(e,n){return e.scaleKey[0].localeCompare(n.scaleKey[0])})},[t]);return{addBPM:f.a.useCallback(function(e,n){var a=t.get(e);a&&r(t.remove(a).add(Object(E.a)({},a,{bpm:a.bpm+n})))},[t,r]),toggleLearning:f.a.useCallback(function(e){var n=t.get(e);n&&r(t.remove(n).add(Object(E.a)({},n,{learning:!n.learning})))},[t,r]),toggleKnown:f.a.useCallback(function(e){var n=t.get(e);n&&r(t.remove(n).add(Object(E.a)({},n,{known:!n.known})))},[t,r]),addScale:i,getScale:o,getScales:c}};!function(e){e.NOT_STARTED="not-started",e.KNOWN="known",e.LEARNING="learning"}(Dn||(Dn={}));var Rn=function(e){var n=Object(v.a)(e.scaleKey,2),t=n[0],a=n[1],r=e.learning,i=e.known,o=e.toggleLearning,c=e.toggleKnown;return f.a.createElement("div",{className:"is-grouped field has-addons"},f.a.createElement("div",{className:"is-size-5 control is-expanded"},t," ",a),f.a.createElement(Be,null,f.a.createElement(Ne,{on:i,isInfo:!0,onClick:c},"Known"),f.a.createElement(Ne,{on:r,isLink:!0,onClick:o},"Learning")))},Kn=function(e){var n=e.scales,t=e.reset,a=e.scaleMode,r=n.getScales,i=n.getScale,o=n.addBPM,c=f.a.useState(function(){return function(e){var n,t,a;for(a=e.length-1;a>0;a--)n=Math.floor(Math.random()*(a+1)),t=e[a],e[a]=e[n],e[n]=t;return e}(r(function(e){return a===Dn.LEARNING?e.learning:a===Dn.KNOWN&&e.known}).valueSeq().map(function(e){return e.scaleKey}).toArray())}),u=Object(v.a)(c,2),s=u[0],l=u[1],m=ue(),d=s[0]||[],g=i(function(e){return e.mode===d[1]&&e.pitch===d[0]});f.a.useEffect(function(){void 0!==g&&ue(g.bpm)},[g,m]);var p=s.length>1?"Next Scale":"Finish";if(0===s.length)return f.a.createElement("div",null,"No more scales");var h=g,b=h,E=b.mode,S=b.pitch,w=b.bpm;return f.a.createElement(f.a.Fragment,null,f.a.createElement("div",{className:"box"},f.a.createElement("div",{style:{alignSelf:"center",fontWeight:"bold"},className:"control is-expanded is-size-5"},a),f.a.createElement("div",{style:{display:"flex",marginBottom:"5px"}},f.a.createElement("div",{style:{alignSelf:"center",marginRight:"10px"}},S," ",E," @ ",w,"bpm"),f.a.createElement(Be,{grow:!0,hasAddons:!0},f.a.createElement(Ie,{isDanger:!0,isOutlined:!0,grow:!0,onClick:function(){return o(h,-10)}},"-10"),f.a.createElement(Ie,{isDanger:!0,isOutlined:!0,grow:!0,onClick:function(){return o(h,-1)}},"-"),f.a.createElement(Ie,{isPrimary:!0,isOutlined:!0,grow:!0,onClick:function(){return o(h,1)}},"+"),f.a.createElement(Ie,{isPrimary:!0,isOutlined:!0,grow:!0,onClick:function(){return o(h,10)}},"+10"))),f.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},f.a.createElement(Ie,{isDanger:!0,isOutlined:!0,onClick:t},"Stop"),f.a.createElement(Ie,{isPrimary:!0,onClick:function(){l(function(e){var n=e.slice(1);return 0===n.length&&t(),n})}},p))),f.a.createElement(Xe,null))},Gn=function(e){var n=e.audioContext;Y(n);var t=f.a.useState(Dn.NOT_STARTED),i=Object(v.a)(t,2),o=i[0],c=i[1],u=L(a.ShowKnown,!1),s=Object(v.a)(u,2),l=s[0],m=s[1];f.a.useEffect(function(){o===Dn.NOT_STARTED&&se()},[o]);var d=zn(),g=d.getScale,p=d.getScales,h=d.toggleLearning,b=d.toggleKnown;return f.a.createElement("div",{style:{marginTop:"10px"}},o===Dn.NOT_STARTED?f.a.createElement("div",{style:{marginBottom:"5px"}},f.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},f.a.createElement("div",{style:{alignSelf:"center",fontWeight:"bold"},className:"control is-expanded is-size-5"},"Scales"),f.a.createElement(Be,null,f.a.createElement(Ie,{onClick:function(){return c(Dn.KNOWN)},disabled:void 0===g(function(e){return e.known}),className:"is-info is-outlined"},"Start Known"),f.a.createElement(Ie,{onClick:function(){return c(Dn.LEARNING)},disabled:void 0===g(function(e){return e.learning}),className:"is-link is-outlined"},"Start Learning"))),f.a.createElement("hr",null),f.a.createElement(Be,null,f.a.createElement(Ie,{onClick:m,className:"".concat(l?"is-primary is-outlined":"is-danger")},l?"Hide Known":"Show Known")),p(function(e){return e.mode===r.Major&&(!!l||!1===e.known)}).map(function(e){return f.a.createElement(Rn,Object.assign({key:"".concat(e.pitch,"-").concat(e.mode)},e,{toggleLearning:function(){return h(e)},toggleKnown:function(){return b(e)}}))}),f.a.createElement("hr",null),p(function(e){return e.mode===r.Minor&&(!!l||!1===e.known)}).map(function(e){return f.a.createElement(Rn,Object.assign({key:"".concat(e.pitch,"-").concat(e.mode)},e,{toggleLearning:function(){return h(e)},toggleKnown:function(){return b(e)}}))})):f.a.createElement(Kn,{scaleMode:o,scales:d,reset:function(){return c(Dn.NOT_STARTED)}}))},Wn=t(29),qn=t(20),Un=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Jn(e){if("serviceWorker"in navigator){if(new URL("/metronome",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var n="".concat("/metronome","/service-worker.js");Un?(!function(e,n){fetch(e).then(function(t){var a=t.headers.get("content-type");404===t.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):Hn(e,n)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(n,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):Hn(n,e)})}}function Hn(e,n){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;null!=t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),n&&n.onUpdate&&n.onUpdate(e)):(console.log("Content is cached for offline use."),n&&n.onSuccess&&n.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}function Vn(){var e=Object(p.a)(["\n  position: absolute;\n  max-width: ",";\n  width: 95%;\n  margin-top: 10px;\n  left: 0;\n  right: 0;\n  margin-left: auto !important;\n  margin-right: auto !important;\n  z-index: 10;\n  display: flex !important;\n  justify-content: space-between;\n  animation: ease-in 1s ",";\n"]);return Vn=function(){return e},e}function Yn(){var e=Object(p.a)(["\n    from {\n      opacity: 0;\n    }\n    to {\n      opacity: 1;\n    }\n"]);return Yn=function(){return e},e}var Xn=Object(ke.b)(Yn()),$n=ke.a.section(Vn(),"40em",Xn),Qn=!1,Zn=function(){var e=f.a.useState(!1),n=Object(v.a)(e,2),t=n[0],a=n[1],r=f.a.useCallback(function(){window.location.reload()},[]),i=f.a.useCallback(function(){a(!1)},[]);return f.a.useEffect(function(){Qn||Jn({onUpdate:function(){a(!0)}}),Qn=!0},[]),f.a.createElement(f.a.Fragment,null,t&&f.a.createElement($n,{className:"box"},f.a.createElement("span",null,"An Update is Available!"),f.a.createElement(Be,null,f.a.createElement(Ie,{isPrimary:!0,isOutlined:!0,onClick:r},"Refresh"),f.a.createElement(Ie,{isDanger:!0,isOutlined:!0,onClick:i},"x"))))},et=t(37),nt=t(26);function tt(){var e=Object(p.a)(["\n  display: flex;\n  flex-direction: column;\n  align-items: flex-end;\n  justify-content: flex-end;\n  margin-top: 5px;\n"]);return tt=function(){return e},e}function at(){var e=Object(p.a)(["\n  max-width: ",";\n  margin: 0 auto;\n  display: flex;\n  flex-direction: column;\n  > * {\n    margin-left: 10px;\n    margin-right: 10px;\n  }\n"]);return at=function(){return e},e}function rt(){var e=Object(p.a)(["\n  margin-left: 5px;\n"]);return rt=function(){return e},e}function it(){var e=Object(p.a)([""]);return it=function(){return e},e}function ot(){var e=Object(p.a)(["\n  display: flex;\n  position: absolute;\n  z-index: 2;\n  width: 100%;\n  flex-direction: column;\n  align-items: flex-end;\n  padding-right: 10px;\n  align-self: flex-end;\n  opacity: 0.9;\n  > a {\n    animation: ease-in 0.1s ",";\n    font-size: 1.5rem;\n    margin: 10px;\n  }\n"]);return ot=function(){return e},e}function ct(){var e=Object(p.a)(["\n  from {\nfont-size: 0px;\n  }\nto {\nmargin: 10px;\n}\n"]);return ct=function(){return e},e}function ut(){var e=Object(p.a)(["\n  display: flex;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  padding-left: 10px;\n  padding-right: 10px;\n  justify-content: space-between;\n  > h2 {\n    margin: 0 !important;\n  }\n"]);return ut=function(){return e},e}function st(){var e=Object(p.a)(["\n  align-self: center;\n"]);return st=function(){return e},e}function lt(){var e=Object(p.a)(["\n  margin-bottom: 10px;\n  margin-left: 0px !important;\n  margin-right: 0px !important;\n  position: relative;\n  display: inline-block;\n  flex-direction: column;\n"]);return lt=function(){return e},e}var mt=f.a.memo(ke.a.section(lt())),ft=f.a.memo(ke.a.span(st())),dt=f.a.memo(ke.a.section(ut())),gt=Object(ke.b)(ct()),vt=f.a.memo(ke.a.nav(ot(),gt)),pt=f.a.memo(Object(ke.a)(Wn.b)(it())),ht=f.a.memo(Object(ke.a)(et.a)(rt())),bt=function(e){var n=e.toggleNav;return f.a.useEffect(function(){return window.addEventListener("click",n),function(){window.removeEventListener("click",n)}},[]),f.a.createElement(vt,{className:"has-background-white"},f.a.createElement(pt,{to:"/"},"Home",f.a.createElement(ht,{icon:nt.d})),f.a.createElement(pt,{to:"/scales"},"Scales",f.a.createElement(ht,{icon:nt.e})),f.a.createElement(pt,{to:"/settings"},"Settings",f.a.createElement(ht,{icon:nt.c})))},Et=f.a.memo(function(){var e=T(!1),n=Object(v.a)(e,2),t=n[0],a=n[1],r=pe(function(e){return e.settings.keepAwake&&e.metronomeState.playing});return f.a.createElement(mt,null,f.a.createElement(dt,{className:"has-background-primary has-text-light"},f.a.createElement(Wn.b,{to:"/",className:"has-text-white"},f.a.createElement("h2",{className:"is-size-4 is-bold"},"(mjh)tronome")),r&&f.a.createElement(Wn.b,{to:"/settings"},f.a.createElement(ft,{className:"has-text-info",onClick:a},f.a.createElement(et.a,{icon:nt.b,size:"2x"}))),f.a.createElement(ft,{onClick:a},f.a.createElement(et.a,{icon:nt.a,size:"2x"}))),t&&f.a.createElement(bt,{toggleNav:a}))}),St=f.a.memo(ke.a.div(at(),"40em")),wt=f.a.memo(ke.a.div(tt())),kt=f.a.memo(function(e){var n=e.children;return f.a.createElement(St,null,f.a.createElement(Zn,null),f.a.createElement(Et,null),n,f.a.createElement(wt,null,"v".concat("1.0.28")))}),jt=function(){var e=function(){var e=f.a.useState(),n=Object(v.a)(e,2),t=n[0],a=n[1],r=f.a.useRef(),i=f.a.useState(!1),o=Object(v.a)(i,2),c=o[0],u=o[1],s=f.a.useCallback(function(){c||void 0!==r.current&&(a("pending"),r.current.resume().then(function(){u(!0),a(r.current),document.removeEventListener("touchstart",s),document.removeEventListener("click",s),document.removeEventListener("touchend",s)}))},[c,u]);return f.a.useEffect(function(){if(void 0===N)a("not-supported");else{var e=new N;r.current=e,"suspended"===e.state?(document.addEventListener("touchstart",s),document.addEventListener("click",s),document.addEventListener("touchend",s)):a(e)}},[s]),t}(),n=pe(function(e){return e.settings.keepAwake}),t=pe(function(e){return e.metronomeState.playing});return function(e){var n=f.a.useState(new B.a),t=Object(v.a)(n,1)[0];f.a.useEffect(function(){e?t.enable():t.disable()},[e,t])}(n&&t),f.a.createElement(Wn.a,{basename:"/metronome"},f.a.createElement(kt,null,"not-supported"===e&&f.a.createElement("div",null,"Your browser doesn't support the audioContext api, so this will not work. Sorry :("),f.a.createElement(qn.a,{exact:!0,path:"/",render:function(){return f.a.createElement(Fn,{audioContext:e})}}),f.a.createElement(qn.a,{exact:!0,path:"/scales",render:function(){return f.a.createElement(Gn,{audioContext:e})}}),f.a.createElement(qn.a,{exact:!0,path:"/settings",render:function(){return f.a.createElement(Tn,null)}})))},Ot=(t(88),function(e){function n(e){var t;return Object(o.a)(this,n),(t=Object(u.a)(this,Object(s.a)(n).call(this,e))).state={error:void 0},t}return Object(l.a)(n,e),Object(c.a)(n,[{key:"render",value:function(){return this.state.error?f.a.createElement("div",null,f.a.createElement("h1",null,"Something went wrong"),f.a.createElement("hr",null),f.a.createElement("code",null,this.state.error instanceof Error&&this.state.error.name),f.a.createElement("hr",null),f.a.createElement("code",null,this.state.error instanceof Error&&this.state.error.message),f.a.createElement("hr",null),f.a.createElement("code",null,this.state.error instanceof Error&&this.state.error.stack),f.a.createElement("hr",null),f.a.createElement("code",null,JSON.stringify(this.state.error,void 0,"  "))):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{error:e}}}]),n}(f.a.Component));g.a.render(f.a.createElement(y.a,{store:ve},f.a.createElement(Ot,null,f.a.createElement(jt,null))),document.getElementById("root"))}},[[65,1,2]]]);
//# sourceMappingURL=main.c039920c.chunk.js.map