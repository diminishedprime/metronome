(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{29:function(e,n,t){e.exports=t(42)},35:function(e,n,t){e.exports=t.p+"static/media/click.b48ed3e5.wav"},41:function(e,n,t){},42:function(e,n,t){"use strict";t.r(n);for(var a=t(0),r=t.n(a),c=t(12),o=t.n(c),i=t(1),u=t(26),s=t(50),l=t(47),f=t(48),m=t(23),d=t(46),v=t(45),b=[{name:"Larghissimo",range:[0,24]},{name:"Grave",range:[25,45]},{name:"Largo",range:[40,60]},{name:"Lento",range:[45,60]},{name:"Larghetto",range:[60,66]},{name:"Adagio",range:[66,76]},{name:"Andante",range:[76,108]},{name:"Marcia moderato",range:[83,85]},{name:"Andante moderato",range:[92,112]},{name:"Moderato",range:[108,120]},{name:"Allegro",range:[120,156]},{name:"Vivace",range:[156,176]},{name:"Vivacissimo",range:[172,176]},{name:"Allegrissimo",range:[172,176]},{name:"Presto",range:[168,200]},{name:"Prestissimo",range:[200,250]}],g=function(e){return b.filter(function(n){return function(e,n){var t=Object(i.a)(e,2),a=t[0],r=t[1];return n>=a&&n<=r}(n.range,e)})},h=function(e){var n=e.bpm,t=g(n);return r.a.createElement("div",{style:{minHeight:"6.5em"}},t.map(function(e,n){var t=e.name,a=e.range;return r.a.createElement("div",{key:n,className:"has-text-centered"},t," - ",a[0]," - ",a[1])}))},j=t(51),p=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Object(a.useState)(function(){var a,r=localStorage.getItem(e);return a=null===r||void 0===r||t?n instanceof Function?n():n:JSON.parse(r),window.localStorage.setItem(e,JSON.stringify(a)),a}),c=Object(i.a)(r,2),o=c[0],u=c[1];return[o,function(n){u(function(t){var a=n instanceof Function?n(t):n;return window.localStorage.setItem(e,JSON.stringify(a)),a})}]},O=function(e){var n=Object(a.useState)(e),t=Object(i.a)(n,2),r=t[0],c=t[1];return[r,function(){return c(function(e){return!e})}]},E=t(11),M=function(e){var n=e.classes,t=void 0===n?[]:n,a=e.children,c=Object(E.a)(e,["classes","children"]),o="button ".concat(t.join(" ")),i=Object.assign(c,{className:o});return r.a.createElement("button",i,a)},w=function(e){var n=e.classes,t=void 0===n?[]:n,a=e.children,c=Object(E.a)(e,["classes","children"]),o="buttons has-addons ".concat(t.join(" ")),i=Object.assign(c,{className:o});return r.a.createElement("div",i,a)},y=function(e){var n=e.setSignature,t=e.signature.numerator,a=e.currentBeat,c=O(!1),o=Object(i.a)(c,2),u=o[0],s=o[1],l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;return function(){n({numerator:e,denominator:t}),s()}};return r.a.createElement(r.a.Fragment,null,r.a.createElement("section",{style:{marginTop:"10px"},className:"section is-mobile columns",onClick:s},j.a(0,t).map(function(e){var n=e+1===a?"has-background-primary":"has-background-light";return r.a.createElement("div",{className:"column margin-sm has-text-centered ".concat(n),key:e},e+1)})),u&&r.a.createElement("section",{className:"section buttons is-centered"},r.a.createElement(M,{onClick:l(2)},"2/4"),r.a.createElement(M,{onClick:l(3)},"3/4"),r.a.createElement(M,{onClick:l(4)},"4/4"),r.a.createElement(M,{onClick:l(5)},"5/4")))},S=t(35),k=function(e,n){var t=n.time,a=n.gain,r=n.buffer,c=n.pitch,o=e.createBufferSource();o.buffer=r,o.detune.value=-c;var i=e.createGain();i.gain.value=a,o.connect(i),i.connect(e.destination),o.start(t)},x=function(e,n,t,a){var r=t.divisions,c=t.on,o=t.pitch,i=t.gain;if(c){var u=n/r;return j.a(1,r).map(function(n){return{time:e+n*u,pitch:o,gain:.5*i,buffer:a}})}return[]},C=function(e,n,t,r){var c=n.scheduleAhead,o=function(e){var n=Object(a.useState)(),t=Object(i.a)(n,2),r=t[0],c=t[1];return Object(a.useEffect)(function(){var n=new AudioContext;fetch(e).then(function(e){return e.arrayBuffer()}).then(function(e){return n.decodeAudioData(e)}).then(c)},[e]),r}(S),u=Object(a.useRef)(0),s=function(e){var n=Object(a.useRef)(e);return Object(a.useEffect)(function(){n.current=e},[e]),n}(n),l=e?1e3*c/2:void 0;Object(a.useEffect)(function(){if(void 0!==l){var e=r.currentTime+.1;u.current=e;var n=setInterval(function(){!function(e,n,t,a,r){for(var c=n.current,o=c.bpm,i=c.subDivisions,u=c.scheduleAhead,s=60/o,l=function(e){k(r,e)};e.current<r.currentTime+u;){k(r,{time:e.current,pitch:0,gain:.5,buffer:t}),a(e.current);var f=!0,m=!1,d=void 0;try{for(var v,b=i[Symbol.iterator]();!(f=(v=b.next()).done);f=!0){var g=v.value;x(e.current,s,g,t).forEach(l)}}catch(h){m=!0,d=h}finally{try{f||null==b.return||b.return()}finally{if(m)throw d}}e.current+=s}}(u,s,o,t,r)},l);return function(){clearInterval(n)}}},[l,o,s,t,r])},A=function(e,n,t,r,c){var o=function(e){var n=Object(a.useRef)(e);return Object(a.useLayoutEffect)(function(){n.current=e},[e]),n}(t);Object(a.useLayoutEffect)(function(){var t,a=!0,i=function(){u();var e=n.currentTime,t=o.current;(void 0!==t&&e<=t||a)&&(r(void 0),c(),a=!1)},u=function(){t=requestAnimationFrame(i)};if(e)return u(),function(){cancelAnimationFrame(t)}},[e,n,c,o,r])},F=t(49),N=t(27),B=t(52),D=t(43),L=t(44),G=f.a(function(e){return F.a(2,e)},N.a(function(e){var n=Object(i.a)(e,2),t=n[0];return n[1]-t}),B.a,D.a(6e4),Math.trunc),_=function(e){var n=e.setBPM,t=Object(a.useState)([]),c=Object(i.a)(t,2),o=c[0],u=c[1];return r.a.createElement(M,{onClick:function(){var e=performance.now(),t=L.a(e,o).filter(function(n){return e-n<3e3});if(t.length>1){var a=G(t);n(a)}u(t)}},"Tap In")},P=function(e){var n=e.subDivisions,t=e.toggle;return r.a.createElement(r.a.Fragment,null,n.map(function(e,n){var a=e.label,c=e.on;return r.a.createElement(M,{classes:[c?"is-primary":""],key:n,onClick:function(){return t(n)}},a)}))},R={0:"A",1:"Bb",2:"B",3:"C",4:"Db",5:"D",6:"Eb",7:"E",8:"F",9:"Gb",10:"G",11:"Ab"},T=[],I=-4;I<4;I++)for(var q=0;q<12;q++){var W=440*Math.pow(2,I),z=W/1200,U=W*Math.pow(2,q/12),J=I+4,V=R[q];T.push({octave:J,note:V,frequency:U,centsPerOctave:z})}var H=function(){var e=Object(a.useState)(),n=Object(i.a)(e,2),t=n[0],c=n[1],o=Object(a.useState)(),u=Object(i.a)(o,2)[1],s=Object(a.useState)(),l=Object(i.a)(s,2),f=l[0],m=l[1],d=Object(a.useState)(440),v=Object(i.a)(d,2),b=v[0],g=v[1];Object(a.useRef)(null);Object(a.useEffect)(function(){var e=new AudioContext;m(e.sampleRate);var n=navigator.mediaDevices;return n&&n.getUserMedia({audio:!0}).then(function(n){var t=e.createAnalyser();t.fftSize=8192,e.createMediaStreamSource(n).connect(t),c(t)}),function(){e.close()}},[]),Object(a.useLayoutEffect)(function(){var e,n=function(){var e=t.frequencyBinCount,n=new Float32Array(e);t.getFloatFrequencyData(n),u(n);var r=n.reduce(function(e,n,t){return e[0]<n?[n,t]:e},[-1/0,-1]),c=Object(i.a)(r,2)[1],o=f/t.fftSize;g(o*c),a()},a=function(){e=requestAnimationFrame(n)};if(void 0!==t)return a(),function(){cancelAnimationFrame(e)}},[t,f]);var h=function(e){for(var n=0,t=0;t<T.length;t++)if(T[t].frequency>=e){n=t;break}var a=n+1,r=T[n],c=T[a],o=(r.frequency+c.frequency)/2,i=T[a],u=i.frequency-e;e<o&&(i=T[n]);var s=i.centsPerOctave*u;return Object.assign(i,{originalFrequency:e,difference:u,cents:s})}(b||0),j=h.octave,p=h.note,O=h.cents;return r.a.createElement("div",{className:"box"},r.a.createElement("div",{className:"has-text-centered"},r.a.createElement("div",{className:"is-size-1"},p+j),r.a.createElement("div",null,O.toFixed(2)," Cents ",O<0?"flat":"sharp")),!1)},X=t(17),Y=t(18);function $(){var e=Object(X.a)(["\n  align-self: center;\n  margin: auto;\n  z-index: 1;\n  pointer-events: none;\n"]);return $=function(){return e},e}function K(){var e=Object(X.a)(["\n  width: 100px;\n  height: 100px;\n  border-radius: 100px;\n  position: absolute;\n"]);return K=function(){return e},e}function Q(){var e=Object(X.a)(["\n  margin: auto;\n  position: relative;\n  height: 300px;\n  width: 300px;\n  border-radius: 300px;\n  display: flex;\n  margin-bottom: 10px;\n"]);return Q=function(){return e},e}var Z,ee,ne=Y.a.div(Q()),te=Y.a.div(K()),ae=Y.a.div($()),re=function(e){var n=e.size,t=void 0===n?300:n,c=e.addDiff,o=e.children,u=Object(a.useState)(3*Math.PI/2),s=Object(i.a)(u,2),l=s[0],f=s[1],m=Object(a.useRef)(Math.PI);Object(a.useEffect)(function(){m.current=l},[l]);var d=Object(a.useState)(!1),v=Object(i.a)(d,2),b=v[0],g=v[1],h=Object(a.useRef)(!1);Object(a.useEffect)(function(){h.current=b},[b]);var j=Object(a.useState)(0),p=Object(i.a)(j,2),O=p[0],E=p[1],M=Object(a.useRef)(0);Object(a.useEffect)(function(){M.current=O},[O]);var w=Object(a.useRef)(null),y=Object(a.useCallback)(function(e){g(!1)},[]),S=Object(a.useCallback)(function(e){Math.abs(M.current)<.2?E(function(n){return n+e}):(c(M.current>0?-1:1),E(0))},[c]),k=Object(a.useCallback)(function(e){var n=e.clientX,t=e.clientY,a=w.current.getBoundingClientRect(),r=a.left+a.width/2,c=-(a.top+a.height/2-t),o=-(r-n),i=Math.atan2(c,o),u=m.current-i;u<-Math.PI?u=-m.current-i:u>Math.PI&&(u=m.current- -i),0!==u&&S(u),i===m.current||f(i)},[S]),x=Object(a.useCallback)(function(e){h.current&&k(e)},[k]);Object(a.useEffect)(function(){return window.addEventListener("mouseup",y),window.addEventListener("mousemove",x),function(){window.removeEventListener("mouseup",y),window.removeEventListener("mousemove",x)}},[x,y]);var C=t/2+Math.sin(l)*(t/4)+Math.sin(l)*t/16-t/6,A=t/2+Math.cos(l)*(t/4)+Math.cos(l)*t/16-t/6;return r.a.createElement(ne,{ref:w,className:"has-background-primary"},r.a.createElement(te,{className:"has-background-info",onMouseDown:function(e){g(!0),e.preventDefault()},onTouchMove:function(e){var n=e.changedTouches[0];k(n)},style:{top:C,left:A}}),r.a.createElement(ae,null,o))};!function(e){e.Major="Major",e.Minor="Minor"}(Z||(Z={})),function(e){e.A="A",e.B_Flat="Bb",e.B="B",e.C="C",e.D_Flat="Db",e.D="D",e.E_Flat="Eb",e.E="E",e.F="F",e.G_Flat="Gb",e.G="G",e.A_Flat="Ab"}(ee||(ee={}));var ce=function(e,n){var t=[];return Object.entries(e).forEach(function(e){var a=Object(i.a)(e,2)[1];Object.entries(a).forEach(function(e){var a=Object(i.a)(e,2)[1];n(a)&&t.push(a)})}),t},oe=function(e,n){return ce(e,function(e){return e.mode===n})},ie=function(){var e={},n=function(n,t){var a=e[n];void 0===a&&(a={},e[n]=a),a[t]=function(e,n){return{pitch:e,mode:n,known:!1,learning:!1,bpm:60}}(n,t)};return n(ee.A,Z.Major),n(ee.B_Flat,Z.Major),n(ee.B,Z.Major),n(ee.C,Z.Major),n(ee.D_Flat,Z.Major),n(ee.D,Z.Major),n(ee.E_Flat,Z.Major),n(ee.E,Z.Major),n(ee.F,Z.Major),n(ee.G_Flat,Z.Major),n(ee.G,Z.Major),n(ee.A_Flat,Z.Major),n(ee.A,Z.Minor),n(ee.B_Flat,Z.Minor),n(ee.B,Z.Minor),n(ee.C,Z.Minor),n(ee.D_Flat,Z.Minor),n(ee.D,Z.Minor),n(ee.E_Flat,Z.Minor),n(ee.E,Z.Minor),n(ee.F,Z.Minor),n(ee.G_Flat,Z.Minor),n(ee.G,Z.Minor),n(ee.A_Flat,Z.Minor),e},ue=function(e){var n=e.title,t=e.children,a=O(!1),c=Object(i.a)(a,2),o=c[0],u=c[1];return r.a.createElement("div",null,r.a.createElement("div",{className:"is-grouped field has-addons"},r.a.createElement("div",{style:{alignSelf:"center",fontWeight:"bold"},className:"control is-expanded is-size-5"},n),r.a.createElement(M,{onClick:u},o?"-":"+")),o&&t)},se=function(e){var n=e.pitch,t=e.mode,a=e.learning,c=e.toggleLearning;return r.a.createElement("div",{className:"is-grouped field has-addons"},r.a.createElement("div",{className:"is-size-5 control is-expanded"},n),r.a.createElement(M,{onClick:c(n,t)},a?"Stop Learning":"Start Learning"))};var le=function(e){var n=e.filter,t=e.scalesDB,c=e.addBPM,o=e.startMetronome,u=e.stopMetronome,s=Object(a.useState)(function(){return function(e){var n,t,a;for(a=e.length-1;a>0;a--)n=Math.floor(Math.random()*(a+1)),t=e[a],e[a]=e[n],e[n]=t;return e}(ce(t,n).map(function(e){return[e.mode,e.pitch]}))}),l=Object(i.a)(s,2),f=l[0],m=l[1],d=f[0]||[],v=function(e,n){return ce(e,n)[0]}(t,function(e){return e.mode===d[0]&&e.pitch===d[1]});Object(a.useEffect)(function(){void 0!==v&&o(v.bpm)},[v]);var b=f.length>1?"Next":"Last One";if(0===f.length)return r.a.createElement("div",null,"No more scales");var g=v,h=g,j=h.mode,p=h.pitch,O=h.bpm;return r.a.createElement("div",{className:""},r.a.createElement("div",null,p," ",j," @ ",O),r.a.createElement(M,{style:{flexGrow:1},onClick:c(g,-1)},"-"),r.a.createElement(M,{style:{flexGrow:1},onClick:c(g,1)},"+"),r.a.createElement(M,{classes:["is-right"],onClick:function(){m(function(e){var n=e.slice(1);return 0===n.length&&u(),n})}},b))},fe=function(e){var n=e.startMetronome,t=e.stopMetronome,a=(Object(E.a)(e,["startMetronome","stopMetronome"]),p("@mjh/metronome/scales-db",ie)),c=Object(i.a)(a,2),o=c[0],s=c[1],f=O(!1),d=Object(i.a)(f,2),b=d[0],g=d[1],h=oe(o,Z.Major),j=oe(o,Z.Minor),w=[["Major scales (To Learn)",h.filter(function(e){return!e.learning})],["Minor scales (To Learn)",j.filter(function(e){return!e.learning})],["Major scales (Learning)",h.filter(function(e){return e.learning})],["Minor scales (Learning)",j.filter(function(e){return e.learning})]],y=function(e,n){return function(){s(u.a(l.a([e,n,"learning"]),v.a))}};return r.a.createElement("div",{className:"box"},r.a.createElement(M,{onClick:function(){b&&t(),g()}},b?"Stop":"Start Learning"),!b&&w.map(function(e){var n=Object(i.a)(e,2),t=n[0],a=n[1];return r.a.createElement(ue,{title:r.a.createElement("div",null,t)},a.map(function(e){return r.a.createElement(se,Object.assign({key:"".concat(t,"-").concat(e.pitch,"-").concat(e.mode)},e,{toggleLearning:y}))}))}),b&&r.a.createElement(le,{startMetronome:n,stopMetronome:t,addBPM:function(e,n){var t=e.pitch,a=e.mode;return function(){s(u.a(l.a([t,a,"bpm"]),m.a(n)))}},filter:function(e){return e.learning},scalesDB:o}))},me=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function de(e){if("serviceWorker"in navigator){if(new URL("/metronome",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var n="".concat("/metronome","/service-worker.js");me?(!function(e,n){fetch(e).then(function(t){var a=t.headers.get("content-type");404===t.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):ve(e,n)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(n,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):ve(n,e)})}}function ve(e,n){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;null!=t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),n&&n.onUpdate&&n.onUpdate(e)):(console.log("Content is cached for offline use."),n&&n.onSuccess&&n.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}var be=l.a(["schedulerState","bpm"]),ge=l.a(["schedulerState","signature"]),he=function(){return{schedulerState:{scheduleAhead:.2,bpm:120,signature:{numerator:4,denominator:4},subDivisions:[{on:!1,pitch:10,divisions:2,label:"2",gain:1},{on:!1,pitch:20,divisions:3,label:"3",gain:1},{on:!1,pitch:30,divisions:4,label:"4",gain:1},{on:!1,pitch:40,divisions:5,label:"5",gain:1}]}}},je=function(){var e=Object(a.useState)(!1),n=Object(i.a)(e,2),t=n[0],c=n[1],o=Object(a.useState)(function(){return new AudioContext}),b=Object(i.a)(o,2),g=b[0],j=b[1];Object(a.useEffect)(function(){t&&j(new AudioContext)},[t]);var E=p("@mjh/metronome/schedulerState",he),S=Object(i.a)(E,2),k=S[0],x=k.schedulerState,F=k.schedulerState,N=F.bpm,B=F.subDivisions,D=F.signature,L=S[1],G=function(e){return L(Object(s.a)(be,d.a(1,250,e)))},R=function(e,n,t){var r=Object(a.useState)(),c=Object(i.a)(r,2),o=c[0],u=c[1],s=Object(a.useState)(0),l=Object(i.a)(s,2),f=l[0],m=l[1],d=n.signature.numerator,v=Object(a.useCallback)(function(){return m(function(e){var n=e+1;return e>=d&&(n=1),n})},[d]);return C(e,n,u,t),A(e,t,o,u,v),[f,m]}(t,x,g),T=Object(i.a)(R,2),I=T[0],q=T[1],W=O(!1),z=Object(i.a)(W,2),U=z[0],J=z[1],V=O(!1),X=Object(i.a)(V,2),Y=X[0],$=X[1],K=Object(a.useState)(!1),Q=Object(i.a)(K,2),Z=Q[0],ee=Q[1];return Object(a.useEffect)(function(){de({onUpdate:function(){ee(!0)}})}),r.a.createElement("div",{style:{maxWidth:"500px",margin:"0 auto",padding:"10px"}},Z&&r.a.createElement("section",{className:"box is-grouped field has-addons",style:{marginBottom:"10px"}},r.a.createElement("p",{style:{alignSelf:"center"},className:"control is-expanded"},"An Update is Available!"),r.a.createElement(M,{onClick:function(){return window.location.reload()}},"Refresh")),r.a.createElement(y,{setSignature:function(e){L(Object(s.a)(ge,e))},signature:D,currentBeat:I}),r.a.createElement("section",{className:"section"},r.a.createElement(re,{addDiff:function(e){return L(Object(u.a)(be,f.a(m.a(e),d.a(1,250))))}},r.a.createElement("div",{className:"has-text-centered is-size-1"},N),r.a.createElement(h,{bpm:N}))),r.a.createElement("section",{className:"section"},r.a.createElement(w,null,r.a.createElement(P,{subDivisions:B,toggle:function(e){var n;L(Object(u.a)((n=e,l.a(["schedulerState","subDivisions",n,"on"])),v.a))}}),r.a.createElement(_,{setBPM:G}),r.a.createElement(M,{style:{flexGrow:1},classes:["is-outlined",t?"is-danger":"is-primary"],onClick:function(){t&&q(0),c(v.a)}},t?"Stop":"Start"))),U&&r.a.createElement(fe,{startMetronome:function(e){G(e),c(!0)},stopMetronome:function(){c(!1)}}),Y&&r.a.createElement(H,null),r.a.createElement("nav",{className:"navbar is-fixed-bottom buttons is-right",style:{padding:"10px",margin:"0 auto",maxWidth:"500px"}},r.a.createElement(M,{classes:[U?"is-primary":""],onClick:J},"Scales"),r.a.createElement(M,{classes:[Y?"is-primary":""],onClick:$},"Tuner"),r.a.createElement("div",null,"v".concat("22.3.0"))))},pe=function(){return r.a.createElement(je,null)};t(41);o.a.render(r.a.createElement(pe,null),document.getElementById("root"))}},[[29,1,2]]]);
//# sourceMappingURL=main.fc53699d.chunk.js.map