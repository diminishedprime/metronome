(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{65:function(e,n,t){e.exports=t(89)},80:function(e,n,t){e.exports=t.p+"static/media/click.b48ed3e5.wav"},88:function(e,n,t){},89:function(e,n,t){"use strict";t.r(n);var a,r=t(51),i=t(52),o=t(62),c=t(53),u=t(64),s=t(0),l=t.n(s),f=t(22),m=t.n(f),d=t(1),v=t(3),g=t(8),h=t(91),p=t(10),b=t(31);!function(e){e[e.SetScales=0]="SetScales",e[e.SetActiveBeats=1]="SetActiveBeats",e[e.SetMetronomeState=2]="SetMetronomeState",e[e.SetSettings=3]="SetSettings"}(a||(a={}));var E,w,S,k={isActive:!1,isAccented:!1},j=g.List(),O=g.Map();g.List();!function(e){e.EnabledDivisions="@mjh/k/enabled-divisions-0",e.AppSettings="@mjh/k/app-settings-0",e.SignatureDivisions="@mjh/k/signature-divisions-3",e.ShowKnown="@mjh/k/show-known-2",e.ScalesDB="@mjh/k/scales-db-3",e.ActiveBeats="@mjh/k/active-beats-2",e.TimeSignature="@mjh/k/signature-3",e.BPM="@mjh/k/bpm-0",e.KnownScales="@mjh/k/known-scales-0",e.ShowScales="@mjh/k/show-scales-0",e.ShowTuner="@mjh/k/show-tuner-0",e.ShowDial="@mjh/k/show-dial-0",e.Radians="@mjh/k/radians-0",e.WakeLock="@mjh/k/wake-lock-0"}(E||(E={})),function(e){e.Major="Major",e.Minor="Minor"}(w||(w={})),function(e){e.A="A",e.B="B",e.C="C",e.D="D",e.E="E",e.F="F",e.G="G",e.A_Flat="Ab",e.B_Flat="Bb",e.C_Flat="Cb",e.D_Flat="Db",e.E_Flat="Eb",e.F_Flat="Fb",e.G_Flat="Gb",e.A_Sharp="A#",e.B_Sharp="B#",e.C_Sharp="C#",e.D_Sharp="D#",e.E_Sharp="E#",e.F_Sharp="F#",e.G_Sharp="G#"}(S||(S={}));var x=[[S.A,w.Major],[S.B,w.Major],[S.C,w.Major],[S.D,w.Major],[S.E,w.Major],[S.F,w.Major],[S.G,w.Major],[S.A_Flat,w.Major],[S.B_Flat,w.Major],[S.C_Flat,w.Major],[S.D_Flat,w.Major],[S.E_Flat,w.Major],[S.G_Flat,w.Major],[S.C_Sharp,w.Major],[S.F_Sharp,w.Major],[S.A,w.Minor],[S.B,w.Minor],[S.C,w.Minor],[S.D,w.Minor],[S.E,w.Minor],[S.F,w.Minor],[S.G,w.Minor],[S.A_Flat,w.Minor],[S.B_Flat,w.Minor],[S.E_Flat,w.Minor],[S.A_Sharp,w.Minor],[S.C_Sharp,w.Minor],[S.D_Sharp,w.Minor],[S.F_Sharp,w.Minor],[S.G_Sharp,w.Minor]],y=t(34),M=t(100),A=t(90),C=t(21);var N=function(e,n){var t=localStorage.getItem(e);return null===t?n:C.fromJSON(t)},I=function(e,n){localStorage.setItem(e,C.toJSON(n))},F=function(e){H(function(n){var t=W(J(e,n.bpm));return I(E.BPM,t),Object(p.a)({},n,{bpm:t})})},D=function(e){H(function(n){var t=J(e,n.signature);return I(E.TimeSignature,t),Object(p.a)({},n,{signature:t})})},L=function(e,n,t,a){U(function(r){return r.update(e,function(e){return e.update(n,function(e){return e.update(t,function(e){return Object(p.a)({},e,{isAccented:J(a,e.isAccented)})})})})})},B=function(){K(function(e){return!e})},T=function(){q(function(e){return!e})},_=function(e){F(function(n){return n+e})},R=function(){U(function(e){return e.map(function(e){return e.map(function(e){return e.map(function(e){return Object(p.a)({},e,{isActive:!1})})})})})},z=function(){G(function(e){return!e})},P=function(){G(!1)},G=function(e){H(function(n){return Object(p.a)({},n,{playing:J(e,n.playing)})})},K=function(e){V(function(n){return Object(p.a)({},n,{keepAwake:J(e,n.keepAwake)})})},q=function(e){var n=e instanceof Function?e(Q.getState().settings.showTuner):e;V(function(e){return Object(p.a)({},e,{showTuner:n})})},W=function(e){return A.a(10,250,e)},J=function(e,n){return e instanceof Function?e(n):e},U=function(e){Q.dispatch({type:a.SetActiveBeats,action:e})},H=function(e){Q.dispatch({type:a.SetMetronomeState,action:e})},V=function(e){var n=e instanceof Function?e(Q.getState().settings):e;I(E.AppSettings,n),Q.dispatch({type:a.SetSettings,action:n})},X=function(e){var n=(e instanceof Function?e(Q.getState().scales):e).sortBy(function(e){return e.pitch});I(E.ScalesDB,n),Q.dispatch({type:a.SetScales,action:n})},Y=function(){return g.Map().set(1,!0)},$=function(){var e,n=N(E.TimeSignature,{denominator:4,numerator:g.List([Y(),Y(),Y(),Y()])});return{scales:N(E.ScalesDB,x.reduce(function(e,n){return function(e,n){return e.add({scaleKey:t=n,pitch:t[0],mode:t[1],known:!1,learning:!1,bpm:60,id:"scaleId-".concat(t[0],"-").concat(t[1])});var t}(e,n)},g.OrderedSet()).sortBy(function(e){return e.pitch})),activeBeats:(e=n.numerator,g.List(e.map(function(e){return e.reduce(function(e,n,t){return n?e.set(t,g.List(M.a(0,t).map(function(){return{isActive:!0,isAccented:!1}}))):e},g.Map())}))),settings:N(E.AppSettings,{keepAwake:!1,showTuner:!1}),metronomeState:{ready:!1,pending:!0,bpm:N(E.BPM,60),playing:!1,signature:n}}},Q=b.b(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$(),n=arguments.length>1?arguments[1]:void 0;switch(n.type){case a.SetActiveBeats:return Object.assign(e,{activeBeats:J(n.action,e.activeBeats)});case a.SetMetronomeState:return Object(p.a)({},e,{metronomeState:J(n.action,e.metronomeState)});case a.SetSettings:return Object(p.a)({},e,{settings:J(n.action,e.settings)});case a.SetScales:return Object(p.a)({},e,{scales:J(n.action,e.scales)});default:return n.type.startsWith("@@redux")||console.log(n,"was not handled"),e}}),Z=function(e,n){return y.b(e,n)},ee=g.List([{name:"Larghissimo",low:0,high:24},{name:"Grave",low:25,high:45},{name:"Largo",low:40,high:60},{name:"Lento",low:45,high:60},{name:"Larghetto",low:60,high:66},{name:"Adagio",low:66,high:76},{name:"Andante",low:76,high:108},{name:"Marcia moderato",low:83,high:85},{name:"Andante moderato",low:92,high:112},{name:"Moderato",low:108,high:120},{name:"Allegro",low:120,high:156},{name:"Vivace",low:156,high:176},{name:"Vivacissimo",low:172,high:176},{name:"Allegrissimo",low:172,high:176},{name:"Presto",low:168,high:200},{name:"Prestissimo",low:200,high:250}]),ne=h.a(function(e){return""+e},function(e){return ee.filter(function(n){var t,a,r=n.high,i=n.low;return t=r,(a=e)>=i&&a<=t})}),te=l.a.memo(function(e){var n=e.name,t=e.low,a=e.high;return l.a.createElement("div",{className:"has-text-centered"},n," - ",t," - ",a)}),ae=l.a.memo(function(e){var n=e.bpm,t=ne(n);return l.a.createElement("div",{style:{minHeight:"6.5em"}},t.map(function(e){var n=e.name,t=e.high,a=e.low;return l.a.createElement(te,{key:"marking-".concat(n),name:n,high:t,low:a})}))},function(e,n){var t=e.bpm,a=n.bpm;return ne(t).equals(ne(a))}),re=function(){var e=Z(function(e){return e.metronomeState.bpm});return l.a.createElement(ae,{bpm:e})},ie=t(4),oe=t(38),ce=t(92),ue=t(40),se=t.n(ue);function le(){var e=Object(v.a)(["\n  &:not(:last-child) {\n    margin-bottom: 0 !important;\n  }\n"]);return le=function(){return e},e}var fe=["offIsPrimary","offIsLink","offIsDanger","offIsInfo","offIsSuccess","offIsOutlined"],me=["isPrimary","isLink","isDanger","isInfo","isSuccess","isOutlined"],de=function(e){var n=e.on,t=Object(oe.a)(e,["on"]),a=l.a.useMemo(function(){var e=n?fe:me;return ce.a(e,t)},[n,t]),r=l.a.useMemo(function(){return t.children instanceof Array&&2===t.children.length?n?t.children[0]:t.children[1]:t.children},[t,n]);return l.a.createElement(ve,a,r)},ve=function(e){var n=e.isPrimary,t=e.isDanger,a=e.isLink,r=e.isInfo,i=e.isSuccess,o=e.isOutlined,c=e.offIsPrimary,u=e.offIsDanger,s=e.offIsLink,f=e.offIsInfo,m=e.offIsSuccess,d=e.offIsOutlined,v=e.grow,g=e.className,h=Object(oe.a)(e,["isPrimary","isDanger","isLink","isInfo","isSuccess","isOutlined","offIsPrimary","offIsDanger","offIsLink","offIsInfo","offIsSuccess","offIsOutlined","grow","className"]),b=l.a.useMemo(function(){return se()("button",g,{"is-primary":n||c,"is-link":a||s,"is-danger":t||u,"is-info":r||f,"is-success":i||m,"is-outlined":o||d,"is-grow":v})},[g,v,n,c,a,s,t,u,r,f,o,d,i,m]),E=l.a.useMemo(function(){return Object(p.a)({},h,{className:b})},[h,b]);return l.a.createElement("button",E,h.children)},ge=ie.a.div(le()),he=function(e){var n=e.children,t=e.hasAddons,a=e.isRight,r=e.ref,i=e.className,o=e.grow,c=Object(oe.a)(e,["children","hasAddons","isRight","ref","className","grow"]),u=l.a.useMemo(function(){return se()(i,"buttons",{"has-addons":t,"is-grow":o,"is-right":a})},[t,o,i,a]);return l.a.createElement(ge,Object.assign({ref:r},c,{className:u}),n)},pe=t(93),be=(t(57),window.AudioContext||window.webkitAudioContext||void 0),Ee=t(58),we=t.n(Ee),Se=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=l.a.useState(function(){var a,r=localStorage.getItem(e);return a=null===r||void 0===r||t?n instanceof Function?n():n:C.fromJSON(r),window.localStorage.setItem(e,C.toJSON(a)),a}),r=Object(d.a)(a,2),i=r[0],o=r[1];return[i,l.a.useCallback(function(n){o(function(t){var a=n instanceof Function?n(t):n;return window.localStorage.setItem(e,C.toJSON(a)),a})},[e])]},ke=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){},t=l.a.useState(e),a=Object(d.a)(t,2),r=a[0],i=a[1];return[r,l.a.useCallback(function(){return i(function(e){var t=!e;return n(t),t})},[n])]};function je(){var e=Object(v.a)(["\n  display: flex;\n  flex-grow: 1;\n  margin-bottom: 10px;\n"]);return je=function(){return e},e}function Oe(){var e=Object(v.a)(["\n  display: flex;\n  flex-grow: 1;\n  flex-direction: column;\n"]);return Oe=function(){return e},e}function xe(){var e=Object(v.a)(["\n  display: flex;\n  flex-grow: 1;\n"]);return xe=function(){return e},e}function ye(){var e=Object(v.a)(["\n  width: 1px;\n  margin-left: 1px;\n  margin-right: 1px;\n  flex-grow: 1;\n  text-align: center;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n"]);return ye=function(){return e},e}function Me(){var e=Object(v.a)(["\n  display: flex;\n  align-items: baseline;\n  > button {\n    margin-right: 5px;\n  }\n  > div {\n    margin-right: 5px;\n  }\n"]);return Me=function(){return e},e}var Ae=l.a.memo(ie.a.section(Me())),Ce=l.a.memo(function(e){var n=e.uiEnabledDivisions,t=e.toggleDivisionOption,a=e.clearDivisions,r=Z(function(e){return e.activeBeats.getIn([0,1,0],k).isAccented}),i=l.a.useState(r),o=Object(d.a)(i,2),c=o[0],u=o[1];return l.a.useEffect(function(){r!==c&&u(r)},[r,c]),l.a.useEffect(function(){L(0,1,0,c)},[c]),l.a.createElement(Ae,null,l.a.createElement("div",{className:"is-size-5"},"Division"),l.a.createElement(de,{isLink:!0,on:c,onClick:function(){return u(function(e){return!e})}},">"),l.a.createElement(he,{hasAddons:!0,grow:!0,style:{marginRight:"5px"}},[2,3,4,5,6].map(function(e){var a=n.get(e);return l.a.createElement(de,{grow:!0,on:a,isPrimary:!0,key:"division-options-".concat(e),onClick:function(){return t(e)}},e)})),l.a.createElement(ve,{grow:!0,isDanger:!0,isOutlined:!0,onClick:a},"Clear"))}),Ne=l.a.memo(function(e){var n=e.setCurrentNumerator,t=e.currentNumerator;return l.a.createElement("section",{className:"section buttons is-centered"},[1,2,3,4,5].map(function(e){var a=t===e;return l.a.createElement(de,{key:"numerator-button-".concat(e),on:a,isPrimary:!0,isOutlined:!0,grow:!0,onClick:a?function(){}:function(){return n(e)}},l.a.createElement(l.a.Fragment,null,e,"/4"))}))}),Ie=l.a.memo(ie.a.div(ye())),Fe=l.a.memo(ie.a.div(xe())),De=l.a.memo(ie.a.div(Oe())),Le=l.a.memo(ie.a.div(je())),Be=l.a.memo(function(e){var n=e.height,t=e.beatIndex,a=e.division,r=e.divisionIndex,i=Z(function(e){return e.activeBeats.get(t).get(a).get(r)}),o=l.a.useMemo(function(){return i.isActive?"has-background-link":"has-background-primary"},[i.isActive]);return l.a.createElement(Ie,{className:o,onClick:function(){return function(e,n,t){L(e,n,t,function(e){return!e})}(t,a,r)},style:{height:n,marginTop:1}},l.a.createElement("div",null,i.isAccented&&">"))}),Te=l.a.memo(function(e){var n=e.height,t=e.beatIndex,a=e.division;return l.a.createElement(Fe,null,M.a(0,a).map(function(e){return l.a.createElement(Be,{key:"".concat(t,"-").concat(a,"-").concat(e),height:n,beatIndex:t,division:a,divisionIndex:e})}))}),_e=l.a.memo(function(e){var n=e.beatIndex,t=Z(function(e){return e.activeBeats.get(n).keySeq()},function(e,n){return e.equals(n)});return l.a.createElement(De,{key:"".concat(n)},t.map(function(e){return l.a.createElement(Te,{height:70/t.size,key:"".concat(n,"-").concat(e),beatIndex:n,division:e})}))}),Re=l.a.memo(function(){var e=Z(function(e){return e.activeBeats.size});return l.a.createElement(Le,null,M.a(0,e).map(function(e){return l.a.createElement(_e,{key:e,beatIndex:e})}))}),ze=function(){var e=D,n=Z(function(e){return e.metronomeState.signature.numerator}),t=l.a.useState(!1),a=Object(d.a)(t,2),r=a[0],i=a[1],o=Se(E.EnabledDivisions,g.Map().set(1,!0)),c=Object(d.a)(o,2),u=c[0],s=c[1];l.a.useEffect(function(){r&&e(function(e){return Object(p.a)({},e,{numerator:g.List(M.a(0,e.numerator.size).map(function(){return u}))})})},[u,r,e]);var f=l.a.useCallback(function(e){i(!0),s(function(n){var t=n.get(e),a=void 0===t||!t;return n.set(e,a)})},[s]),m=l.a.useCallback(function(){s(g.Map().set(1,!0))},[s]),v=l.a.useState(n.size),h=Object(d.a)(v,2),b=h[0],w=h[1];return l.a.useEffect(function(){e(function(e){return Object(p.a)({},e,{numerator:g.List(M.a(0,b).map(function(){return u}))})})},[b,e,u]),l.a.createElement(l.a.Fragment,null,l.a.createElement(Re,null),l.a.createElement(Ce,{uiEnabledDivisions:u,toggleDivisionOption:f,clearDivisions:m}),l.a.createElement(Ne,{currentNumerator:n.size,setCurrentNumerator:w}))},Pe=t(97),Ge=t(98),Ke=t(96),qe=t(99),We=t(94),Je=t(95),Ue=Pe.a(function(e){return Ge.a(2,e)},Ke.a(function(e){var n=Object(d.a)(e,2),t=n[0];return n[1]-t}),qe.a,We.a(6e4),Math.trunc),He=function(){var e=l.a.useState([]),n=Object(d.a)(e,2),t=n[0],a=n[1];return l.a.createElement(ve,{isLink:!0,isOutlined:!0,onClick:function(){var e=performance.now(),n=Je.a(e,t).filter(function(n){return e-n<3e3});if(n.length>1){var r=Ue(n);F(r)}a(n)}},"Tap In")};function Ve(){var e=Object(v.a)(["\n  margin-top: 10px;\n  position: relative;\n"]);return Ve=function(){return e},e}function Xe(){var e=Object(v.a)(["\n  position: absolute;\n  top: 10px;\n  right: 10px;\n  text-align: unset !important;\n"]);return Xe=function(){return e},e}for(var Ye={0:"A",1:"Bb",2:"B",3:"C",4:"Db",5:"D",6:"Eb",7:"E",8:"F",9:"Gb",10:"G",11:"Ab"},$e=[],Qe=-4;Qe<4;Qe++)for(var Ze=0;Ze<12;Ze++){var en=440*Math.pow(2,Qe),nn=en/1200,tn=en*Math.pow(2,Ze/12),an=Qe+4,rn=Ye[Ze];$e.push({octave:an,note:rn,frequency:tn,centsPerOctave:nn})}var on=l.a.memo(function(){var e=ke(!1),n=Object(d.a)(e,2),t=n[0],a=n[1],r=l.a.useState(),i=Object(d.a)(r,2),o=i[0],c=i[1],u=l.a.useState(),s=Object(d.a)(u,2),f=s[0],m=s[1],v=l.a.useState(440),g=Object(d.a)(v,2),h=g[0],p=g[1],b=l.a.useState(),E=Object(d.a)(b,2),w=E[0],S=E[1];l.a.useEffect(function(){t&&!w&&void 0!==be&&S(new be)},[t,w]),l.a.useEffect(function(){if(t&&w){m(w.sampleRate);var e,n=navigator.mediaDevices;if(n)return n.getUserMedia({audio:!0}).then(function(n){e=n;var t=w.createAnalyser();t.fftSize=8192,w.createMediaStreamSource(n).connect(t),c(t)}),function(){e.getAudioTracks().forEach(function(e){return e.stop()})}}},[t,w]),l.a.useEffect(function(){if(t&&o&&f){var e=function(){var e=o.frequencyBinCount,n=new Float32Array(e);o.getFloatFrequencyData(n);var t=n.reduce(function(e,n,t){return e[0]<n?[n,t]:e},[-1/0,-1]),a=Object(d.a)(t,2)[1],r=f/o.fftSize;p(r*a)};e();var n=setInterval(e,50);return function(){clearInterval(n)}}},[t,o,f]);var k=function(e){for(var n=0,t=0;t<$e.length;t++)if($e[t].frequency>=e){n=t;break}var a=n+1,r=$e[n],i=$e[a],o=(r.frequency+i.frequency)/2,c=$e[a],u=c.frequency-e;e<o&&(c=$e[n]);var s=c.centsPerOctave*u;return Object.assign(c,{originalFrequency:e,difference:u,cents:s})}(h||0),j=k.octave,O=k.note,x=k.cents;return l.a.createElement(un,{className:"box has-text-centered"},l.a.createElement(cn,null,l.a.createElement(ve,{isDanger:!0,isOutlined:!0,onClick:T},"X")),l.a.createElement("div",{className:"is-size-1"},t?O+j:"Stopped"),l.a.createElement("div",null,t?l.a.createElement(l.a.Fragment,null,x.toFixed(2)," Cents ",x<0?"flat":"sharp"):"press start to tune"),l.a.createElement(he,{className:"is-right"},l.a.createElement(de,{on:t,isDanger:!0,offIsPrimary:!0,onClick:a},l.a.createElement(l.a.Fragment,null,"Stop"),l.a.createElement(l.a.Fragment,null,"Start"))))}),cn=ie.a.div(Xe()),un=ie.a.section(Ve()),sn=on;function ln(){var e=Object(v.a)(["\n  align-self: center;\n  margin: auto;\n  z-index: 1;\n  pointer-events: none;\n"]);return ln=function(){return e},e}function fn(){var e=Object(v.a)(["\n  width: 100px;\n  height: 100px;\n  border-radius: 100px;\n  position: absolute;\n  touch-action: none;\n"]);return fn=function(){return e},e}function mn(){var e=Object(v.a)(["\n  margin: auto;\n  position: relative;\n  height: 300px;\n  width: 300px;\n  border-radius: 300px;\n  display: flex;\n  margin-bottom: 10px;\n"]);return mn=function(){return e},e}var dn=ie.a.div(mn()),vn=ie.a.div(fn()),gn=function(e){var n=e.container,t=e.addDiff,a=e.size,r=Se(E.Radians,3*Math.PI/2),i=Object(d.a)(r,2),o=i[0],c=i[1],u=l.a.useRef(Math.PI);l.a.useEffect(function(){u.current=o},[o]);var s=l.a.useCallback(function(e){g(!0),e.preventDefault()},[]),f=l.a.useState(!1),m=Object(d.a)(f,2),v=m[0],g=m[1],h=l.a.useRef(!1);l.a.useEffect(function(){h.current=v},[v]);var p=l.a.useState(0),b=Object(d.a)(p,2),w=b[0],S=b[1],k=l.a.useRef(0);l.a.useEffect(function(){k.current=w},[w]);var j=l.a.useCallback(function(e){g(!1)},[]),O=l.a.useCallback(function(e){Math.abs(k.current)<.2?S(function(n){return n+e}):(t(k.current>0?-1:1),S(0))},[t]),x=l.a.useCallback(function(e){if(null!==n){var t=e.clientX,a=e.clientY,r=n.getBoundingClientRect(),i={x:r.left+r.width/2,y:r.top+r.height/2},o=-(i.y-a),s=-(i.x-t),l=Math.atan2(o,s),f=u.current-l;f<-Math.PI?f=-u.current-l:f>Math.PI&&(f=u.current- -l),0!==f&&O(f),l===u.current||c(l)}},[O,c,n]),y=l.a.useCallback(function(e){var n=e.changedTouches[0];x(n)},[x]),M=l.a.useCallback(function(e){h.current&&x(e)},[x]),A=function(e){var n=l.a.useState(e),t=Object(d.a)(n,2),a=t[0],r=t[1],i=l.a.useRef(e);return l.a.useEffect(function(){i.current=e},[e]),l.a.useEffect(function(){var e=-1,n=function(){t(),r(i.current)},t=function(){e=requestAnimationFrame(n)};return t(),function(){cancelAnimationFrame(e)}},[]),a}(o),C=l.a.useMemo(function(){return a/2+Math.sin(A)*(a/4)+Math.sin(A)*a/16-a/6},[A,a]),N=l.a.useMemo(function(){return a/2+Math.cos(A)*(a/4)+Math.cos(A)*a/16-a/6},[A,a]);return l.a.useEffect(function(){return window.addEventListener("mouseup",j),window.addEventListener("mousemove",M),function(){window.removeEventListener("mouseup",j),window.removeEventListener("mousemove",M)}},[M,j]),l.a.createElement(vn,{className:"has-background-info",onMouseDown:s,onTouchMove:y,style:{top:C,left:N}})},hn=l.a.memo(ie.a.div(ln())),pn=function(e){var n=e.size,t=void 0===n?300:n,a=e.addDiff,r=e.children,i=l.a.useState(null),o=Object(d.a)(i,2),c=o[0],u=o[1];return l.a.createElement(dn,{ref:u,className:"has-background-primary"},l.a.createElement(gn,{addDiff:a,container:c,size:t}),l.a.createElement(hn,null,r))},bn=t(61),En=t(59),wn=t.n(En),Sn=t(80),kn=function(e,n){var t=n.time,a=n.gain,r=n.buffer,i=e.createBufferSource();i.buffer=r;var o=e.createGain();o.gain.value=a,i.connect(o),o.connect(e.destination),i.start(t)},jn=-1,On=function(e,n,t,a,r,i,o,c,u){var s=60/e,l=t;if(n.current<r+i){var f=function(e,n,t,a,r){var i=[],o=Q.getState().activeBeats;return t.filter(function(e){return e}).forEach(function(t,c){for(var u=n/c,s=0;s<c;s++){var l=o.get(r,O).get(c,j).get(s,k).isAccented,f={time:e+s*u,divisionLength:u,pitch:220,gain:l?1:.1,buffer:a,divisions:c,divisionIndex:s,currentBeat:r,isAccented:l};i.push(f)}}),i.sort(function(e,n){return e.time-n.time}),i}(n.current,s,l,o,a);c.push.apply(c,Object(bn.a)(f)),n.current+=s,u()}},xn=.1,yn=function(e){var n=Z(function(e){return e.metronomeState.playing}),t=function(e,n){var t=l.a.useState(),a=Object(d.a)(t,2),r=a[0],i=a[1];return l.a.useEffect(function(){void 0!==e&&"not-supported"!==e&&"pending"!==e&&fetch(n).then(function(e){return e.arrayBuffer()}).then(function(n){return e.decodeAudioData(n)}).then(i)},[n,e]),r}(e,Sn),a=Z(function(e){return e.metronomeState.signature.numerator.size}),r=l.a.useRef(a),i=l.a.useRef(n),o=l.a.useRef(0),c=n?150:void 0,u=l.a.useRef(0);l.a.useEffect(function(){n||(u.current=0),i.current=n,r.current=a},[n,a]);var s=l.a.useCallback(function(){var e=u.current;u.current=(e+1)%r.current},[]),f=l.a.useCallback(function(e,n){!function(e,n,t){setTimeout(t,1e3*(n-e.currentTime))}(e,n.time,function(){i.current&&function(e){U(function(n){return void 0===n.getIn([e.currentBeat,e.divisions,e.divisionIndex])?n:n.update(e.currentBeat,function(n){return n.update(e.divisions,function(n){return n.update(e.divisionIndex,function(e){return Object(p.a)({},e,{isActive:!e.isActive})})})})})}(n)})},[]);l.a.useEffect(function(){if(void 0!==c&&void 0!==e&&"not-supported"!==e&&"pending"!==e&&void 0!==t){var n=new wn.a,a=e.currentTime+.3;o.current=a;var r=function(){var a=Q.getState().metronomeState.signature.numerator,r=Math.min(u.current,a.size-1),i=a.get(r);void 0!==i&&On(Q.getState().metronomeState.bpm,o,i,u.current,e.currentTime,.3,t,n,s),function(e,n,t,a){for(var r=t.currentTime+n+xn;e.peekFront()&&e.peekFront().time<r;){var i=e.shift();(i.time!==jn||i.isAccented)&&kn(t,i),jn=i.time,a(t,i)}}(n,c/1e3,e,f)};r();var i=setInterval(r,c);return function(){clearInterval(i)}}},[c,t,e,f,s])},Mn=function(e){var n=Z(function(e){return e.metronomeState.playing});l.a.useEffect(function(){if(n)return function(){P()}},[n]);var t=Z(function(e){return e.metronomeState.signature.numerator});l.a.useEffect(function(){R(),function(e){U(function(n){return e.map(function(e,t){var a=n.get(t);return e.reduce(function(e,n,t){return n?a&&a.get(t)?e.set(t,a.get(t)):e.set(t,g.List(M.a(0,t).map(function(){return{isActive:!1,isAccented:!1}}))):e},g.Map())})})}(t)},[t]),l.a.useEffect(function(){n||R()},[n]),l.a.useEffect(function(){var n;"pending"!==e&&void 0!==e&&(n=!1,H(function(e){return Object(p.a)({},e,{pending:J(n,e.pending)})}))},[e]),yn(e)};function An(){var e=Object(v.a)(["\n  margin: 0 !important;\n  height: 100%;\n  width: 100%;\n  position: fixed;\n  z-index: 1;\n  left: 0;\n  top: 0;\n  background-color: rgba(0, 0, 0, 0.8);\n  color: white;\n  text-align: center;\n"]);return An=function(){return e},e}var Cn=ie.a.div(An()),Nn=function(){var e=Z(function(e){return e.metronomeState.bpm});return l.a.createElement("div",{className:"has-text-centered is-size-1"},e)},In=l.a.memo(function(){return l.a.createElement("section",{className:"section"},l.a.createElement(pn,{addDiff:_},l.a.createElement(Nn,null),l.a.createElement(re,null)))}),Fn=l.a.memo(function(){var e=Z(function(e){return e.metronomeState.playing}),n=Z(function(e){return e.metronomeState.pending}),t=Z(function(e){return e.settings.showTuner});return l.a.createElement("section",{className:"section"},l.a.createElement(he,{hasAddons:!0},l.a.createElement(de,{isLink:!0,offIsOutlined:!0,offIsLink:!0,on:t,onClick:T},"Tuner"),l.a.createElement(He,null),l.a.createElement(de,{on:e,offIsPrimary:!0,grow:!0,isOutlined:!0,isDanger:!0,disabled:n,onClick:z},l.a.createElement(l.a.Fragment,null,"Stop"),l.a.createElement(l.a.Fragment,null,"Start"))))}),Dn=function(e){var n=e.audioContext,t=Z(function(e){return e.metronomeState.pending}),a=Z(function(e){return e.settings.showTuner});return Mn(n),l.a.createElement(l.a.Fragment,null,t&&l.a.createElement(Cn,null,"Tap to enable audio."),a&&l.a.createElement(sn,null),l.a.createElement(In,null),l.a.createElement(ze,null),l.a.createElement(Fn,null))};function Ln(){var e=Object(v.a)([""]);return Ln=function(){return e},e}var Bn,Tn=ie.a.section(Ln()),_n=function(){var e=Z(function(e){return e.settings.keepAwake});return l.a.createElement(Tn,null,l.a.createElement("h2",{className:"is-size-4"},"Settings"),l.a.createElement("div",{className:"field"},l.a.createElement("div",{className:"control"},l.a.createElement("label",{className:"checkbox"},l.a.createElement("input",{style:{marginRight:"5px"},type:"checkbox",checked:e,onChange:B}),"Keep screen on while metronome is running."))))};!function(e){e.NOT_STARTED="not-started",e.KNOWN="known",e.LEARNING="learning"}(Bn||(Bn={}));var Rn=l.a.memo(function(e){var n=e.id,t=e.bpm;return l.a.createElement(ve,{isDanger:t<0,isPrimary:t>0,isOutlined:!0,grow:!0,onClick:function(){return function(e,n){X(function(t){var a=t.find(function(n){return n.id===e});return a?t.remove(a).add(Object(p.a)({},a,{bpm:a.bpm+n})):t})}(n,t)}},t)}),zn=l.a.memo(function(e){var n=e.reset,t=e.scaleMode,a=Z(function(e){return e.scales.filter(function(e){return t===Bn.LEARNING?e.learning:t===Bn.KNOWN&&e.known}).map(function(e){return e.id})},function(e,n){return e.equals(n)}),r=l.a.useState(function(){return g.OrderedSet(function(e){var n,t,a;for(a=e.length-1;a>0;a--)n=Math.floor(Math.random()*(a+1)),t=e[a],e[a]=e[n],e[n]=t;return e}(a.toArray()))}),i=Object(d.a)(r,2),o=i[0],c=i[1],u=o.size>1?"Next":"Finish",s=o.first(void 0),f=Z(function(e){return e.scales.find(function(e){return e.id===s})}),m=l.a.useCallback(function(){o.first()&&c(o.rest())},[o,c]);l.a.useEffect(function(){var e;f&&(void 0!==(e=f.bpm)&&F(e),G(!0))},[f]);var v=l.a.useMemo(function(){return l.a.createElement(ve,{isDanger:!0,isOutlined:!0,onClick:n},"Stop")},[n]),h=l.a.useMemo(function(){return l.a.createElement(ve,{isPrimary:!0,onClick:m},u)},[u,m]);if(void 0===s)return n(),null;var p=f,b=p.mode,E=p.pitch,w=p.bpm;return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"box"},l.a.createElement("div",{style:{alignSelf:"center",fontWeight:"bold"},className:"control is-expanded is-size-5"},t),l.a.createElement("div",{style:{display:"flex",marginBottom:"5px"}},l.a.createElement("div",{style:{alignSelf:"center",marginRight:"10px"}},E," ",b," @ ",w,"bpm"),l.a.createElement(he,{grow:!0,hasAddons:!0},l.a.createElement(Rn,{id:s,bpm:-10}),l.a.createElement(Rn,{id:s,bpm:-1}),l.a.createElement(Rn,{id:s,bpm:1}),l.a.createElement(Rn,{id:s,bpm:10}))),l.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},v,h)),l.a.createElement(ze,null))}),Pn=function(e){var n=e.mode,t=e.hideKnown,a=Z(function(e){return e.scales.filter(function(e){return e.mode===n&&(!t||!e.known)}).map(function(e){return e.id})},function(e,n){return e.equals(n)});return l.a.createElement(l.a.Fragment,null,a.map(function(e){return l.a.createElement(Gn,{key:"scale-".concat(e),id:e})}))},Gn=function(e){var n=e.id,t=Z(function(e){return e.scales.find(function(e){return e.id===n})}),a=t.pitch,r=t.mode,i=t.known,o=t.learning;return l.a.createElement("div",{className:"is-grouped field has-addons"},l.a.createElement("div",{className:"is-size-5 control is-expanded"},a," ",r),l.a.createElement(he,null,l.a.createElement(de,{on:i,isInfo:!0,onClick:function(){return function(e){X(function(n){var t=n.find(function(n){return n.id===e});return t?n.remove(t).add(Object(p.a)({},t,{known:!t.known})):n})}(n)}},"Known"),l.a.createElement(de,{on:o,isLink:!0,onClick:function(){return function(e){X(function(n){var t=n.find(function(n){return n.id===e});return t?n.remove(t).add(Object(p.a)({},t,{learning:!t.learning})):n})}(n)}},"Learning")))},Kn=l.a.memo(function(e){var n=e.audioContext;Mn(n);var t=l.a.useState(Bn.NOT_STARTED),a=Object(d.a)(t,2),r=a[0],i=a[1],o=function(e,n){var t=Se(e,n),a=Object(d.a)(t,2),r=a[0],i=a[1];return[r,l.a.useCallback(function(){i(pe.a)},[i])]}(E.ShowKnown,!1),c=Object(d.a)(o,2),u=c[0],s=c[1],f=Z(function(e){return!!e.scales.find(function(e){return e.known})}),m=Z(function(e){return!!e.scales.find(function(e){return e.learning})});return l.a.useEffect(function(){r===Bn.NOT_STARTED&&P()},[r]),l.a.createElement("div",{style:{marginTop:"10px"}},r===Bn.NOT_STARTED?l.a.createElement("div",{style:{marginBottom:"5px"}},l.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},l.a.createElement("div",{style:{alignSelf:"center",fontWeight:"bold"},className:"control is-expanded is-size-5"},"Scales"),l.a.createElement(he,null,l.a.createElement(ve,{onClick:function(){return i(Bn.KNOWN)},disabled:!f,className:"is-info is-outlined"},"Start Known"),l.a.createElement(ve,{onClick:function(){return i(Bn.LEARNING)},disabled:!m,className:"is-link is-outlined"},"Start Learning"))),l.a.createElement("hr",null),l.a.createElement(he,{isRight:!0},l.a.createElement(de,{offIsDanger:!0,offIsOutlined:!0,on:u,onClick:s},l.a.createElement(l.a.Fragment,null,"Hide Known"),l.a.createElement(l.a.Fragment,null,"Hiding Known"))),l.a.createElement(Pn,{mode:w.Major,hideKnown:!u}),l.a.createElement("hr",null),l.a.createElement(Pn,{mode:w.Minor,hideKnown:!u})):l.a.createElement(zn,{scaleMode:r,reset:function(){return i(Bn.NOT_STARTED)}}))}),qn=t(29),Wn=t(20),Jn=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Un(e){if("serviceWorker"in navigator){if(new URL("/metronome",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var n="".concat("/metronome","/service-worker.js");Jn?(!function(e,n){fetch(e).then(function(t){var a=t.headers.get("content-type");404===t.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):Hn(e,n)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(n,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):Hn(n,e)})}}function Hn(e,n){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;null!=t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),n&&n.onUpdate&&n.onUpdate(e)):(console.log("Content is cached for offline use."),n&&n.onSuccess&&n.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}function Vn(){var e=Object(v.a)(["\n  position: absolute;\n  max-width: ",";\n  width: 95%;\n  margin-top: 10px;\n  left: 0;\n  right: 0;\n  margin-left: auto !important;\n  margin-right: auto !important;\n  z-index: 10;\n  display: flex !important;\n  justify-content: space-between;\n  animation: ease-in 1s ",";\n"]);return Vn=function(){return e},e}function Xn(){var e=Object(v.a)(["\n    from {\n      opacity: 0;\n    }\n    to {\n      opacity: 1;\n    }\n"]);return Xn=function(){return e},e}var Yn=Object(ie.b)(Xn()),$n=ie.a.section(Vn(),"40em",Yn),Qn=!1,Zn=function(){var e=l.a.useState(!1),n=Object(d.a)(e,2),t=n[0],a=n[1],r=l.a.useCallback(function(){window.location.reload()},[]),i=l.a.useCallback(function(){a(!1)},[]);return l.a.useEffect(function(){Qn||Un({onUpdate:function(){a(!0)}}),Qn=!0},[]),l.a.createElement(l.a.Fragment,null,t&&l.a.createElement($n,{className:"box"},l.a.createElement("span",null,"An Update is Available!"),l.a.createElement(he,null,l.a.createElement(ve,{isPrimary:!0,isOutlined:!0,onClick:r},"Refresh"),l.a.createElement(ve,{isDanger:!0,isOutlined:!0,onClick:i},"x"))))},et=t(37),nt=t(25);function tt(){var e=Object(v.a)(["\n  display: flex;\n  flex-direction: column;\n  align-items: flex-end;\n  justify-content: flex-end;\n  margin-top: 5px;\n"]);return tt=function(){return e},e}function at(){var e=Object(v.a)(["\n  max-width: ",";\n  margin: 0 auto;\n  display: flex;\n  flex-direction: column;\n  > * {\n    margin-left: 10px;\n    margin-right: 10px;\n  }\n"]);return at=function(){return e},e}function rt(){var e=Object(v.a)(["\n  margin-left: 5px;\n"]);return rt=function(){return e},e}function it(){var e=Object(v.a)([""]);return it=function(){return e},e}function ot(){var e=Object(v.a)(["\n  display: flex;\n  position: absolute;\n  z-index: 2;\n  width: 100%;\n  flex-direction: column;\n  align-items: flex-end;\n  padding-right: 10px;\n  align-self: flex-end;\n  opacity: 0.9;\n  > a {\n    animation: ease-in 0.1s ",";\n    font-size: 1.5rem;\n    margin: 10px;\n  }\n"]);return ot=function(){return e},e}function ct(){var e=Object(v.a)(["\n  from {\nfont-size: 0px;\n  }\nto {\nmargin: 10px;\n}\n"]);return ct=function(){return e},e}function ut(){var e=Object(v.a)(["\n  display: flex;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  padding-left: 10px;\n  padding-right: 10px;\n  justify-content: space-between;\n  > h2 {\n    margin: 0 !important;\n  }\n"]);return ut=function(){return e},e}function st(){var e=Object(v.a)(["\n  align-self: center;\n"]);return st=function(){return e},e}function lt(){var e=Object(v.a)(["\n  margin-bottom: 10px;\n  margin-left: 0px !important;\n  margin-right: 0px !important;\n  position: relative;\n  display: inline-block;\n  flex-direction: column;\n"]);return lt=function(){return e},e}var ft=l.a.memo(ie.a.section(lt())),mt=l.a.memo(ie.a.span(st())),dt=l.a.memo(ie.a.section(ut())),vt=Object(ie.b)(ct()),gt=l.a.memo(ie.a.nav(ot(),vt)),ht=l.a.memo(Object(ie.a)(qn.b)(it())),pt=l.a.memo(Object(ie.a)(et.a)(rt())),bt=function(e){var n=e.toggleNav;return l.a.useEffect(function(){return window.addEventListener("click",n),function(){window.removeEventListener("click",n)}},[n]),l.a.createElement(gt,{className:"has-background-white"},l.a.createElement(ht,{to:"/"},"Home",l.a.createElement(pt,{icon:nt.d})),l.a.createElement(ht,{to:"/scales"},"Scales",l.a.createElement(pt,{icon:nt.e})),l.a.createElement(ht,{to:"/settings"},"Settings",l.a.createElement(pt,{icon:nt.c})))},Et=l.a.memo(function(){var e=ke(!1),n=Object(d.a)(e,2),t=n[0],a=n[1],r=Z(function(e){return e.settings.keepAwake&&e.metronomeState.playing});return l.a.createElement(ft,null,l.a.createElement(dt,{className:"has-background-primary has-text-light"},l.a.createElement(qn.b,{to:"/",className:"has-text-white"},l.a.createElement("h2",{className:"is-size-4 is-bold"},"(mjh)tronome")),r&&l.a.createElement(qn.b,{to:"/settings"},l.a.createElement(mt,{className:"has-text-info",onClick:a},l.a.createElement(et.a,{icon:nt.b,size:"2x"}))),l.a.createElement(mt,{onClick:a},l.a.createElement(et.a,{icon:nt.a,size:"2x"}))),t&&l.a.createElement(bt,{toggleNav:a}))}),wt=l.a.memo(ie.a.div(at(),"40em")),St=l.a.memo(ie.a.div(tt())),kt=l.a.memo(function(e){var n=e.children;return l.a.createElement(wt,null,l.a.createElement(Zn,null),l.a.createElement(Et,null),n,l.a.createElement(St,null,"v".concat("1.0.31")))}),jt=function(){var e=function(){var e=l.a.useState(),n=Object(d.a)(e,2),t=n[0],a=n[1],r=l.a.useRef(),i=l.a.useState(!1),o=Object(d.a)(i,2),c=o[0],u=o[1],s=l.a.useCallback(function(){c||void 0!==r.current&&(a("pending"),r.current.resume().then(function(){u(!0),a(r.current),document.removeEventListener("touchstart",s),document.removeEventListener("click",s),document.removeEventListener("touchend",s)}))},[c,u]);return l.a.useEffect(function(){if(void 0===be)a("not-supported");else{var e=new be;r.current=e,"suspended"===e.state?(document.addEventListener("touchstart",s),document.addEventListener("click",s),document.addEventListener("touchend",s)):a(e)}},[s]),t}(),n=Z(function(e){return e.settings.keepAwake}),t=Z(function(e){return e.metronomeState.playing});return function(e){var n=l.a.useState(new we.a),t=Object(d.a)(n,1)[0];l.a.useEffect(function(){e?t.enable():t.disable()},[e,t])}(n&&t),l.a.createElement(qn.a,{basename:"/metronome"},l.a.createElement(kt,null,"not-supported"===e&&l.a.createElement("div",null,"Your browser doesn't support the audioContext api, so this will not work. Sorry :("),l.a.createElement(Wn.a,{exact:!0,path:"/",render:function(){return l.a.createElement(Dn,{audioContext:e})}}),l.a.createElement(Wn.a,{exact:!0,path:"/scales",render:function(){return l.a.createElement(Kn,{audioContext:e})}}),l.a.createElement(Wn.a,{exact:!0,path:"/settings",render:function(){return l.a.createElement(_n,null)}})))},Ot=(t(88),function(e){function n(e){var t;return Object(r.a)(this,n),(t=Object(o.a)(this,Object(c.a)(n).call(this,e))).state={error:void 0},t}return Object(u.a)(n,e),Object(i.a)(n,[{key:"render",value:function(){return this.state.error?l.a.createElement("div",null,l.a.createElement("h1",null,"Something went wrong"),l.a.createElement("hr",null),l.a.createElement("code",null,this.state.error instanceof Error&&this.state.error.name),l.a.createElement("hr",null),l.a.createElement("code",null,this.state.error instanceof Error&&this.state.error.message),l.a.createElement("hr",null),l.a.createElement("code",null,this.state.error instanceof Error&&this.state.error.stack),l.a.createElement("hr",null),l.a.createElement("code",null,JSON.stringify(this.state.error,void 0,"  "))):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{error:e}}}]),n}(l.a.Component));m.a.render(l.a.createElement(y.a,{store:Q},l.a.createElement(Ot,null,l.a.createElement(jt,null))),document.getElementById("root"))}},[[65,1,2]]]);
//# sourceMappingURL=main.8a1c2111.chunk.js.map