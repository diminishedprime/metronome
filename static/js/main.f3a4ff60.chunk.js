(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{57:function(e,n,t){e.exports=t(79)},70:function(e,n,t){e.exports=t.p+"static/media/click.b48ed3e5.wav"},78:function(e,n,t){},79:function(e,n,t){"use strict";t.r(n);var a=t(41),r=t(42),i=t(54),c=t(43),o=t(56),u=t(0),s=t.n(u),l=t(23),f=t.n(l),m=t(1),d=t(4),b=[{name:"Larghissimo",range:[0,24]},{name:"Grave",range:[25,45]},{name:"Largo",range:[40,60]},{name:"Lento",range:[45,60]},{name:"Larghetto",range:[60,66]},{name:"Adagio",range:[66,76]},{name:"Andante",range:[76,108]},{name:"Marcia moderato",range:[83,85]},{name:"Andante moderato",range:[92,112]},{name:"Moderato",range:[108,120]},{name:"Allegro",range:[120,156]},{name:"Vivace",range:[156,176]},{name:"Vivacissimo",range:[172,176]},{name:"Allegrissimo",range:[172,176]},{name:"Presto",range:[168,200]},{name:"Prestissimo",range:[200,250]}],v=function(e){return b.filter(function(n){return function(e,n){var t=Object(m.a)(e,2),a=t[0],r=t[1];return n>=a&&n<=r}(n.range,e)})},g=function(e){var n=e.bpm,t=v(n);return s.a.createElement("div",{style:{minHeight:"6.5em"}},t.map(function(e,n){var t=e.name,a=e.range;return s.a.createElement("div",{key:n,className:"has-text-centered"},t," - ",a[0]," - ",a[1])}))},p=t(16),h=t(89),j=t(5),O=t(29),E=t(80);function w(){var e=Object(d.a)(["\n  &:not(:last-child) {\n    margin-bottom: 0 !important;\n  }\n"]);return w=function(){return e},e}var k=function(e){var n=Object(u.useState)(e),t=Object(m.a)(n,2),a=t[0],r=t[1],i=e.on,c=e.children,o=e.className,l=void 0===o?"":o;Object(u.useEffect)(function(){var n=e;e.on?(n=E.a("offIsPrimary",n),n=E.a("offIsLink",n),n=E.a("offIsDanger",n),n=E.a("offIsInfo",n),n=E.a("offIsSuccess",n),n=E.a("offIsOutlined",n)):(n=E.a("isPrimary",n),n=E.a("isLink",n),n=E.a("isDanger",n),n=E.a("isInfo",n),n=E.a("isSuccess",n),n=E.a("isOutlined",n)),r(n)},[l,e]);a.on;var f=Object(O.a)(a,["on"]),d=c instanceof Array&&2===c.length?i?c[0]:c[1]:c;return s.a.createElement(y,f,d)},y=function(e){var n=e.isPrimary,t=e.isDanger,a=e.isLink,r=e.isInfo,i=e.isSuccess,c=e.isOutlined,o=e.offIsPrimary,u=e.offIsDanger,l=e.offIsLink,f=e.offIsInfo,m=e.offIsSuccess,d=e.offIsOutlined,b=e.grow,v=Object(O.a)(e,["isPrimary","isDanger","isLink","isInfo","isSuccess","isOutlined","offIsPrimary","offIsDanger","offIsLink","offIsInfo","offIsSuccess","offIsOutlined","grow"]),g=n?"is-primary":"",h=a?"is-link":"",j=t?"is-danger":"",E=r?"is-info":"",w=i?"is-success":"",k=c?"is-outlined":"",y=o?"is-primary":"",S=l?"is-link":"",x=u?"is-danger":"",M=f?"is-info":"",C=m?"is-success":"",N=d?"is-outlined":"",A=v.className?v.className:"",I="".concat(A," button ").concat(g," ").concat(h," ").concat(k," ").concat(j," ").concat(E," ").concat(w," ").concat(y," ").concat(x," ").concat(x," ").concat(M," ").concat(S," ").concat(C," ").concat(N),D=b?{flexGrow:1}:{};return s.a.createElement("button",Object.assign({style:D},Object(p.a)({},v,{className:I})),v.children)},S=j.a.div(w()),x=function(e){var n=e.children,t=e.hasAddons,a=e.className,r=void 0===a?"":a,i=(e.ref,e.style),c=void 0===i?{}:i,o=e.grow,u=Object(O.a)(e,["children","hasAddons","className","ref","style","grow"]),l=t?"has-addons":"",f="".concat(r," buttons ").concat(l);return s.a.createElement(S,Object.assign({style:Object.assign(c,{flexGrow:o?1:"unset"})},u,{className:f}),n)},M=t(10);function C(){var e=Object(d.a)(["\n  display: flex;\n  flex-grow: 1;\n  margin-bottom: 10px;\n"]);return C=function(){return e},e}function N(){var e=Object(d.a)(["\n  display: flex;\n  flex-grow: 1;\n  flex-direction: column;\n"]);return N=function(){return e},e}function A(){var e=Object(d.a)(["\n  display: flex;\n  flex-grow: 1;\n"]);return A=function(){return e},e}function I(){var e=Object(d.a)(["\n  width: 1px;\n  margin-left: 1px;\n  margin-right: 1px;\n  flex-grow: 1;\n"]);return I=function(){return e},e}function D(){var e=Object(d.a)(["\n  display: flex;\n  align-items: baseline;\n  > div {\n    margin-right: 10px;\n  }\n"]);return D=function(){return e},e}var F,B,P,_=j.a.section(D()),T=j.a.div(I()),R=j.a.div(A()),L=j.a.div(N()),z=j.a.div(C()),K=function(e){var n=e.on,t=e.beatRows,a=s.a.useMemo(function(){return n?"has-background-primary":"has-background-link"},[n]),r=s.a.useMemo(function(){return 70/t},[t]);return s.a.createElement(T,{className:a,style:{height:r,marginTop:1}})},G=function(e){var n=e.bools,t=e.beatNumber,a=e.rowIndex,r=e.beatRows,i=a,c=t;return s.a.createElement(R,{key:"".concat(c,"-").concat(i)},n.map(function(e,n){return s.a.createElement(K,{beatRows:r,key:"".concat(c,"-").concat(a,"-").concat(n),on:e})}))},W=function(e){var n=e.beat,t=e.index,a=n.entrySeq();return s.a.createElement(L,{key:"".concat(t)},a.map(function(e,n){var r=Object(m.a)(e,2),i=r[0],c=r[1];return s.a.createElement(G,{beatRows:a.size||0,key:"".concat(t,"-").concat(n),divisions:i,bools:c,beatNumber:t,rowIndex:n})}))},q=function(e){var n=e.activeBeats;return s.a.createElement(z,null,n.map(function(e,n){return s.a.createElement(W,{key:n,beat:e,index:n})}))},J=function(e){var n=e.metronome,t=s.a.useMemo(function(){return n.setSignature},[n.setSignature]),a=s.a.useMemo(function(){return n.state.activeDivisions},[n.state.activeDivisions]),r=s.a.useMemo(function(){return n.state.signature.numerator},[n.state.signature.numerator]),i=Object(u.useState)(!1),c=Object(m.a)(i,2),o=c[0],l=c[1],f=Object(u.useState)(M.b().set(1,!0)),d=Object(m.a)(f,2),b=d[0],v=d[1],g=Object(u.useCallback)(function(e){l(!0),t(function(n){return Object(p.a)({},n,{numerator:M.a(h.a(0,e).map(function(){return b}))})})},[b,t]);Object(u.useEffect)(function(){o&&t(function(e){return Object(p.a)({},e,{numerator:M.a(h.a(0,e.numerator.size).map(function(){return b}))})})},[b,o,t]);var j=Object(u.useCallback)(function(e){l(!0),v(function(n){var t=n.get(e),a=void 0===t||!t;return n.set(e,a)})},[v]),O=Object(u.useCallback)(function(){v(M.b().set(1,!0))},[v]);return s.a.createElement(s.a.Fragment,null,s.a.createElement("section",{style:{marginTop:"10px"},className:"section is-centered"}),s.a.createElement(_,null,s.a.createElement("div",{className:"is-size-5"},"Division"),s.a.createElement(x,{hasAddons:!0,grow:!0,style:{marginRight:"5px"}},[2,3,4,5,6].map(function(e){var n=b.get(e);return s.a.createElement(k,{grow:!0,on:n,isPrimary:!0,key:"division-options-".concat(e),onClick:function(){return j(e)}},e)})),s.a.createElement(y,{grow:!0,isDanger:!0,isOutlined:!0,onClick:O},"Clear")),s.a.createElement(q,{activeBeats:a}),s.a.createElement("section",{className:"section buttons is-centered"},[1,2,3,4,5].map(function(e){var n=r.size===e;return s.a.createElement(k,{key:"numerator-button-".concat(e),on:n,isPrimary:!0,isOutlined:!0,grow:!0,onClick:n?function(){}:function(){return g(e)}},s.a.createElement(s.a.Fragment,null,e,"/4"))})))},U=t(87),V=t(88),H=t(52),Y=t(90),X=t(81),$=t(82),Q=U.a(function(e){return V.a(2,e)},H.a(function(e){var n=Object(m.a)(e,2),t=n[0];return n[1]-t}),Y.a,X.a(6e4),Math.trunc),Z=function(e){var n=e.setBPM,t=Object(u.useState)([]),a=Object(m.a)(t,2),r=a[0],i=a[1];return s.a.createElement(y,{isLink:!0,isOutlined:!0,onClick:function(){var e=performance.now(),t=$.a(e,r).filter(function(n){return e-n<3e3});if(t.length>1){var a=Q(t);n(a)}i(t)}},"Tap In")},ee=t(83),ne=t(47);!function(e){e.AppSettings="@mjh/k/app-settings-0",e.SignatureDivisions="@mjh/k/signature-divisions-3",e.ShowKnown="@mjh/k/show-known-2",e.ScalesDB="@mjh/k/scales-db-1",e.ActiveBeats="@mjh/k/active-beats-2",e.TimeSignature="@mjh/k/signature-2",e.BPM="@mjh/k/bpm-0",e.KnownScales="@mjh/k/known-scales-0",e.ShowScales="@mjh/k/show-scales-0",e.ShowTuner="@mjh/k/show-tuner-0",e.ShowDial="@mjh/k/show-dial-0",e.Radians="@mjh/k/radians-0",e.WakeLock="@mjh/k/wake-lock-0"}(F||(F={})),function(e){e.Major="Major",e.Minor="Minor"}(B||(B={})),function(e){e.A="A",e.B="B",e.C="C",e.D="D",e.E="E",e.F="F",e.G="G",e.A_Flat="Ab",e.B_Flat="Bb",e.C_Flat="Cb",e.D_Flat="Db",e.E_Flat="Eb",e.F_Flat="Fb",e.G_Flat="Gb",e.A_Sharp="A#",e.B_Sharp="B#",e.C_Sharp="C#",e.D_Sharp="D#",e.E_Sharp="E#",e.F_Sharp="F#",e.G_Sharp="G#"}(P||(P={}));var te=[[P.A,B.Major],[P.B,B.Major],[P.C,B.Major],[P.D,B.Major],[P.E,B.Major],[P.F,B.Major],[P.G,B.Major],[P.A_Flat,B.Major],[P.B_Flat,B.Major],[P.C_Flat,B.Major],[P.D_Flat,B.Major],[P.E_Flat,B.Major],[P.G_Flat,B.Major],[P.C_Sharp,B.Major],[P.F_Sharp,B.Major],[P.A,B.Minor],[P.B,B.Minor],[P.C,B.Minor],[P.D,B.Minor],[P.E,B.Minor],[P.F,B.Minor],[P.G,B.Minor],[P.A_Flat,B.Minor],[P.B_Flat,B.Minor],[P.E_Flat,B.Minor],[P.A_Sharp,B.Minor],[P.C_Sharp,B.Minor],[P.D_Sharp,B.Minor],[P.F_Sharp,B.Minor],[P.G_Sharp,B.Minor]],ae=t(48),re=t.n(ae),ie=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=Object(u.useState)(function(){var a,r=localStorage.getItem(e);return a=null===r||void 0===r||t?n instanceof Function?n():n:JSON.parse(r),window.localStorage.setItem(e,JSON.stringify(a)),a}),r=Object(m.a)(a,2),i=r[0],c=r[1];return[i,Object(u.useCallback)(function(n){c(function(t){var a=n instanceof Function?n(t):n;return window.localStorage.setItem(e,JSON.stringify(a)),a})},[e])]},ce=function(e,n){var t=ie(e,n),a=Object(m.a)(t,2),r=a[0],i=a[1];return[r,Object(u.useCallback)(function(){i(ee.a)},[i])]},oe=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){},t=Object(u.useState)(e),a=Object(m.a)(t,2),r=a[0],i=a[1];return[r,Object(u.useCallback)(function(){return i(function(e){var t=!e;return n(t),t})},[n])]},ue=function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];var a=Object(u.useRef)(n);Object(u.useEffect)(function(){var e=a.current,t=n;e.forEach(function(e,n){var a=t[n];if(a!==e){var r=ne.detailedDiff(e,a);console.log("Change at argument index: ".concat(n),r)}}),a.current=n},[n])};function se(){var e=Object(d.a)(["\n  margin-top: 10px;\n"]);return se=function(){return e},e}for(var le={0:"A",1:"Bb",2:"B",3:"C",4:"Db",5:"D",6:"Eb",7:"E",8:"F",9:"Gb",10:"G",11:"Ab"},fe=[],me=-4;me<4;me++)for(var de=0;de<12;de++){var be=440*Math.pow(2,me),ve=be/1200,ge=be*Math.pow(2,de/12),pe=me+4,he=le[de];fe.push({octave:pe,note:he,frequency:ge,centsPerOctave:ve})}var je=j.a.section(se()),Oe=function(){var e=oe(!1),n=Object(m.a)(e,2),t=n[0],a=n[1],r=Object(u.useState)(),i=Object(m.a)(r,2),c=i[0],o=i[1],l=Object(u.useState)(),f=Object(m.a)(l,2),d=f[0],b=f[1],v=Object(u.useState)(440),g=Object(m.a)(v,2),p=g[0],h=g[1],j=Object(u.useState)(),O=Object(m.a)(j,2),E=O[0],w=O[1];Object(u.useEffect)(function(){E||w(new AudioContext)},[t,E]),Object(u.useEffect)(function(){if(t&&E){b(E.sampleRate);var e,n=navigator.mediaDevices;if(n)return n.getUserMedia({audio:!0}).then(function(n){e=n;var t=E.createAnalyser();t.fftSize=8192,E.createMediaStreamSource(n).connect(t),o(t)}),function(){e.getAudioTracks().forEach(function(e){return e.stop()})}}},[t,E]),Object(u.useEffect)(function(){if(t&&c&&d){var e=function(){var e=c.frequencyBinCount,n=new Float32Array(e);c.getFloatFrequencyData(n);var t=n.reduce(function(e,n,t){return e[0]<n?[n,t]:e},[-1/0,-1]),a=Object(m.a)(t,2)[1],r=d/c.fftSize;h(r*a)};e();var n=setInterval(e,50);return function(){clearInterval(n)}}},[t,c,d]);var y=function(e){for(var n=0,t=0;t<fe.length;t++)if(fe[t].frequency>=e){n=t;break}var a=n+1,r=fe[n],i=fe[a],c=(r.frequency+i.frequency)/2,o=fe[a],u=o.frequency-e;e<c&&(o=fe[n]);var s=o.centsPerOctave*u;return Object.assign(o,{originalFrequency:e,difference:u,cents:s})}(p||0),S=y.octave,M=y.note,C=y.cents;return s.a.createElement(je,{className:"box has-text-centered"},s.a.createElement("div",{className:"is-size-1"},t?M+S:"Stopped"),s.a.createElement("div",null,t?s.a.createElement(s.a.Fragment,null,C.toFixed(2)," Cents ",C<0?"flat":"sharp"):"press start to tune"),s.a.createElement(x,{className:"is-right"},s.a.createElement(k,{on:t,isDanger:!0,offIsPrimary:!0,onClick:a},s.a.createElement(s.a.Fragment,null,"Stop"),s.a.createElement(s.a.Fragment,null,"Start"))))};function Ee(){var e=Object(d.a)(["\n  align-self: center;\n  margin: auto;\n  z-index: 1;\n  pointer-events: none;\n"]);return Ee=function(){return e},e}function we(){var e=Object(d.a)(["\n  width: 100px;\n  height: 100px;\n  border-radius: 100px;\n  position: absolute;\n  touch-action: none;\n"]);return we=function(){return e},e}function ke(){var e=Object(d.a)(["\n  margin: auto;\n  position: relative;\n  height: 300px;\n  width: 300px;\n  border-radius: 300px;\n  display: flex;\n  margin-bottom: 10px;\n"]);return ke=function(){return e},e}var ye=j.a.div(ke()),Se=j.a.div(we()),xe=j.a.div(Ee()),Me=function(e){var n=e.size,t=void 0===n?300:n,a=e.initialValue,r=e.addDiff,i=e.children,c=ie(F.Radians,a*(3*Math.PI)/2),o=Object(m.a)(c,2),l=o[0],f=o[1],d=Object(u.useRef)(Math.PI);Object(u.useEffect)(function(){d.current=l},[l]);var b=Object(u.useState)(!1),v=Object(m.a)(b,2),g=v[0],p=v[1],h=Object(u.useRef)(!1);Object(u.useEffect)(function(){h.current=g},[g]);var j=Object(u.useState)(0),O=Object(m.a)(j,2),E=O[0],w=O[1],k=Object(u.useRef)(0);Object(u.useEffect)(function(){k.current=E},[E]);var y=Object(u.useRef)(null),S=Object(u.useCallback)(function(e){p(!0),e.preventDefault()},[]),x=Object(u.useCallback)(function(e){p(!1)},[]),M=Object(u.useCallback)(function(e){Math.abs(k.current)<.2?w(function(n){return n+e}):(r(k.current>0?-1:1),w(0))},[r]),C=Object(u.useCallback)(function(e){var n=e.clientX,t=e.clientY,a=y.current.getBoundingClientRect(),r=a.left+a.width/2,i=-(a.top+a.height/2-t),c=-(r-n),o=Math.atan2(i,c),u=d.current-o;u<-Math.PI?u=-d.current-o:u>Math.PI&&(u=d.current- -o),0!==u&&M(u),o===d.current||f(o)},[M,f]),N=Object(u.useCallback)(function(e){h.current&&C(e)},[C]);Object(u.useEffect)(function(){return window.addEventListener("mouseup",x),window.addEventListener("mousemove",N),function(){window.removeEventListener("mouseup",x),window.removeEventListener("mousemove",N)}},[N,x]);var A=Object(u.useCallback)(function(e){var n=e.changedTouches[0];C(n)},[C]),I=s.a.useMemo(function(){return t/2+Math.sin(l)*(t/4)+Math.sin(l)*t/16-t/6},[l,t]),D=s.a.useMemo(function(){return t/2+Math.cos(l)*(t/4)+Math.cos(l)*t/16-t/6},[l,t]);return s.a.createElement(ye,{ref:y,className:"has-background-primary"},s.a.createElement(Se,{className:"has-background-info",onMouseDown:S,onTouchMove:A,style:{top:I,left:D}}),s.a.createElement(xe,null,i))},Ce=function(e){var n=e.appSettings,t=e.metronome,a=n.state.keepAwake,r=ce(F.ShowTuner,!1),i=Object(m.a)(r,2),c=i[0],o=i[1],l=function(){var e=Object(u.useState)(new re.a),n=Object(m.a)(e,1)[0];return{lock:Object(u.useCallback)(function(){n.enable()},[n]),release:Object(u.useCallback)(function(){n.disable()},[n])}}(),f=l.lock,d=l.release,b=s.a.useMemo(function(){return t.state.playing},[t.state.playing]),v=s.a.useMemo(function(){return t.state.bpm},[t.state.bpm]),p=s.a.useMemo(function(){return t.addBPM},[t.addBPM]),h=s.a.useMemo(function(){return t.setBPM},[t.setBPM]),j=s.a.useMemo(function(){return t.toggleStart},[t.toggleStart]);return Object(u.useEffect)(function(){a&&b?f():d()},[b,a,f,d]),s.a.createElement(s.a.Fragment,null,c&&s.a.createElement(Oe,null),s.a.createElement("section",{className:"section"},s.a.createElement(Me,{initialValue:v,addDiff:p},s.a.createElement("div",{className:"has-text-centered is-size-1"},v),s.a.createElement(g,{bpm:v}))),s.a.createElement(J,{metronome:t}),s.a.createElement("section",{className:"section"},s.a.createElement(x,{hasAddons:!0},s.a.createElement(k,{isLink:!0,offIsOutlined:!0,offIsLink:!0,on:c,onClick:o},"Tuner"),s.a.createElement(Z,{setBPM:h}),s.a.createElement(k,{on:b,offIsPrimary:!0,grow:!0,isOutlined:!0,isDanger:!0,onClick:j},s.a.createElement(s.a.Fragment,null,"Stop"),s.a.createElement(s.a.Fragment,null,"Start")))))};function Ne(){var e=Object(d.a)([""]);return Ne=function(){return e},e}var Ae,Ie=j.a.section(Ne()),De=function(e){var n=e.appSettings,t=n.state.keepAwake,a=n.toggleKeepAwake;return s.a.createElement(Ie,null,s.a.createElement("h2",{className:"is-size-4"},"Settings"),s.a.createElement("div",{className:"field"},s.a.createElement("div",{className:"control"},s.a.createElement("label",{className:"checkbox"},s.a.createElement("input",{style:{marginRight:"5px"},type:"checkbox",checked:t,onChange:a}),"Keep screen on while metronome is running."))))},Fe=window.AudioContext||window.webkitAudioContext||void 0,Be=t(84),Pe=t(86),_e=t(46);!function(e){e.NOT_STARTED="Not Started",e.LEARNING="Learning",e.KNOWN="Known"}(Ae||(Ae={}));var Te=function(e,n){return Re(e,n)[0]},Re=function(e,n){var t=[];return Object.entries(e).forEach(function(e){var a=Object(m.a)(e,2)[1];Object.entries(a).forEach(function(e){var a=Object(m.a)(e,2)[1];n(a)&&t.push(a)})}),t},Le=function(){var e={},n=function(n){var t,a=Object(m.a)(n,2),r=a[0],i=a[1],c=e[r];void 0===c&&(c={},e[r]=c),c[i]={scaleKey:t=n,pitch:t[0],mode:t[1],known:!1,learning:!1,bpm:60}},t=!0,a=!1,r=void 0;try{for(var i,c=te[Symbol.iterator]();!(t=(i=c.next()).done);t=!0){n(i.value)}}catch(o){a=!0,r=o}finally{try{t||null==c.return||c.return()}finally{if(a)throw r}}return e},ze=function(e){var n=Object(m.a)(e.scaleKey,2),t=n[0],a=n[1],r=e.learning,i=e.known,c=e.toggleLearning,o=e.toggleKnown;return s.a.createElement("div",{className:"is-grouped field has-addons"},s.a.createElement("div",{className:"is-size-5 control is-expanded"},t," ",a),s.a.createElement(x,null,s.a.createElement(k,{on:i,isInfo:!0,onClick:o},"Known"),s.a.createElement(k,{on:r,isLink:!0,onClick:c},"Learning")))};var Ke=function(e){var n=e.scalesDB,t=e.addBPM,a=e.reset,r=e.scaleMode,i=e.metronome,c=e.metronome.start,o=Object(u.useState)(function(){return function(e){var n,t,a;for(a=e.length-1;a>0;a--)n=Math.floor(Math.random()*(a+1)),t=e[a],e[a]=e[n],e[n]=t;return e}(Re(n,function(e){return r===Ae.LEARNING?e.learning:r===Ae.KNOWN&&e.known}).map(function(e){return e.scaleKey}))}),l=Object(m.a)(o,2),f=l[0],d=l[1],b=f[0]||[],v=Te(n,function(e){return e.mode===b[1]&&e.pitch===b[0]});Object(u.useEffect)(function(){void 0!==v&&c(v.bpm)},[v,c]);var g=f.length>1?"Next Scale":"Finish";if(0===f.length)return s.a.createElement("div",null,"No more scales");var p=v,h=p,j=h.mode,O=h.pitch,E=h.bpm;return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"box"},s.a.createElement("div",{style:{alignSelf:"center",fontWeight:"bold"},className:"control is-expanded is-size-5"},r),s.a.createElement("div",{style:{display:"flex",marginBottom:"5px"}},s.a.createElement("div",{style:{alignSelf:"center",marginRight:"10px"}},O," ",j," @ ",E,"bpm"),s.a.createElement(x,{grow:!0,hasAddons:!0},s.a.createElement(y,{isDanger:!0,isOutlined:!0,grow:!0,onClick:t(p,-10)},"-10"),s.a.createElement(y,{isDanger:!0,isOutlined:!0,grow:!0,onClick:t(p,-1)},"-"),s.a.createElement(y,{isPrimary:!0,isOutlined:!0,grow:!0,onClick:t(p,1)},"+"),s.a.createElement(y,{isPrimary:!0,isOutlined:!0,grow:!0,onClick:t(p,10)},"+10"))),s.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},s.a.createElement(y,{isDanger:!0,isOutlined:!0,onClick:a},"Stop"),s.a.createElement(y,{isPrimary:!0,onClick:function(){d(function(e){var n=e.slice(1);return 0===n.length&&a(),n})}},g))),s.a.createElement(J,{metronome:i}))},Ge=function(e){var n=e.metronome,t=n.stop,a=ie(F.ScalesDB,Le),r=Object(m.a)(a,2),i=r[0],c=r[1],o=Object(u.useState)(Ae.NOT_STARTED),l=Object(m.a)(o,2),f=l[0],d=l[1];Object(u.useEffect)(function(){f===Ae.NOT_STARTED&&t()},[f,t]);var b=function(e){var n=e.pitch,t=e.mode;return function(){c(Be.a(Pe.a([n,t,"learning"]),ee.a))}},v=function(e){var n=e.pitch,t=e.mode;return function(){c(Be.a(Pe.a([n,t,"known"]),ee.a))}},g=ce(F.ShowKnown,!1),p=Object(m.a)(g,2),h=p[0],j=p[1];return s.a.createElement("div",{style:{marginTop:"10px"}},f===Ae.NOT_STARTED?s.a.createElement("div",{style:{marginBottom:"5px"}},s.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},s.a.createElement("div",{style:{alignSelf:"center",fontWeight:"bold"},className:"control is-expanded is-size-5"},"Scales"),s.a.createElement(x,null,s.a.createElement(y,{onClick:function(){return d(Ae.KNOWN)},disabled:void 0===Te(i,function(e){return e.known}),className:"is-info is-outlined"},"Start Known"),s.a.createElement(y,{onClick:function(){return d(Ae.LEARNING)},disabled:void 0===Te(i,function(e){return e.learning}),className:"is-link is-outlined"},"Start Learning"))),s.a.createElement("hr",null),s.a.createElement(x,null,s.a.createElement(y,{onClick:j,className:"".concat(h?"is-primary is-outlined":"is-danger")},h?"Hide Known":"Show Known")),Re(i,function(e){return e.mode===B.Major&&(!!h||!1===e.known)}).map(function(e){return s.a.createElement(ze,Object.assign({key:"".concat(e.pitch,"-").concat(e.mode)},e,{toggleLearning:b(e),toggleKnown:v(e)}))}),s.a.createElement("hr",null),Re(i,function(e){return e.mode===B.Minor&&(!!h||!1===e.known)}).map(function(e){return s.a.createElement(ze,Object.assign({key:"".concat(e.pitch,"-").concat(e.mode)},e,{toggleLearning:b(e),toggleKnown:v(e)}))})):s.a.createElement(Ke,{scaleMode:f,addBPM:function(e,n){var t=e.pitch,a=e.mode;return function(){c(Be.a(Pe.a([t,a,"bpm"]),_e.a(n)))}},scalesDB:i,reset:function(){return d(Ae.NOT_STARTED)},metronome:n}))},We=t(28),qe=t(15),Je=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Ue(e){if("serviceWorker"in navigator){if(new URL("/metronome",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var n="".concat("/metronome","/service-worker.js");Je?(!function(e,n){fetch(e).then(function(t){var a=t.headers.get("content-type");404===t.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):Ve(e,n)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(n,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):Ve(n,e)})}}function Ve(e,n){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;null!=t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),n&&n.onUpdate&&n.onUpdate(e)):(console.log("Content is cached for offline use."),n&&n.onSuccess&&n.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}function He(){var e=Object(d.a)(["\n  position: absolute;\n  max-width: ",";\n  width: 95%;\n  margin-top: 10px;\n  left: 0;\n  right: 0;\n  margin-left: auto !important;\n  margin-right: auto !important;\n  z-index: 10;\n  display: flex !important;\n  justify-content: space-between;\n  animation: ease-in 1s ",";\n"]);return He=function(){return e},e}function Ye(){var e=Object(d.a)(["\n    from {\n      opacity: 0;\n    }\n    to {\n      opacity: 1;\n    }\n"]);return Ye=function(){return e},e}var Xe=Object(j.b)(Ye()),$e=j.a.section(He(),"40em",Xe),Qe=!1,Ze=function(){var e=Object(u.useState)(!1),n=Object(m.a)(e,2),t=n[0],a=n[1],r=s.a.useCallback(function(){window.location.reload()},[]),i=s.a.useCallback(function(){a(!1)},[]);return Object(u.useEffect)(function(){Qe||Ue({onUpdate:function(){a(!0)}}),Qe=!0},[]),s.a.createElement(s.a.Fragment,null,t&&s.a.createElement($e,{className:"box"},s.a.createElement("span",null,"An Update is Available!"),s.a.createElement(x,null,s.a.createElement(y,{isPrimary:!0,isOutlined:!0,onClick:r},"Refresh"),s.a.createElement(y,{isDanger:!0,isOutlined:!0,onClick:i},"x"))))},en=function(){return{keepAwake:!1}},nn=t(53),tn=t(85),an=t(49),rn=t.n(an);var cn=t(70),on=function(e,n){var t=n.time,a=n.gain,r=n.buffer,i=n.pitch,c=n.currentBeat,o=n.divisionIndex,u=0===c&&0===o,s=e.createBufferSource();s.buffer=r,s.detune.value=u?0:-i;var l=e.createGain();l.gain.value=u?1:a,s.connect(l),l.connect(e.destination),s.start(t)},un=.1,sn=function(e,n,t){var a=n.playing,r=function(e,n){var t=Object(u.useState)(),a=Object(m.a)(t,2),r=a[0],i=a[1];return Object(u.useEffect)(function(){void 0!==e&&fetch(n).then(function(e){return e.arrayBuffer()}).then(function(n){return e.decodeAudioData(n)}).then(i)},[n,e]),r}(e,cn),i=Object(u.useRef)(0),c=a?150:void 0,o=Object(u.useRef)(n);Object(u.useEffect)(function(){o.current=n},[n]);var s=Object(u.useState)(0),l=Object(m.a)(s,2),f=l[0],d=l[1];Object(u.useEffect)(function(){n.playing||d(0)},[n.playing]);var b=Object(u.useRef)(f);Object(u.useEffect)(function(){b.current=f},[f]);var v=function(){d(function(e){return(e+1)%o.current.signature.numerator.size})},g=Object(u.useCallback)(function(e){t(function(n){var t=n.getIn([e.currentBeat,e.divisions,e.divisionIndex]);return void 0===t?n:n.setIn([e.currentBeat,e.divisions,e.divisionIndex],!t)})},[t]),p=Object(u.useCallback)(function(e,n){!function(e,n,t){setTimeout(t,1e3*(n-e.currentTime))}(e,n.time,function(){o.current.playing&&g(n)})},[g]);Object(u.useEffect)(function(){if(void 0!==c&&void 0!==e&&void 0!==r){var n=new rn.a,t=e.currentTime+.3;i.current=t;var a=function(){var t=o.current.signature.numerator,a=Math.min(b.current,t.size-1),u=t.get(a);!function(e,n,t,a,r,i,c,o,u){var s=60/e.bpm,l=t;if(n.current<r+i){var f=function(e,n,t,a,r){var i=[];return t.filter(function(e){return e}).forEach(function(t,c){for(var o=n/c,u=0;u<c;u++){var s={time:e+u*o,divisionLength:o,pitch:220,gain:.5,buffer:a,divisions:c,divisionIndex:u,currentBeat:r};i.push(s)}}),i.sort(function(e,n){return e.time-n.time}),i}(n.current,s,l,c,a);o.push.apply(o,Object(nn.a)(f)),n.current+=s,u()}}(o.current,i,u,b.current,e.currentTime,.3,r,n,v),function(e,n,t,a){for(var r=t.currentTime+n+un;e.peekFront()&&e.peekFront().time<r;){var i=e.shift();0===i.divisionIndex&&1!==i.divisions||on(t,i),a(t,i)}}(n,c/1e3,e,p)};a();var u=setInterval(a,c);return function(){clearInterval(u)}}},[c,r,e,t,g,p])},ln=function(e){return M.a(e.map(function(e){return e.reduce(function(e,n,t){return n?e.set(t,M.a(h.a(0,t).map(function(){return!0}))):e},M.b())}))},fn=function(e){return tn.a(10,250,e)},mn=M.b().set(1,!0),dn=function(e){var n=Object(u.useState)(!1),t=Object(m.a)(n,2),a=t[0],r=t[1],i=function(e,n){var t=Object(m.a)(e,2),a=t[0],r=t[1],i=Object(u.useCallback)(function(e){r(function(t){return n(e instanceof Function?e(t):e)})},[n,r]);return ue(n,r),[a,i]}(ie(F.BPM,90),fn),c=Object(m.a)(i,2),o=c[0],l=c[1],f=Object(u.useState)({denominator:4,numerator:M.a([mn,mn,mn])}),d=Object(m.a)(f,2),b=d[0],v=d[1],g=Object(u.useState)(ln(b.numerator)),p=Object(m.a)(g,2),h=p[0],j=p[1],O={bpm:o,playing:a,signature:b,activeDivisions:h},E=b.numerator,w=Object(u.useRef)(o);Object(u.useEffect)(function(){w.current=o},[o]),Object(u.useEffect)(function(){j(ln(E))},[E,b,j]),Object(u.useEffect)(function(){a||(j(ln(E)),setTimeout(function(){j(ln(E))},300))},[a,E,j]),sn(e,O,j);var k=s.a.useCallback(function(e){l(_e.a(e))},[l]);return{toggleStart:s.a.useCallback(function(){return r(ee.a)},[r]),setSignature:v,start:Object(u.useCallback)(function(e){void 0!==e&&l(e),r(!0)},[r,l]),stop:Object(u.useCallback)(function(){r(!1)},[r]),setBPM:l,addBPM:k,state:O}},bn=t(32),vn=t(21);function gn(){var e=Object(d.a)(["\n  display: flex;\n  flex-direction: column;\n  align-items: flex-end;\n  justify-content: flex-end;\n  margin-top: 5px;\n"]);return gn=function(){return e},e}function pn(){var e=Object(d.a)(["\n  max-width: ",";\n  margin: 0 auto;\n  display: flex;\n  flex-direction: column;\n  > * {\n    margin-left: 10px;\n    margin-right: 10px;\n  }\n"]);return pn=function(){return e},e}function hn(){var e=Object(d.a)(["\n  margin-left: 5px;\n"]);return hn=function(){return e},e}function jn(){var e=Object(d.a)([""]);return jn=function(){return e},e}function On(){var e=Object(d.a)(["\n  display: flex;\n  flex-direction: column;\n  align-items: flex-end;\n  padding-right: 10px;\n  align-self: flex-end;\n  > a {\n    animation: ease-in 0.3s ",";\n    font-size: 1.5rem;\n  }\n"]);return On=function(){return e},e}function En(){var e=Object(d.a)(["\n  from {\nfont-size: 0px;\n  }\n"]);return En=function(){return e},e}function wn(){var e=Object(d.a)(["\n  display: flex;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  padding-left: 10px;\n  padding-right: 10px;\n  justify-content: space-between;\n  > h2 {\n    margin: 0 !important;\n  }\n"]);return wn=function(){return e},e}function kn(){var e=Object(d.a)(["\n  align-self: center;\n"]);return kn=function(){return e},e}function yn(){var e=Object(d.a)(["\n  margin-bottom: 10px;\n  margin-left: 0px !important;\n  margin-right: 0px !important;\n  display: flex;\n  flex-direction: column;\n"]);return yn=function(){return e},e}var Sn=j.a.section(yn()),xn=j.a.span(kn()),Mn=j.a.section(wn()),Cn=Object(j.b)(En()),Nn=j.a.nav(On(),Cn),An=Object(j.a)(We.b)(jn()),In=Object(j.a)(bn.a)(hn()),Dn=function(){var e=oe(!1),n=Object(m.a)(e,2),t=n[0],a=n[1];return s.a.createElement(Sn,null,s.a.createElement(Mn,{className:"has-background-primary has-text-light"},s.a.createElement(We.b,{to:"/",className:"has-text-white"},s.a.createElement("h2",{className:"is-size-4 is-bold"},"(mjh)tronome")),s.a.createElement(xn,{onClick:a},s.a.createElement(bn.a,{icon:vn.a,size:"2x"}))),t&&s.a.createElement(Nn,{onClick:a},s.a.createElement(An,{to:"/"},"Home",s.a.createElement(In,{icon:vn.c})),s.a.createElement(An,{to:"/scales"},"Scales",s.a.createElement(In,{icon:vn.d})),s.a.createElement(An,{to:"/settings"},"Settings",s.a.createElement(In,{icon:vn.b}))))},Fn=j.a.div(pn(),"40em"),Bn=j.a.div(gn()),Pn=function(e){var n=e.children;return s.a.createElement(Fn,null,s.a.createElement(Ze,null),s.a.createElement(Dn,null),n,s.a.createElement(Bn,null,"v".concat("1.0.17")))},_n=function(){var e=function(){var e=ie(F.AppSettings,en),n=Object(m.a)(e,2),t=n[0],a=n[1];return{state:t,toggleKeepAwake:s.a.useCallback(function(){a(function(e){return Object(p.a)({},e,{keepAwake:!e.keepAwake})})},[a])}}(),n=function(e){var n=Object(u.useState)(e),t=Object(m.a)(n,2),a=t[0],r=t[1],i=Object(u.useCallback)(function(e){a||r(e)},[a]);return{value:a,init:i}}(),t=n.value,a=n.init,r=s.a.useState(!0),i=Object(m.a)(r,2),c=i[0],o=i[1],l=dn(t),f=l.state.playing;return s.a.useEffect(function(){void 0===Fe?o(!1):f&&a(new Fe)},[f,a]),s.a.createElement(We.a,{basename:"/metronome"},s.a.createElement(Pn,null,!c&&s.a.createElement("div",null,"Your browser doesn't support the audioContext api, so this will not work. Sorry :("),s.a.createElement(qe.a,{exact:!0,path:"/",render:function(){return s.a.createElement(Ce,{metronome:l,appSettings:e})}}),s.a.createElement(qe.a,{exact:!0,path:"/scales",render:function(){return s.a.createElement(Ge,{metronome:l})}}),s.a.createElement(qe.a,{exact:!0,path:"/settings",render:function(){return s.a.createElement(De,{appSettings:e})}})))},Tn=(t(78),function(e){function n(e){var t;return Object(a.a)(this,n),(t=Object(i.a)(this,Object(c.a)(n).call(this,e))).state={error:void 0},t}return Object(o.a)(n,e),Object(r.a)(n,[{key:"render",value:function(){return this.state.error?s.a.createElement("div",null,s.a.createElement("h1",null,"Something went wrong"),s.a.createElement("hr",null),s.a.createElement("code",null,this.state.error instanceof Error&&this.state.error.name),s.a.createElement("hr",null),s.a.createElement("code",null,this.state.error instanceof Error&&this.state.error.message),s.a.createElement("hr",null),s.a.createElement("code",null,this.state.error instanceof Error&&this.state.error.stack),s.a.createElement("hr",null),s.a.createElement("code",null,JSON.stringify(this.state.error,void 0,"  "))):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{error:e}}}]),n}(s.a.Component));f.a.render(s.a.createElement(Tn,null,s.a.createElement(_n,null)),document.getElementById("root"))}},[[57,1,2]]]);
//# sourceMappingURL=main.f3a4ff60.chunk.js.map