(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{65:function(e,n,t){e.exports=t(89)},80:function(e,n,t){e.exports=t.p+"static/media/click.b48ed3e5.wav"},88:function(e,n,t){},89:function(e,n,t){"use strict";t.r(n);var a,r=t(51),i=t(52),o=t(62),c=t(53),u=t(63),s=t(0),l=t.n(s),f=t(23),m=t.n(f),d=t(1),g=t(3),v=t(9),h=t(92),p=t(10),b=t(31);!function(e){e[e.SetActiveBeats=0]="SetActiveBeats",e[e.SetMetronomeState=1]="SetMetronomeState",e[e.SetSettings=2]="SetSettings"}(a||(a={}));var E,w,S,k={isActive:!1,isAccented:!1},j=v.List(),O=v.Map();v.List();!function(e){e.EnabledDivisions="@mjh/k/enabled-divisions-0",e.AppSettings="@mjh/k/app-settings-0",e.SignatureDivisions="@mjh/k/signature-divisions-3",e.ShowKnown="@mjh/k/show-known-2",e.ScalesDB="@mjh/k/scales-db-2",e.ActiveBeats="@mjh/k/active-beats-2",e.TimeSignature="@mjh/k/signature-3",e.BPM="@mjh/k/bpm-0",e.KnownScales="@mjh/k/known-scales-0",e.ShowScales="@mjh/k/show-scales-0",e.ShowTuner="@mjh/k/show-tuner-0",e.ShowDial="@mjh/k/show-dial-0",e.Radians="@mjh/k/radians-0",e.WakeLock="@mjh/k/wake-lock-0"}(E||(E={})),function(e){e.Major="Major",e.Minor="Minor"}(w||(w={})),function(e){e.A="A",e.B="B",e.C="C",e.D="D",e.E="E",e.F="F",e.G="G",e.A_Flat="Ab",e.B_Flat="Bb",e.C_Flat="Cb",e.D_Flat="Db",e.E_Flat="Eb",e.F_Flat="Fb",e.G_Flat="Gb",e.A_Sharp="A#",e.B_Sharp="B#",e.C_Sharp="C#",e.D_Sharp="D#",e.E_Sharp="E#",e.F_Sharp="F#",e.G_Sharp="G#"}(S||(S={}));var x=[[S.A,w.Major],[S.B,w.Major],[S.C,w.Major],[S.D,w.Major],[S.E,w.Major],[S.F,w.Major],[S.G,w.Major],[S.A_Flat,w.Major],[S.B_Flat,w.Major],[S.C_Flat,w.Major],[S.D_Flat,w.Major],[S.E_Flat,w.Major],[S.G_Flat,w.Major],[S.C_Sharp,w.Major],[S.F_Sharp,w.Major],[S.A,w.Minor],[S.B,w.Minor],[S.C,w.Minor],[S.D,w.Minor],[S.E,w.Minor],[S.F,w.Minor],[S.G,w.Minor],[S.A_Flat,w.Minor],[S.B_Flat,w.Minor],[S.E_Flat,w.Minor],[S.A_Sharp,w.Minor],[S.C_Sharp,w.Minor],[S.D_Sharp,w.Minor],[S.F_Sharp,w.Minor],[S.G_Sharp,w.Minor]],y=t(34),M=t(91),C=t(61),A=t(100),N=t(90),I=(t(55),window.AudioContext||window.webkitAudioContext||void 0),D=t(21),F=t(56),L=t.n(F),B=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=l.a.useState(function(){var a,r=localStorage.getItem(e);return a=null===r||void 0===r||t?n instanceof Function?n():n:D.fromJSON(r),window.localStorage.setItem(e,D.toJSON(a)),a}),r=Object(d.a)(a,2),i=r[0],o=r[1];return[i,l.a.useCallback(function(n){o(function(t){var a=n instanceof Function?n(t):n;return window.localStorage.setItem(e,D.toJSON(a)),a})},[e])]},T=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){},t=l.a.useState(e),a=Object(d.a)(t,2),r=a[0],i=a[1];return[r,l.a.useCallback(function(){return i(function(e){var t=!e;return n(t),t})},[n])]},_=t(57),P=t.n(_);var z=function(e,n){var t=localStorage.getItem(e);return null===t?n:D.fromJSON(t)},R=function(e,n){localStorage.setItem(e,D.toJSON(n))},K=t(80),G=function(e,n){var t=n.time,a=n.gain,r=n.buffer,i=e.createBufferSource();i.buffer=r;var o=e.createGain();o.gain.value=a,i.connect(o),o.connect(e.destination),i.start(t)},W=-1,q=function(e,n,t,a,r,i,o,c,u){var s=60/e,l=t;if(n.current<r+i){var f=function(e,n,t,a,r){var i=[],o=pe.getState().activeBeats;return t.filter(function(e){return e}).forEach(function(t,c){for(var u=n/c,s=0;s<c;s++){var l=o.get(r,O).get(c,j).get(s,k).isAccented,f={time:e+s*u,divisionLength:u,pitch:220,gain:l?1:.1,buffer:a,divisions:c,divisionIndex:s,currentBeat:r,isAccented:l};i.push(f)}}),i.sort(function(e,n){return e.time-n.time}),i}(n.current,s,l,o,a);c.push.apply(c,Object(C.a)(f)),n.current+=s,u()}},J=.1,U=function(e){var n=be(function(e){return e.metronomeState.playing}),t=function(e,n){var t=l.a.useState(),a=Object(d.a)(t,2),r=a[0],i=a[1];return l.a.useEffect(function(){void 0!==e&&"not-supported"!==e&&"pending"!==e&&fetch(n).then(function(e){return e.arrayBuffer()}).then(function(n){return e.decodeAudioData(n)}).then(i)},[n,e]),r}(e,K),a=l.a.useRef(0),r=n?150:void 0,i=l.a.useRef(0);l.a.useEffect(function(){n||(i.current=0)},[n]);var o=l.a.useCallback(function(){var e=i.current;i.current=(e+1)%pe.getState().metronomeState.signature.numerator.size},[]),c=l.a.useCallback(function(e,n){!function(e,n,t){setTimeout(t,1e3*(n-e.currentTime))}(e,n.time,function(){pe.getState().metronomeState.playing&&Q(n)})},[]);l.a.useEffect(function(){if(void 0!==r&&void 0!==e&&"not-supported"!==e&&"pending"!==e&&void 0!==t){var n=new P.a,u=e.currentTime+.3;a.current=u;var s=function(){var u=pe.getState().metronomeState.signature.numerator,s=Math.min(i.current,u.size-1),l=u.get(s);void 0!==l&&q(pe.getState().metronomeState.bpm,a,l,i.current,e.currentTime,.3,t,n,o),function(e,n,t,a){for(var r=t.currentTime+n+J;e.peekFront()&&e.peekFront().time<r;){var i=e.shift();(i.time!==W||i.isAccented)&&G(t,i),W=i.time,a(t,i)}}(n,r/1e3,e,c)};s();var l=setInterval(s,r);return function(){clearInterval(l)}}},[r,t,e,c,o])},H=function(e){return v.List(e.map(function(e){return e.reduce(function(e,n,t){return n?e.set(t,v.List(A.a(0,t).map(function(){return{isActive:!0,isAccented:!1}}))):e},v.Map())}))},V=function(e){var n=be(function(e){return e.metronomeState.playing});l.a.useEffect(function(){if(n)return function(){oe()}},[n]);var t=be(function(e){return e.metronomeState.signature.numerator});l.a.useEffect(function(){ae()},[t]),l.a.useEffect(function(){n||ae()},[n]),l.a.useEffect(function(){"pending"!==e&&void 0!==e&&X(!1)},[e]),U(e)},X=function(e){de(function(n){return Object(p.a)({},n,{pending:fe(e,n.pending)})})},Y=function(e){de(function(n){var t=le(fe(e,n.bpm));return R(E.BPM,t),Object(p.a)({},n,{bpm:t})})},$=function(e){de(function(n){var t=fe(e,n.signature);return R(E.TimeSignature,t),Object(p.a)({},n,{signature:t})})},Q=function(e){me(function(n){return void 0===n.getIn([e.currentBeat,e.divisions,e.divisionIndex])?n:n.update(e.currentBeat,function(n){return n.update(e.divisions,function(n){return n.update(e.divisionIndex,function(e){return Object(p.a)({},e,{isActive:!e.isActive})})})})})},Z=function(e,n,t,a){me(function(r){return r.update(e,function(e){return e.update(n,function(e){return e.update(t,function(e){return Object(p.a)({},e,{isAccented:fe(a,e.isAccented)})})})})})},ee=function(){ue(function(e){return!e})},ne=function(){se(function(e){return!e})},te=function(e){Y(function(n){return n+e})},ae=function(){me(H(pe.getState().metronomeState.signature.numerator))},re=function(){ce(function(e){return!e})},ie=function(e){void 0!==e&&Y(e),ce(!0)},oe=function(){ce(!1)},ce=function(e){de(function(n){return Object(p.a)({},n,{playing:fe(e,n.playing)})})},ue=function(e){ge(function(n){return Object(p.a)({},n,{keepAwake:fe(e,n.keepAwake)})})},se=function(e){var n=e instanceof Function?e(pe.getState().settings.showTuner):e;ge(function(e){return Object(p.a)({},e,{showTuner:n})})},le=function(e){return M.a(10,250,e)},fe=function(e,n){return e instanceof Function?e(n):e},me=function(e){pe.dispatch({type:a.SetActiveBeats,action:e})},de=function(e){pe.dispatch({type:a.SetMetronomeState,action:e})},ge=function(e){var n=e instanceof Function?e(pe.getState().settings):e;R(E.AppSettings,n),pe.dispatch({type:a.SetSettings,action:n})},ve=function(){return v.Map().set(1,!0)},he=function(){var e=z(E.TimeSignature,{denominator:4,numerator:v.List([ve(),ve(),ve(),ve()])});return{activeBeats:H(e.numerator),settings:z(E.AppSettings,{keepAwake:!1,showTuner:!1}),metronomeState:{ready:!1,pending:!0,bpm:z(E.BPM,60),playing:!1,signature:e}}},pe=b.b(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:he(),n=arguments.length>1?arguments[1]:void 0;switch(n.type){case a.SetActiveBeats:return Object.assign(e,{activeBeats:fe(n.action,e.activeBeats)});case a.SetMetronomeState:return Object(p.a)({},e,{metronomeState:fe(n.action,e.metronomeState)});case a.SetSettings:return Object(p.a)({},e,{settings:fe(n.action,e.settings)});default:return n.type.startsWith("@@redux")||console.log(n,"was not handled"),e}}),be=function(e,n){return y.b(e,n)},Ee=v.List([{name:"Larghissimo",low:0,high:24},{name:"Grave",low:25,high:45},{name:"Largo",low:40,high:60},{name:"Lento",low:45,high:60},{name:"Larghetto",low:60,high:66},{name:"Adagio",low:66,high:76},{name:"Andante",low:76,high:108},{name:"Marcia moderato",low:83,high:85},{name:"Andante moderato",low:92,high:112},{name:"Moderato",low:108,high:120},{name:"Allegro",low:120,high:156},{name:"Vivace",low:156,high:176},{name:"Vivacissimo",low:172,high:176},{name:"Allegrissimo",low:172,high:176},{name:"Presto",low:168,high:200},{name:"Prestissimo",low:200,high:250}]),we=h.a(function(e){return""+e},function(e){return Ee.filter(function(n){var t,a,r=n.high,i=n.low;return t=r,(a=e)>=i&&a<=t})}),Se=l.a.memo(function(e){var n=e.name,t=e.low,a=e.high;return l.a.createElement("div",{className:"has-text-centered"},n," - ",t," - ",a)}),ke=l.a.memo(function(e){var n=e.bpm,t=we(n);return l.a.createElement("div",{style:{minHeight:"6.5em"}},t.map(function(e){var n=e.name,t=e.high,a=e.low;return l.a.createElement(Se,{key:"marking-".concat(n),name:n,high:t,low:a})}))},function(e,n){var t=e.bpm,a=n.bpm;return we(t).equals(we(a))}),je=function(){var e=be(function(e){return e.metronomeState.bpm});return l.a.createElement(ke,{bpm:e})},Oe=t(4),xe=t(38),ye=t(93),Me=t(40),Ce=t.n(Me);function Ae(){var e=Object(g.a)(["\n  &:not(:last-child) {\n    margin-bottom: 0 !important;\n  }\n"]);return Ae=function(){return e},e}var Ne=["offIsPrimary","offIsLink","offIsDanger","offIsInfo","offIsSuccess","offIsOutlined"],Ie=["isPrimary","isLink","isDanger","isInfo","isSuccess","isOutlined"],De=function(e){var n=e.on,t=Object(xe.a)(e,["on"]),a=l.a.useMemo(function(){var e=n?Ne:Ie;return ye.a(e,t)},[n,t]),r=l.a.useMemo(function(){return t.children instanceof Array&&2===t.children.length?n?t.children[0]:t.children[1]:t.children},[t,n]);return l.a.createElement(Fe,a,r)},Fe=function(e){var n=e.isPrimary,t=e.isDanger,a=e.isLink,r=e.isInfo,i=e.isSuccess,o=e.isOutlined,c=e.offIsPrimary,u=e.offIsDanger,s=e.offIsLink,f=e.offIsInfo,m=e.offIsSuccess,d=e.offIsOutlined,g=e.grow,v=e.className,h=Object(xe.a)(e,["isPrimary","isDanger","isLink","isInfo","isSuccess","isOutlined","offIsPrimary","offIsDanger","offIsLink","offIsInfo","offIsSuccess","offIsOutlined","grow","className"]),b=l.a.useMemo(function(){return Ce()("button",v,{"is-primary":n||c,"is-link":a||s,"is-danger":t||u,"is-info":r||f,"is-success":i||m,"is-outlined":o||d,"is-grow":g})},[v,g,n,c,a,s,t,u,r,f,o,d,i,m]),E=l.a.useMemo(function(){return Object(p.a)({},h,{className:b})},[h,b]);return l.a.createElement("button",E,h.children)},Le=Oe.a.div(Ae()),Be=function(e){var n=e.children,t=e.hasAddons,a=e.ref,r=e.className,i=e.grow,o=Object(xe.a)(e,["children","hasAddons","ref","className","grow"]),c=l.a.useMemo(function(){return Ce()(r,"buttons",{"has-addons":t,"is-grow":i})},[t,i,r]);return l.a.createElement(Le,Object.assign({ref:a},o,{className:c}),n)};function Te(){var e=Object(g.a)(["\n  display: flex;\n  flex-grow: 1;\n  margin-bottom: 10px;\n"]);return Te=function(){return e},e}function _e(){var e=Object(g.a)(["\n  display: flex;\n  flex-grow: 1;\n  flex-direction: column;\n"]);return _e=function(){return e},e}function Pe(){var e=Object(g.a)(["\n  display: flex;\n  flex-grow: 1;\n"]);return Pe=function(){return e},e}function ze(){var e=Object(g.a)(["\n  width: 1px;\n  margin-left: 1px;\n  margin-right: 1px;\n  flex-grow: 1;\n  text-align: center;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n"]);return ze=function(){return e},e}function Re(){var e=Object(g.a)(["\n  display: flex;\n  align-items: baseline;\n  > button {\n    margin-right: 5px;\n  }\n  > div {\n    margin-right: 5px;\n  }\n"]);return Re=function(){return e},e}var Ke=l.a.memo(Oe.a.section(Re())),Ge=l.a.memo(function(e){var n=e.uiEnabledDivisions,t=e.toggleDivisionOption,a=e.clearDivisions,r=be(function(e){return e.activeBeats.getIn([0,1,0],k).isAccented}),i=l.a.useState(r),o=Object(d.a)(i,2),c=o[0],u=o[1];return l.a.useEffect(function(){r!==c&&u(r)},[r]),l.a.useEffect(function(){Z(0,1,0,c)},[c]),l.a.createElement(Ke,null,l.a.createElement("div",{className:"is-size-5"},"Division"),l.a.createElement(De,{isLink:!0,on:c,onClick:function(){return u(function(e){return!e})}},">"),l.a.createElement(Be,{hasAddons:!0,grow:!0,style:{marginRight:"5px"}},[2,3,4,5,6].map(function(e){var a=n.get(e);return l.a.createElement(De,{grow:!0,on:a,isPrimary:!0,key:"division-options-".concat(e),onClick:function(){return t(e)}},e)})),l.a.createElement(Fe,{grow:!0,isDanger:!0,isOutlined:!0,onClick:a},"Clear"))}),We=l.a.memo(function(e){var n=e.setCurrentNumerator,t=e.currentNumerator;return l.a.createElement("section",{className:"section buttons is-centered"},[1,2,3,4,5].map(function(e){var a=t===e;return l.a.createElement(De,{key:"numerator-button-".concat(e),on:a,isPrimary:!0,isOutlined:!0,grow:!0,onClick:a?function(){}:function(){return n(e)}},l.a.createElement(l.a.Fragment,null,e,"/4"))}))}),qe=l.a.memo(Oe.a.div(ze())),Je=l.a.memo(Oe.a.div(Pe())),Ue=l.a.memo(Oe.a.div(_e())),He=l.a.memo(Oe.a.div(Te())),Ve=l.a.memo(function(e){var n=e.height,t=e.beatIndex,a=e.division,r=e.divisionIndex,i=be(function(e){return e.activeBeats.get(t).get(a).get(r)}),o=l.a.useMemo(function(){return i.isActive?"has-background-primary":"has-background-link"},[i.isActive]);return l.a.createElement(qe,{className:o,onClick:function(){return function(e,n,t){Z(e,n,t,function(e){return!e})}(t,a,r)},style:{height:n,marginTop:1}},l.a.createElement("div",null,i.isAccented&&">"))}),Xe=l.a.memo(function(e){var n=e.height,t=e.beatIndex,a=e.division;return l.a.createElement(Je,null,A.a(0,a).map(function(e){return l.a.createElement(Ve,{key:"".concat(t,"-").concat(a,"-").concat(e),height:n,beatIndex:t,division:a,divisionIndex:e})}))}),Ye=l.a.memo(function(e){var n=e.beatIndex,t=be(function(e){return e.activeBeats.get(n).keySeq()},function(e,n){return e.equals(n)});return l.a.createElement(Ue,{key:"".concat(n)},t.map(function(e){return l.a.createElement(Xe,{height:70/t.size,key:"".concat(n,"-").concat(e),beatIndex:n,division:e})}))}),$e=l.a.memo(function(){var e=be(function(e){return e.activeBeats.size});return l.a.createElement(He,null,A.a(0,e).map(function(e){return l.a.createElement(Ye,{key:e,beatIndex:e})}))}),Qe=function(){var e=$,n=be(function(e){return e.metronomeState.signature.numerator}),t=l.a.useState(!1),a=Object(d.a)(t,2),r=a[0],i=a[1],o=B(E.EnabledDivisions,v.Map().set(1,!0)),c=Object(d.a)(o,2),u=c[0],s=c[1];l.a.useEffect(function(){r&&e(function(e){return Object(p.a)({},e,{numerator:v.List(A.a(0,e.numerator.size).map(function(){return u}))})})},[u,r,e]);var f=l.a.useCallback(function(e){i(!0),s(function(n){var t=n.get(e),a=void 0===t||!t;return n.set(e,a)})},[s]),m=l.a.useCallback(function(){s(v.Map().set(1,!0))},[s]),g=l.a.useState(n.size),h=Object(d.a)(g,2),b=h[0],w=h[1];return l.a.useEffect(function(){e(function(e){return Object(p.a)({},e,{numerator:v.List(A.a(0,b).map(function(){return u}))})})},[b,e,u]),l.a.createElement(l.a.Fragment,null,l.a.createElement($e,null),l.a.createElement(Ge,{uiEnabledDivisions:u,toggleDivisionOption:f,clearDivisions:m}),l.a.createElement(We,{currentNumerator:n.size,setCurrentNumerator:w}))},Ze=t(97),en=t(99),nn=t(96),tn=t(98),an=t(94),rn=t(95),on=Ze.a(function(e){return en.a(2,e)},nn.a(function(e){var n=Object(d.a)(e,2),t=n[0];return n[1]-t}),tn.a,an.a(6e4),Math.trunc),cn=function(){var e=l.a.useState([]),n=Object(d.a)(e,2),t=n[0],a=n[1];return l.a.createElement(Fe,{isLink:!0,isOutlined:!0,onClick:function(){var e=performance.now(),n=rn.a(e,t).filter(function(n){return e-n<3e3});if(n.length>1){var r=on(n);Y(r)}a(n)}},"Tap In")};function un(){var e=Object(g.a)(["\n  margin-top: 10px;\n  position: relative;\n"]);return un=function(){return e},e}function sn(){var e=Object(g.a)(["\n  position: absolute;\n  top: 10px;\n  right: 10px;\n  text-align: unset !important;\n"]);return sn=function(){return e},e}for(var ln={0:"A",1:"Bb",2:"B",3:"C",4:"Db",5:"D",6:"Eb",7:"E",8:"F",9:"Gb",10:"G",11:"Ab"},fn=[],mn=-4;mn<4;mn++)for(var dn=0;dn<12;dn++){var gn=440*Math.pow(2,mn),vn=gn/1200,hn=gn*Math.pow(2,dn/12),pn=mn+4,bn=ln[dn];fn.push({octave:pn,note:bn,frequency:hn,centsPerOctave:vn})}var En=l.a.memo(function(){var e=T(!1),n=Object(d.a)(e,2),t=n[0],a=n[1],r=l.a.useState(),i=Object(d.a)(r,2),o=i[0],c=i[1],u=l.a.useState(),s=Object(d.a)(u,2),f=s[0],m=s[1],g=l.a.useState(440),v=Object(d.a)(g,2),h=v[0],p=v[1],b=l.a.useState(),E=Object(d.a)(b,2),w=E[0],S=E[1];l.a.useEffect(function(){t&&!w&&void 0!==I&&S(new I)},[t,w]),l.a.useEffect(function(){if(t&&w){m(w.sampleRate);var e,n=navigator.mediaDevices;if(n)return n.getUserMedia({audio:!0}).then(function(n){e=n;var t=w.createAnalyser();t.fftSize=8192,w.createMediaStreamSource(n).connect(t),c(t)}),function(){e.getAudioTracks().forEach(function(e){return e.stop()})}}},[t,w]),l.a.useEffect(function(){if(t&&o&&f){var e=function(){var e=o.frequencyBinCount,n=new Float32Array(e);o.getFloatFrequencyData(n);var t=n.reduce(function(e,n,t){return e[0]<n?[n,t]:e},[-1/0,-1]),a=Object(d.a)(t,2)[1],r=f/o.fftSize;p(r*a)};e();var n=setInterval(e,50);return function(){clearInterval(n)}}},[t,o,f]);var k=function(e){for(var n=0,t=0;t<fn.length;t++)if(fn[t].frequency>=e){n=t;break}var a=n+1,r=fn[n],i=fn[a],o=(r.frequency+i.frequency)/2,c=fn[a],u=c.frequency-e;e<o&&(c=fn[n]);var s=c.centsPerOctave*u;return Object.assign(c,{originalFrequency:e,difference:u,cents:s})}(h||0),j=k.octave,O=k.note,x=k.cents;return l.a.createElement(Sn,{className:"box has-text-centered"},l.a.createElement(wn,null,l.a.createElement(Fe,{isDanger:!0,isOutlined:!0,onClick:ne},"X")),l.a.createElement("div",{className:"is-size-1"},t?O+j:"Stopped"),l.a.createElement("div",null,t?l.a.createElement(l.a.Fragment,null,x.toFixed(2)," Cents ",x<0?"flat":"sharp"):"press start to tune"),l.a.createElement(Be,{className:"is-right"},l.a.createElement(De,{on:t,isDanger:!0,offIsPrimary:!0,onClick:a},l.a.createElement(l.a.Fragment,null,"Stop"),l.a.createElement(l.a.Fragment,null,"Start"))))}),wn=Oe.a.div(sn()),Sn=Oe.a.section(un()),kn=En;function jn(){var e=Object(g.a)(["\n  align-self: center;\n  margin: auto;\n  z-index: 1;\n  pointer-events: none;\n"]);return jn=function(){return e},e}function On(){var e=Object(g.a)(["\n  width: 100px;\n  height: 100px;\n  border-radius: 100px;\n  position: absolute;\n  touch-action: none;\n"]);return On=function(){return e},e}function xn(){var e=Object(g.a)(["\n  margin: auto;\n  position: relative;\n  height: 300px;\n  width: 300px;\n  border-radius: 300px;\n  display: flex;\n  margin-bottom: 10px;\n"]);return xn=function(){return e},e}var yn=Oe.a.div(xn()),Mn=Oe.a.div(On()),Cn=function(e){var n=e.container,t=e.addDiff,a=e.size,r=B(E.Radians,3*Math.PI/2),i=Object(d.a)(r,2),o=i[0],c=i[1],u=l.a.useRef(Math.PI);l.a.useEffect(function(){u.current=o},[o]);var s=l.a.useCallback(function(e){v(!0),e.preventDefault()},[]),f=l.a.useState(!1),m=Object(d.a)(f,2),g=m[0],v=m[1],h=l.a.useRef(!1);l.a.useEffect(function(){h.current=g},[g]);var p=l.a.useState(0),b=Object(d.a)(p,2),w=b[0],S=b[1],k=l.a.useRef(0);l.a.useEffect(function(){k.current=w},[w]);var j=l.a.useCallback(function(e){v(!1)},[]),O=l.a.useCallback(function(e){Math.abs(k.current)<.2?S(function(n){return n+e}):(t(k.current>0?-1:1),S(0))},[t]),x=l.a.useCallback(function(e){if(null!==n){var t=e.clientX,a=e.clientY,r=n.getBoundingClientRect(),i={x:r.left+r.width/2,y:r.top+r.height/2},o=-(i.y-a),s=-(i.x-t),l=Math.atan2(o,s),f=u.current-l;f<-Math.PI?f=-u.current-l:f>Math.PI&&(f=u.current- -l),0!==f&&O(f),l===u.current||c(l)}},[O,c,n]),y=l.a.useCallback(function(e){var n=e.changedTouches[0];x(n)},[x]),M=l.a.useCallback(function(e){h.current&&x(e)},[x]),C=function(e){var n=l.a.useState(e),t=Object(d.a)(n,2),a=t[0],r=t[1],i=l.a.useRef(e);return l.a.useEffect(function(){i.current=e},[e]),l.a.useEffect(function(){var e=-1,n=function(){t(),r(i.current)},t=function(){e=requestAnimationFrame(n)};return t(),function(){cancelAnimationFrame(e)}},[]),a}(o),A=l.a.useMemo(function(){return a/2+Math.sin(C)*(a/4)+Math.sin(C)*a/16-a/6},[C,a]),N=l.a.useMemo(function(){return a/2+Math.cos(C)*(a/4)+Math.cos(C)*a/16-a/6},[C,a]);return l.a.useEffect(function(){return window.addEventListener("mouseup",j),window.addEventListener("mousemove",M),function(){window.removeEventListener("mouseup",j),window.removeEventListener("mousemove",M)}},[M,j]),l.a.createElement(Mn,{className:"has-background-info",onMouseDown:s,onTouchMove:y,style:{top:A,left:N}})},An=l.a.memo(Oe.a.div(jn())),Nn=function(e){var n=e.size,t=void 0===n?300:n,a=e.addDiff,r=e.children,i=l.a.useState(null),o=Object(d.a)(i,2),c=o[0],u=o[1];return l.a.createElement(yn,{ref:u,className:"has-background-primary"},l.a.createElement(Cn,{addDiff:a,container:c,size:t}),l.a.createElement(An,null,r))};function In(){var e=Object(g.a)(["\n  margin: 0 !important;\n  height: 100%;\n  width: 100%;\n  position: fixed;\n  z-index: 1;\n  left: 0;\n  top: 0;\n  background-color: rgba(0, 0, 0, 0.8);\n  color: white;\n  text-align: center;\n"]);return In=function(){return e},e}var Dn=Oe.a.div(In()),Fn=function(){var e=be(function(e){return e.metronomeState.bpm});return l.a.createElement("div",{className:"has-text-centered is-size-1"},e)},Ln=l.a.memo(function(){return l.a.createElement("section",{className:"section"},l.a.createElement(Nn,{addDiff:te},l.a.createElement(Fn,null),l.a.createElement(je,null)))}),Bn=l.a.memo(function(){var e=be(function(e){return e.metronomeState.playing}),n=be(function(e){return e.metronomeState.pending}),t=be(function(e){return e.settings.showTuner});return l.a.createElement("section",{className:"section"},l.a.createElement(Be,{hasAddons:!0},l.a.createElement(De,{isLink:!0,offIsOutlined:!0,offIsLink:!0,on:t,onClick:ne},"Tuner"),l.a.createElement(cn,null),l.a.createElement(De,{on:e,offIsPrimary:!0,grow:!0,isOutlined:!0,isDanger:!0,disabled:n,onClick:re},l.a.createElement(l.a.Fragment,null,"Stop"),l.a.createElement(l.a.Fragment,null,"Start"))))}),Tn=function(e){var n=e.audioContext,t=be(function(e){return e.metronomeState.pending}),a=be(function(e){return e.settings.showTuner});return V(n),l.a.createElement(l.a.Fragment,null,t&&l.a.createElement(Dn,null,"Tap to enable audio."),a&&l.a.createElement(kn,null),l.a.createElement(Ln,null),l.a.createElement(Qe,null),l.a.createElement(Bn,null))};function _n(){var e=Object(g.a)([""]);return _n=function(){return e},e}var Pn,zn=Oe.a.section(_n()),Rn=function(){var e=be(function(e){return e.settings.keepAwake});return l.a.createElement(zn,null,l.a.createElement("h2",{className:"is-size-4"},"Settings"),l.a.createElement("div",{className:"field"},l.a.createElement("div",{className:"control"},l.a.createElement("label",{className:"checkbox"},l.a.createElement("input",{style:{marginRight:"5px"},type:"checkbox",checked:e,onChange:ee}),"Keep screen on while metronome is running."))))},Kn=function(){return x.reduce(function(e,n){return function(e,n){return e.add({scaleKey:t=n,pitch:t[0],mode:t[1],known:!1,learning:!1,bpm:60});var t}(e,n)},v.Set())},Gn=function(e,n){return e.filter(n)},Wn=function(){var e=B(E.ScalesDB,Kn),n=Object(d.a)(e,2),t=n[0],a=n[1],r=l.a.useCallback(function(){throw new Error("not implemented")},[]),i=l.a.useCallback(function(e){return function(e,n){return Gn(e,n).first()}(t,e)},[t]),o=l.a.useCallback(function(e){return Gn(t,e).sort(function(e,n){return e.scaleKey[0].localeCompare(n.scaleKey[0])})},[t]);return{addBPM:l.a.useCallback(function(e,n){var r=t.get(e);r&&a(t.remove(r).add(Object(p.a)({},r,{bpm:r.bpm+n})))},[t,a]),toggleLearning:l.a.useCallback(function(e){var n=t.get(e);n&&a(t.remove(n).add(Object(p.a)({},n,{learning:!n.learning})))},[t,a]),toggleKnown:l.a.useCallback(function(e){var n=t.get(e);n&&a(t.remove(n).add(Object(p.a)({},n,{known:!n.known})))},[t,a]),addScale:r,getScale:i,getScales:o}};!function(e){e.NOT_STARTED="not-started",e.KNOWN="known",e.LEARNING="learning"}(Pn||(Pn={}));var qn=function(e){var n=Object(d.a)(e.scaleKey,2),t=n[0],a=n[1],r=e.learning,i=e.known,o=e.toggleLearning,c=e.toggleKnown;return l.a.createElement("div",{className:"is-grouped field has-addons"},l.a.createElement("div",{className:"is-size-5 control is-expanded"},t," ",a),l.a.createElement(Be,null,l.a.createElement(De,{on:i,isInfo:!0,onClick:c},"Known"),l.a.createElement(De,{on:r,isLink:!0,onClick:o},"Learning")))},Jn=function(e){var n=e.scales,t=e.reset,a=e.scaleMode,r=n.getScales,i=n.getScale,o=n.addBPM,c=l.a.useState(function(){return function(e){var n,t,a;for(a=e.length-1;a>0;a--)n=Math.floor(Math.random()*(a+1)),t=e[a],e[a]=e[n],e[n]=t;return e}(r(function(e){return a===Pn.LEARNING?e.learning:a===Pn.KNOWN&&e.known}).valueSeq().map(function(e){return e.scaleKey}).toArray())}),u=Object(d.a)(c,2),s=u[0],f=u[1],m=ie(),g=s[0]||[],v=i(function(e){return e.mode===g[1]&&e.pitch===g[0]});l.a.useEffect(function(){void 0!==v&&ie(v.bpm)},[v,m]);var h=s.length>1?"Next Scale":"Finish";if(0===s.length)return l.a.createElement("div",null,"No more scales");var p=v,b=p,E=b.mode,w=b.pitch,S=b.bpm;return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"box"},l.a.createElement("div",{style:{alignSelf:"center",fontWeight:"bold"},className:"control is-expanded is-size-5"},a),l.a.createElement("div",{style:{display:"flex",marginBottom:"5px"}},l.a.createElement("div",{style:{alignSelf:"center",marginRight:"10px"}},w," ",E," @ ",S,"bpm"),l.a.createElement(Be,{grow:!0,hasAddons:!0},l.a.createElement(Fe,{isDanger:!0,isOutlined:!0,grow:!0,onClick:function(){return o(p,-10)}},"-10"),l.a.createElement(Fe,{isDanger:!0,isOutlined:!0,grow:!0,onClick:function(){return o(p,-1)}},"-"),l.a.createElement(Fe,{isPrimary:!0,isOutlined:!0,grow:!0,onClick:function(){return o(p,1)}},"+"),l.a.createElement(Fe,{isPrimary:!0,isOutlined:!0,grow:!0,onClick:function(){return o(p,10)}},"+10"))),l.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},l.a.createElement(Fe,{isDanger:!0,isOutlined:!0,onClick:t},"Stop"),l.a.createElement(Fe,{isPrimary:!0,onClick:function(){f(function(e){var n=e.slice(1);return 0===n.length&&t(),n})}},h))),l.a.createElement(Qe,null))},Un=function(e){var n=e.audioContext;V(n);var t=l.a.useState(Pn.NOT_STARTED),a=Object(d.a)(t,2),r=a[0],i=a[1],o=function(e,n){var t=B(e,n),a=Object(d.a)(t,2),r=a[0],i=a[1];return[r,l.a.useCallback(function(){i(N.a)},[i])]}(E.ShowKnown,!1),c=Object(d.a)(o,2),u=c[0],s=c[1];l.a.useEffect(function(){r===Pn.NOT_STARTED&&oe()},[r]);var f=Wn(),m=f.getScale,g=f.getScales,v=f.toggleLearning,h=f.toggleKnown;return l.a.createElement("div",{style:{marginTop:"10px"}},r===Pn.NOT_STARTED?l.a.createElement("div",{style:{marginBottom:"5px"}},l.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},l.a.createElement("div",{style:{alignSelf:"center",fontWeight:"bold"},className:"control is-expanded is-size-5"},"Scales"),l.a.createElement(Be,null,l.a.createElement(Fe,{onClick:function(){return i(Pn.KNOWN)},disabled:void 0===m(function(e){return e.known}),className:"is-info is-outlined"},"Start Known"),l.a.createElement(Fe,{onClick:function(){return i(Pn.LEARNING)},disabled:void 0===m(function(e){return e.learning}),className:"is-link is-outlined"},"Start Learning"))),l.a.createElement("hr",null),l.a.createElement(Be,null,l.a.createElement(Fe,{onClick:s,className:"".concat(u?"is-primary is-outlined":"is-danger")},u?"Hide Known":"Show Known")),g(function(e){return e.mode===w.Major&&(!!u||!1===e.known)}).map(function(e){return l.a.createElement(qn,Object.assign({key:"".concat(e.pitch,"-").concat(e.mode)},e,{toggleLearning:function(){return v(e)},toggleKnown:function(){return h(e)}}))}),l.a.createElement("hr",null),g(function(e){return e.mode===w.Minor&&(!!u||!1===e.known)}).map(function(e){return l.a.createElement(qn,Object.assign({key:"".concat(e.pitch,"-").concat(e.mode)},e,{toggleLearning:function(){return v(e)},toggleKnown:function(){return h(e)}}))})):l.a.createElement(Jn,{scaleMode:r,scales:f,reset:function(){return i(Pn.NOT_STARTED)}}))},Hn=t(29),Vn=t(20),Xn=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Yn(e){if("serviceWorker"in navigator){if(new URL("/metronome",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var n="".concat("/metronome","/service-worker.js");Xn?(!function(e,n){fetch(e).then(function(t){var a=t.headers.get("content-type");404===t.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):$n(e,n)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(n,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):$n(n,e)})}}function $n(e,n){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;null!=t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),n&&n.onUpdate&&n.onUpdate(e)):(console.log("Content is cached for offline use."),n&&n.onSuccess&&n.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}function Qn(){var e=Object(g.a)(["\n  position: absolute;\n  max-width: ",";\n  width: 95%;\n  margin-top: 10px;\n  left: 0;\n  right: 0;\n  margin-left: auto !important;\n  margin-right: auto !important;\n  z-index: 10;\n  display: flex !important;\n  justify-content: space-between;\n  animation: ease-in 1s ",";\n"]);return Qn=function(){return e},e}function Zn(){var e=Object(g.a)(["\n    from {\n      opacity: 0;\n    }\n    to {\n      opacity: 1;\n    }\n"]);return Zn=function(){return e},e}var et=Object(Oe.b)(Zn()),nt=Oe.a.section(Qn(),"40em",et),tt=!1,at=function(){var e=l.a.useState(!1),n=Object(d.a)(e,2),t=n[0],a=n[1],r=l.a.useCallback(function(){window.location.reload()},[]),i=l.a.useCallback(function(){a(!1)},[]);return l.a.useEffect(function(){tt||Yn({onUpdate:function(){a(!0)}}),tt=!0},[]),l.a.createElement(l.a.Fragment,null,t&&l.a.createElement(nt,{className:"box"},l.a.createElement("span",null,"An Update is Available!"),l.a.createElement(Be,null,l.a.createElement(Fe,{isPrimary:!0,isOutlined:!0,onClick:r},"Refresh"),l.a.createElement(Fe,{isDanger:!0,isOutlined:!0,onClick:i},"x"))))},rt=t(37),it=t(26);function ot(){var e=Object(g.a)(["\n  display: flex;\n  flex-direction: column;\n  align-items: flex-end;\n  justify-content: flex-end;\n  margin-top: 5px;\n"]);return ot=function(){return e},e}function ct(){var e=Object(g.a)(["\n  max-width: ",";\n  margin: 0 auto;\n  display: flex;\n  flex-direction: column;\n  > * {\n    margin-left: 10px;\n    margin-right: 10px;\n  }\n"]);return ct=function(){return e},e}function ut(){var e=Object(g.a)(["\n  margin-left: 5px;\n"]);return ut=function(){return e},e}function st(){var e=Object(g.a)([""]);return st=function(){return e},e}function lt(){var e=Object(g.a)(["\n  display: flex;\n  position: absolute;\n  z-index: 2;\n  width: 100%;\n  flex-direction: column;\n  align-items: flex-end;\n  padding-right: 10px;\n  align-self: flex-end;\n  opacity: 0.9;\n  > a {\n    animation: ease-in 0.1s ",";\n    font-size: 1.5rem;\n    margin: 10px;\n  }\n"]);return lt=function(){return e},e}function ft(){var e=Object(g.a)(["\n  from {\nfont-size: 0px;\n  }\nto {\nmargin: 10px;\n}\n"]);return ft=function(){return e},e}function mt(){var e=Object(g.a)(["\n  display: flex;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  padding-left: 10px;\n  padding-right: 10px;\n  justify-content: space-between;\n  > h2 {\n    margin: 0 !important;\n  }\n"]);return mt=function(){return e},e}function dt(){var e=Object(g.a)(["\n  align-self: center;\n"]);return dt=function(){return e},e}function gt(){var e=Object(g.a)(["\n  margin-bottom: 10px;\n  margin-left: 0px !important;\n  margin-right: 0px !important;\n  position: relative;\n  display: inline-block;\n  flex-direction: column;\n"]);return gt=function(){return e},e}var vt=l.a.memo(Oe.a.section(gt())),ht=l.a.memo(Oe.a.span(dt())),pt=l.a.memo(Oe.a.section(mt())),bt=Object(Oe.b)(ft()),Et=l.a.memo(Oe.a.nav(lt(),bt)),wt=l.a.memo(Object(Oe.a)(Hn.b)(st())),St=l.a.memo(Object(Oe.a)(rt.a)(ut())),kt=function(e){var n=e.toggleNav;return l.a.useEffect(function(){return window.addEventListener("click",n),function(){window.removeEventListener("click",n)}},[]),l.a.createElement(Et,{className:"has-background-white"},l.a.createElement(wt,{to:"/"},"Home",l.a.createElement(St,{icon:it.d})),l.a.createElement(wt,{to:"/scales"},"Scales",l.a.createElement(St,{icon:it.e})),l.a.createElement(wt,{to:"/settings"},"Settings",l.a.createElement(St,{icon:it.c})))},jt=l.a.memo(function(){var e=T(!1),n=Object(d.a)(e,2),t=n[0],a=n[1],r=be(function(e){return e.settings.keepAwake&&e.metronomeState.playing});return l.a.createElement(vt,null,l.a.createElement(pt,{className:"has-background-primary has-text-light"},l.a.createElement(Hn.b,{to:"/",className:"has-text-white"},l.a.createElement("h2",{className:"is-size-4 is-bold"},"(mjh)tronome")),r&&l.a.createElement(Hn.b,{to:"/settings"},l.a.createElement(ht,{className:"has-text-info",onClick:a},l.a.createElement(rt.a,{icon:it.b,size:"2x"}))),l.a.createElement(ht,{onClick:a},l.a.createElement(rt.a,{icon:it.a,size:"2x"}))),t&&l.a.createElement(kt,{toggleNav:a}))}),Ot=l.a.memo(Oe.a.div(ct(),"40em")),xt=l.a.memo(Oe.a.div(ot())),yt=l.a.memo(function(e){var n=e.children;return l.a.createElement(Ot,null,l.a.createElement(at,null),l.a.createElement(jt,null),n,l.a.createElement(xt,null,"v".concat("1.0.29")))}),Mt=function(){var e=function(){var e=l.a.useState(),n=Object(d.a)(e,2),t=n[0],a=n[1],r=l.a.useRef(),i=l.a.useState(!1),o=Object(d.a)(i,2),c=o[0],u=o[1],s=l.a.useCallback(function(){c||void 0!==r.current&&(a("pending"),r.current.resume().then(function(){u(!0),a(r.current),document.removeEventListener("touchstart",s),document.removeEventListener("click",s),document.removeEventListener("touchend",s)}))},[c,u]);return l.a.useEffect(function(){if(void 0===I)a("not-supported");else{var e=new I;r.current=e,"suspended"===e.state?(document.addEventListener("touchstart",s),document.addEventListener("click",s),document.addEventListener("touchend",s)):a(e)}},[s]),t}(),n=be(function(e){return e.settings.keepAwake}),t=be(function(e){return e.metronomeState.playing});return function(e){var n=l.a.useState(new L.a),t=Object(d.a)(n,1)[0];l.a.useEffect(function(){e?t.enable():t.disable()},[e,t])}(n&&t),l.a.createElement(Hn.a,{basename:"/metronome"},l.a.createElement(yt,null,"not-supported"===e&&l.a.createElement("div",null,"Your browser doesn't support the audioContext api, so this will not work. Sorry :("),l.a.createElement(Vn.a,{exact:!0,path:"/",render:function(){return l.a.createElement(Tn,{audioContext:e})}}),l.a.createElement(Vn.a,{exact:!0,path:"/scales",render:function(){return l.a.createElement(Un,{audioContext:e})}}),l.a.createElement(Vn.a,{exact:!0,path:"/settings",render:function(){return l.a.createElement(Rn,null)}})))},Ct=(t(88),function(e){function n(e){var t;return Object(r.a)(this,n),(t=Object(o.a)(this,Object(c.a)(n).call(this,e))).state={error:void 0},t}return Object(u.a)(n,e),Object(i.a)(n,[{key:"render",value:function(){return this.state.error?l.a.createElement("div",null,l.a.createElement("h1",null,"Something went wrong"),l.a.createElement("hr",null),l.a.createElement("code",null,this.state.error instanceof Error&&this.state.error.name),l.a.createElement("hr",null),l.a.createElement("code",null,this.state.error instanceof Error&&this.state.error.message),l.a.createElement("hr",null),l.a.createElement("code",null,this.state.error instanceof Error&&this.state.error.stack),l.a.createElement("hr",null),l.a.createElement("code",null,JSON.stringify(this.state.error,void 0,"  "))):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{error:e}}}]),n}(l.a.Component));m.a.render(l.a.createElement(y.a,{store:pe},l.a.createElement(Ct,null,l.a.createElement(Mt,null))),document.getElementById("root"))}},[[65,1,2]]]);
//# sourceMappingURL=main.f5bcb41d.chunk.js.map