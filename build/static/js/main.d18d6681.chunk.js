(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{29:function(e,t,n){e.exports=n(42)},35:function(e,t,n){e.exports=n.p+"static/media/click.b48ed3e5.wav"},41:function(e,t,n){},42:function(e,t,n){"use strict";n.r(t);for(var a=n(0),r=n.n(a),c=n(14),o=n.n(c),i=n(1),u=n(26),s=n(50),l=n(47),f=n(48),m=n(23),d=n(45),b=n(46),v=[{name:"Larghissimo",range:[0,24]},{name:"Grave",range:[25,45]},{name:"Largo",range:[40,60]},{name:"Lento",range:[45,60]},{name:"Larghetto",range:[60,66]},{name:"Adagio",range:[66,76]},{name:"Andante",range:[76,108]},{name:"Marcia moderato",range:[83,85]},{name:"Andante moderato",range:[92,112]},{name:"Moderato",range:[108,120]},{name:"Allegro",range:[120,156]},{name:"Vivace",range:[156,176]},{name:"Vivacissimo",range:[172,176]},{name:"Allegrissimo",range:[172,176]},{name:"Presto",range:[168,200]},{name:"Prestissimo",range:[200,250]}],g=function(e){return v.filter(function(t){return function(e,t){var n=Object(i.a)(e,2),a=n[0],r=n[1];return t>=a&&t<=r}(t.range,e)})},h=function(e){var t=e.bpm,n=g(t);return r.a.createElement("div",{style:{minHeight:"6.5em"}},n.map(function(e,t){var n=e.name,a=e.range;return r.a.createElement("div",{key:t,className:"has-text-centered"},n," - ",a[0]," - ",a[1])}))},O=n(51),p=function(e,t){var n=Object(a.useState)(function(){var n,a=localStorage.getItem(e);return n=null!==a&&void 0!==a?JSON.parse(a):t instanceof Function?t():t,window.localStorage.setItem(e,JSON.stringify(n)),n}),r=Object(i.a)(n,2),c=r[0],o=r[1];return[c,function(t){o(function(n){var a=t instanceof Function?t(n):t;return window.localStorage.setItem(e,JSON.stringify(a)),a})}]},j=function(e){var t=Object(a.useState)(e),n=Object(i.a)(t,2),r=n[0],c=n[1];return[r,function(){return c(function(e){return!e})}]},E=n(13),w=function(e){var t=e.classes,n=void 0===t?[]:t,a=e.children,c=Object(E.a)(e,["classes","children"]),o="button ".concat(n.join(" ")),i=Object.assign(c,{className:o});return r.a.createElement("button",i,a)},k=function(e){var t=e.classes,n=void 0===t?[]:t,a=e.children,c=Object(E.a)(e,["classes","children"]),o="buttons has-addons ".concat(n.join(" ")),i=Object.assign(c,{className:o});return r.a.createElement("div",i,a)},y=function(e){var t=e.setSignature,n=e.signature.numerator,a=e.currentBeat,c=j(!1),o=Object(i.a)(c,2),u=o[0],s=o[1],l=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;return function(){t({numerator:e,denominator:n}),s()}};return r.a.createElement(r.a.Fragment,null,r.a.createElement("section",{style:{marginTop:"10px"},className:"section is-mobile columns",onClick:s},O.a(0,n).map(function(e){var t=e+1===a?"has-background-primary":"has-background-light";return r.a.createElement("div",{className:"column margin-sm has-text-centered ".concat(t),key:e},e+1)})),u&&r.a.createElement("section",{className:"section buttons is-centered"},r.a.createElement(w,{onClick:l(2)},"2/4"),r.a.createElement(w,{onClick:l(3)},"3/4"),r.a.createElement(w,{onClick:l(4)},"4/4"),r.a.createElement(w,{onClick:l(5)},"5/4")))},S=n(35),A=function(e,t){var n=t.time,a=t.gain,r=t.buffer,c=t.pitch,o=e.createBufferSource();o.buffer=r,o.detune.value=-c;var i=e.createGain();i.gain.value=a,o.connect(i),i.connect(e.destination),o.start(n)},M=function(e,t,n,a){var r=n.divisions,c=n.on,o=n.pitch,i=n.gain;if(c){var u=t/r;return O.a(1,r).map(function(t){return{time:e+t*u,pitch:o,gain:.5*i,buffer:a}})}return[]},x=function(e,t,n,r){var c=t.scheduleAhead,o=function(e){var t=Object(a.useState)(),n=Object(i.a)(t,2),r=n[0],c=n[1];return Object(a.useEffect)(function(){var t=new AudioContext;fetch(e).then(function(e){return e.arrayBuffer()}).then(function(e){return t.decodeAudioData(e)}).then(c)},[e]),r}(S),u=Object(a.useRef)(0),s=function(e){var t=Object(a.useRef)(e);return Object(a.useEffect)(function(){t.current=e},[e]),t}(t),l=e?1e3*c/2:void 0;Object(a.useEffect)(function(){if(void 0!==l){var e=r.currentTime+.1;u.current=e;var t=setInterval(function(){!function(e,t,n,a,r){for(var c=t.current,o=c.bpm,i=c.subDivisions,u=c.scheduleAhead,s=60/o,l=function(e){A(r,e)};e.current<r.currentTime+u;){A(r,{time:e.current,pitch:0,gain:.5,buffer:n}),a(e.current);var f=!0,m=!1,d=void 0;try{for(var b,v=i[Symbol.iterator]();!(f=(b=v.next()).done);f=!0){var g=b.value;M(e.current,s,g,n).forEach(l)}}catch(h){m=!0,d=h}finally{try{f||null==v.return||v.return()}finally{if(m)throw d}}e.current+=s}}(u,s,o,n,r)},l);return function(){clearInterval(t)}}},[l,o,s,n,r])},C=function(e,t,n,r,c){var o=function(e){var t=Object(a.useRef)(e);return Object(a.useLayoutEffect)(function(){t.current=e},[e]),t}(n);Object(a.useLayoutEffect)(function(){var n,a=!0,i=function(){u();var e=t.currentTime,n=o.current;(void 0!==n&&e<=n||a)&&(r(void 0),c(),a=!1)},u=function(){n=requestAnimationFrame(i)};if(e)return u(),function(){cancelAnimationFrame(n)}},[e,t,c,o,r])},N=n(49),R=n(27),J=n(52),D=n(43),B=n(44),F=f.a(function(e){return N.a(2,e)},R.a(function(e){var t=Object(i.a)(e,2),n=t[0];return t[1]-n}),J.a,D.a(6e4),Math.trunc),L=function(e){var t=e.setBPM,n=Object(a.useState)([]),c=Object(i.a)(n,2),o=c[0],u=c[1];return r.a.createElement(w,{onClick:function(){var e=performance.now(),n=B.a(e,o).filter(function(t){return e-t<3e3});if(n.length>1){var a=F(n);t(a)}u(n)}},"Tap In")},P=function(e){var t=e.subDivisions,n=e.toggle;return r.a.createElement(r.a.Fragment,null,t.map(function(e,t){var a=e.label,c=e.on;return r.a.createElement(w,{classes:[c?"is-primary":""],key:t,onClick:function(){return n(t)}},a)}))},I={0:"A",1:"Bb",2:"B",3:"C",4:"Db",5:"D",6:"Eb",7:"E",8:"F",9:"Gb",10:"G",11:"Ab"},q=[],T=-4;T<4;T++)for(var G=0;G<12;G++){var W=440*Math.pow(2,T),z=W/1200,U=W*Math.pow(2,G/12),V=T+4,H=I[G];q.push({octave:V,note:H,frequency:U,centsPerOctave:z})}var X=function(){var e=Object(a.useState)(),t=Object(i.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(),u=Object(i.a)(o,2)[1],s=Object(a.useState)(),l=Object(i.a)(s,2),f=l[0],m=l[1],d=Object(a.useState)(440),b=Object(i.a)(d,2),v=b[0],g=b[1];Object(a.useRef)(null);Object(a.useEffect)(function(){var e=new AudioContext;m(e.sampleRate);var t=navigator.mediaDevices;return t&&t.getUserMedia({audio:!0}).then(function(t){var n=e.createAnalyser();n.fftSize=8192,e.createMediaStreamSource(t).connect(n),c(n)}),function(){e.close()}},[]),Object(a.useLayoutEffect)(function(){var e,t=function(){var e=n.frequencyBinCount,t=new Float32Array(e);n.getFloatFrequencyData(t),u(t);var r=t.reduce(function(e,t,n){return e[0]<t?[t,n]:e},[-1/0,-1]),c=Object(i.a)(r,2)[1],o=f/n.fftSize;g(o*c),a()},a=function(){e=requestAnimationFrame(t)};if(void 0!==n)return a(),function(){cancelAnimationFrame(e)}},[n,f]);var h=function(e){for(var t=0,n=0;n<q.length;n++)if(q[n].frequency>=e){t=n;break}var a=t+1,r=q[t],c=q[a],o=(r.frequency+c.frequency)/2,i=q[a],u=i.frequency-e;e<o&&(i=q[t]);var s=i.centsPerOctave*u;return Object.assign(i,{originalFrequency:e,difference:u,cents:s})}(v||0),O=h.octave,p=h.note,j=h.cents;return r.a.createElement("div",{className:"box"},r.a.createElement("div",{className:"has-text-centered"},r.a.createElement("div",{className:"is-size-1"},p+O),r.a.createElement("div",null,j.toFixed(2)," Cents ",j<0?"flat":"sharp")),!1)},Y=n(9),$=n(10);function K(){var e=Object(Y.a)(["\n  align-self: center;\n  margin: auto;\n  z-index: 1;\n  pointer-events: none;\n"]);return K=function(){return e},e}function Q(){var e=Object(Y.a)(["\n  width: 100px;\n  height: 100px;\n  border-radius: 100px;\n  position: absolute;\n"]);return Q=function(){return e},e}function Z(){var e=Object(Y.a)(["\n  margin: auto;\n  position: relative;\n  height: 300px;\n  width: 300px;\n  border-radius: 300px;\n  display: flex;\n  margin-bottom: 10px;\n"]);return Z=function(){return e},e}var _,ee=$.a.div(Z()),te=$.a.div(Q()),ne=$.a.div(K()),ae=function(e){var t=e.size,n=void 0===t?300:t,c=e.addDiff,o=e.children,u=Object(a.useState)(3*Math.PI/2),s=Object(i.a)(u,2),l=s[0],f=s[1],m=Object(a.useRef)(Math.PI);Object(a.useEffect)(function(){m.current=l},[l]);var d=Object(a.useState)(!1),b=Object(i.a)(d,2),v=b[0],g=b[1],h=Object(a.useRef)(!1);Object(a.useEffect)(function(){h.current=v},[v]);var O=Object(a.useState)(0),p=Object(i.a)(O,2),j=p[0],E=p[1],w=Object(a.useRef)(0);Object(a.useEffect)(function(){w.current=j},[j]);var k=Object(a.useRef)(null),y=Object(a.useCallback)(function(e){g(!1)},[]),S=Object(a.useCallback)(function(e){Math.abs(w.current)<.2?E(function(t){return t+e}):(c(w.current>0?-1:1),E(0))},[c]),A=Object(a.useCallback)(function(e){var t=e.clientX,n=e.clientY,a=k.current.getBoundingClientRect(),r=a.left+a.width/2,c=-(a.top+a.height/2-n),o=-(r-t),i=Math.atan2(c,o),u=m.current-i;u<-Math.PI?u=-m.current-i:u>Math.PI&&(u=m.current- -i),0!==u&&S(u),i===m.current||f(i)},[S]),M=Object(a.useCallback)(function(e){h.current&&A(e)},[A]);Object(a.useEffect)(function(){return window.addEventListener("mouseup",y),window.addEventListener("mousemove",M),function(){window.removeEventListener("mouseup",y),window.removeEventListener("mousemove",M)}},[M,y]);var x=n/2+Math.sin(l)*(n/4)+Math.sin(l)*n/16-n/6,C=n/2+Math.cos(l)*(n/4)+Math.cos(l)*n/16-n/6;return r.a.createElement(ee,{ref:k,className:"has-background-primary"},r.a.createElement(te,{className:"has-background-info",onMouseDown:function(e){g(!0),e.preventDefault()},onTouchMove:function(e){var t=e.changedTouches[0];A(t)},style:{top:x,left:C}}),r.a.createElement(ne,null,o))};function re(){var e=Object(Y.a)(["\n  align-self: center;\n"]);return re=function(){return e},e}!function(e){e.MAJOR="Major"}(_||(_={}));var ce=[{key:"A",mode:_.MAJOR,know:!1,bpm:80},{key:"Bb",mode:_.MAJOR,know:!1,bpm:80},{key:"B",mode:_.MAJOR,know:!1,bpm:80},{key:"C",mode:_.MAJOR,know:!1,bpm:80},{key:"Db",mode:_.MAJOR,know:!1,bpm:80},{key:"D",mode:_.MAJOR,know:!1,bpm:80},{key:"Eb",mode:_.MAJOR,know:!1,bpm:80},{key:"E",mode:_.MAJOR,know:!1,bpm:80},{key:"F",mode:_.MAJOR,know:!1,bpm:80},{key:"Gb",mode:_.MAJOR,know:!1,bpm:80},{key:"G",mode:_.MAJOR,know:!1,bpm:80},{key:"Ab",mode:_.MAJOR,know:!1,bpm:80}],oe=$.a.div(re()),ie=function(e){var t=e.startMetronome,n=e.stopMetronome,c=Object(E.a)(e,["startMetronome","stopMetronome"]),o=p("@mjh/metronome/scales",ce),s=Object(i.a)(o,2),f=s[0],d=s[1],b=Object(a.useState)(),v=Object(i.a)(b,2),g=v[0],h=v[1],O=f[g],j=function(e){return d(u.a((t=g,l.a([t,"bpm"])),m.a(e)));var t};Object(a.useEffect)(function(){O&&t(O.bpm)},[O]);var k="Start Scales";if(void 0!==g&&g<f.length-1){var y=f[g+1],S=y.mode,A=y.key;k="Continue (".concat(A," ").concat(S,")")}return r.a.createElement("div",Object.assign({},c,{className:"box"}),O&&r.a.createElement("div",{className:"columns is-mobile"},r.a.createElement(oe,{className:"column is-size-3"},O.key," ",O.mode),r.a.createElement(oe,{className:"column is-size-5 has-text-right"},"BPM: ",O.bpm)),r.a.createElement("div",{className:"buttons has-addons is-right"},void 0!==g&&r.a.createElement(r.a.Fragment,null,r.a.createElement(w,{classes:["is-danger"],onClick:function(){h(void 0),n()}},"Stop"),r.a.createElement(w,{style:{flexGrow:1},onClick:function(){return j(-1)}},"-"),r.a.createElement(w,{style:{flexGrow:1},onClick:function(){return j(1)}},"+")),r.a.createElement(w,{classes:["is-right"],onClick:function(){h(function(e){if(void 0===e)return 0;var t=e+1;return t>=f.length?void 0:t})}},k)))},ue=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function se(e){if("serviceWorker"in navigator){if(new URL("/metronome",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/metronome","/service-worker.js");ue?(!function(e,t){fetch(e).then(function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):le(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):le(t,e)})}}function le(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}var fe=l.a(["schedulerState","bpm"]),me=l.a(["schedulerState","signature"]),de=function(){return{schedulerState:{scheduleAhead:.2,bpm:120,signature:{numerator:4,denominator:4},subDivisions:[{on:!1,pitch:10,divisions:2,label:"2",gain:1},{on:!1,pitch:20,divisions:3,label:"3",gain:1},{on:!1,pitch:30,divisions:4,label:"4",gain:1},{on:!1,pitch:40,divisions:5,label:"5",gain:1}]}}},be=function(){var e=Object(a.useState)(!1),t=Object(i.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(function(){return new AudioContext}),v=Object(i.a)(o,2),g=v[0],O=v[1];Object(a.useEffect)(function(){n&&O(new AudioContext)},[n]);var E=p("@mjh/metronome/schedulerState",de),S=Object(i.a)(E,2),A=S[0],M=A.schedulerState,N=A.schedulerState,R=N.bpm,J=N.subDivisions,D=N.signature,B=S[1],F=function(e){return B(Object(s.a)(fe,d.a(1,250,e)))},I=function(e,t,n){var r=Object(a.useState)(),c=Object(i.a)(r,2),o=c[0],u=c[1],s=Object(a.useState)(0),l=Object(i.a)(s,2),f=l[0],m=l[1],d=t.signature.numerator,b=Object(a.useCallback)(function(){return m(function(e){var t=e+1;return e>=d&&(t=1),t})},[d]);return x(e,t,u,n),C(e,n,o,u,b),[f,m]}(n,M,g),q=Object(i.a)(I,2),T=q[0],G=q[1],W=j(!1),z=Object(i.a)(W,2),U=z[0],V=z[1],H=j(!1),Y=Object(i.a)(H,2),$=Y[0],K=Y[1],Q=Object(a.useState)(!1),Z=Object(i.a)(Q,2),_=Z[0],ee=Z[1];return Object(a.useEffect)(function(){se({onUpdate:function(){ee(!0)}})}),r.a.createElement("div",{style:{maxWidth:"500px",margin:"0 auto",padding:"10px"}},_&&r.a.createElement("section",{className:"box is-grouped field has-addons",style:{marginBottom:"10px"}},r.a.createElement("p",{style:{alignSelf:"center"},className:"control is-expanded"},"An Update is Available!"),r.a.createElement(w,{onClick:function(){return window.location.reload()}},"Refresh")),r.a.createElement(y,{setSignature:function(e){B(Object(s.a)(me,e))},signature:D,currentBeat:T}),r.a.createElement("section",{className:"section"},r.a.createElement(ae,{addDiff:function(e){return B(Object(u.a)(fe,f.a(m.a(e),d.a(1,250))))}},r.a.createElement("div",{className:"has-text-centered is-size-1"},R),r.a.createElement(h,{bpm:R}))),r.a.createElement("section",{className:"section"},r.a.createElement(k,null,r.a.createElement(P,{subDivisions:J,toggle:function(e){var t;B(Object(u.a)((t=e,l.a(["schedulerState","subDivisions",t,"on"])),b.a))}}),r.a.createElement(L,{setBPM:F}),r.a.createElement(w,{style:{flexGrow:1},classes:["is-outlined",n?"is-danger":"is-primary"],onClick:function(){n&&G(0),c(b.a)}},n?"Stop":"Start"))),U&&r.a.createElement(ie,{startMetronome:function(e){F(e),c(!0)},stopMetronome:function(){c(!1)}}),$&&r.a.createElement(X,null),r.a.createElement("nav",{className:"navbar is-fixed-bottom buttons is-right",style:{padding:"10px",margin:"0 auto",maxWidth:"500px"}},r.a.createElement(w,{classes:[U?"is-primary":""],onClick:V},"Scales"),r.a.createElement(w,{classes:[$?"is-primary":""],onClick:K},"Tuner"),r.a.createElement("div",null,"v".concat("0.1.0"))))},ve=function(){return r.a.createElement(be,null)};n(41);o.a.render(r.a.createElement(ve,null),document.getElementById("root"))}},[[29,1,2]]]);
//# sourceMappingURL=main.d18d6681.chunk.js.map